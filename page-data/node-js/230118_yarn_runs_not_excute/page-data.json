{"componentChunkName":"component---src-templates-post-template-index-tsx","path":"/node-js/230118_yarn_runs_not_excute/","result":{"data":{"cur":{"id":"b13b6ea5-03c0-5a03-804e-afd230ce6578","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVQoz23Ry07CQBQGYF5FkUK5lF4od2jDpUTTFkVBYoSNxI1uWLhw7c41xrhCjVFAdGEAhcSACs/1m5lCIsTFlzNzZvLnTMb2/PGDVn+Cp94YLaI/r70x7dF+f4LHt0/cPLyi0Wyjcbui2cbVXQfX913YOsMZ6qd1aNs5JDQTSsaAkiXMebXWyYyOYCwNKaRACquQwsqcCkFOQMnqKFdrsL2MZsgXK7A7OXj8IcrlDcDu9GPN4cM6w1F2hsOGi4eDFZYwrEDPxFASxm7ZCixVjiHISYQTWSoYTUOOpiCFVPiECNxckGIJn7yE9J0eCcFYCvniwWLCKhi3CL8UBydG4Zdi4ANxePkIvHwYLo9EJyF3WK9MAwiyJ69hWBG8HIde2LcCj07OoGZN5IwSNH0Pml5cZlg1s1VAevOvHdpTNRPFwxrOLy5hI7/cHU7RHc3QHS5M/9V5/0Z7MEF78LViQs9I1i9lIizg/KudsAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ca605a8cfd8c6596d463496c453172a6/7c297/thumbnail.webp 180w,\n/static/ca605a8cfd8c6596d463496c453172a6/33ecc/thumbnail.webp 360w,\n/static/ca605a8cfd8c6596d463496c453172a6/df77d/thumbnail.webp 720w,\n/static/ca605a8cfd8c6596d463496c453172a6/5c666/thumbnail.webp 1080w,\n/static/ca605a8cfd8c6596d463496c453172a6/95f20/thumbnail.webp 1440w,\n/static/ca605a8cfd8c6596d463496c453172a6/4b981/thumbnail.webp 1716w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ca605a8cfd8c6596d463496c453172a6/e9ea2/thumbnail.png 180w,\n/static/ca605a8cfd8c6596d463496c453172a6/53918/thumbnail.png 360w,\n/static/ca605a8cfd8c6596d463496c453172a6/242a6/thumbnail.png 720w,\n/static/ca605a8cfd8c6596d463496c453172a6/b4ad3/thumbnail.png 1080w,\n/static/ca605a8cfd8c6596d463496c453172a6/89066/thumbnail.png 1440w,\n/static/ca605a8cfd8c6596d463496c453172a6/010a2/thumbnail.png 1716w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ca605a8cfd8c6596d463496c453172a6/242a6/thumbnail.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"배포를-하려다가\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%ED%8F%AC%EB%A5%BC-%ED%95%98%EB%A0%A4%EB%8B%A4%EA%B0%80\" aria-label=\"배포를 하려다가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배포를 하려다가…</h1>\n<p>흑집소 서비스를 더 개발해서 오픈하려 했지만…<br>\n일단 홍보 전 몇가지 기능만 오픈해서 데이터를 모아보자는 생각에 배포를 준비하게 되었다.</p>\n<p>로컬 환경을 떠나서 EC2의 서비스 환경을 구성하던 도중,<br>\n전에 개발했던 <a href=\"https://myme.link\">MyMeLink</a>의 기록을 찾아서 적용하기 시작했다.</p>\n<p><strong>package.json</strong>의 <strong>script</strong> 부분도 알맞게 변경 후 아래와 같이 구성되어 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"build:prod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"some build\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"pm2_start:prod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"some start\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"run:prod_init\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"run-s build:prod pm2_start:prod\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위의 내용 중 실행 쪽은 가려둔 상태이다.<br>\n근데 실행을 하니… 아래와 같은 에러가 발생하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ yarn run run:prod_init\nyarn run v1.22.19\n$ run-s build:prod pm2_start:prod\n/bin/sh: 1: run-s: not found\nerror Command failed with exit code 127.\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.</code></pre></div>\n<h2 id=\"뭐가-문제일까\" style=\"position:relative;\"><a href=\"#%EB%AD%90%EA%B0%80-%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C\" aria-label=\"뭐가 문제일까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>뭐가 문제일까?</h2>\n<p>위 에러를 보면 알겠지만 <strong>run-s</strong>라는 것을 못찾아서 그렇다.<br>\n근데 따로 뭔가 설치하진 않았던것 같은데…</p>\n<p>그래서 웹에서 찾아보니…<br>\n내가 설치를 안한게 있었다…<br>\n이상한데…package.json 비교해봤지만 저거는 따로 안깔았었다.</p>\n<p>무튼 아래 패키지를 설치하니 잘 되었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn add npm-run-all --dev</code></pre></div>\n<p>여담인데 스택오버플에서 아래와 같이…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 339px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABf0lEQVQoz52SW4/TMBCF8///CQ8888YrN2nFQrUFNrTZ2EmcmtI2bdI4vnzI7mVR4QEx0mjmjEZHx8eT+RAYjcVzigA4H1L6Sw2nmXWeuB/rMybVyGEmSzZZx3rTcXc/4+37Oz7N5izLKuXjomTxJPmaFxSiRtQt+bKkrBT5UiQ8+/KY8NFYDsNIZibHtjsw/5bz8fMDi0JQNSsqpdOibFqeZJNwq38mYqXX1EqnKusWvd4mwv5oyKxzOH958L9HtCaEcx8CLtrgPJn3sXFIWbFaaYSQlKVAKUXbrlhpjdY/0ny/3yOkTLML0ZX1HFk03piJ/PuCRimWRUkpJMuioK6bNGsahZAVfT9QCpHwhfA2syjzfyKclYVbhdG/qPJ+NkeoHbZ5xaZ4TXeEbqNRD2/odgdGYHj5gv7DO+pth7PuryqvCre7PcNo8NYwmR7rAm4aMcMueRy37G6LHQbGyf6h7DcPPfEW40I82stRR+XPR336uKjJxT3vr796m78AfeoEAJLYXnkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f4f67eaa5e673edb0ceb4f23de58e545/7c297/img01.webp 180w,\n/static/f4f67eaa5e673edb0ceb4f23de58e545/5741d/img01.webp 339w\"\n              sizes=\"(max-width: 339px) 100vw, 339px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f4f67eaa5e673edb0ceb4f23de58e545/e9ea2/img01.png 180w,\n/static/f4f67eaa5e673edb0ceb4f23de58e545/527f2/img01.png 339w\"\n            sizes=\"(max-width: 339px) 100vw, 339px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f4f67eaa5e673edb0ceb4f23de58e545/527f2/img01.png\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>왜 비추 5개가 박혀있는 것인가…<br>\n정황은 잘 모르겠지만, 그 정도로 우매했던 질문인 것인가 라는 생각이 들고…</p>\n<p>무튼 또 내가 같은 실수를 반복할까봐 포스팅으로 남겨둔다…</p>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h2>\n<p><a href=\"https://github.com/0xProject/0x-starter-project/issues/10\">참고한 stackoverflow</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%AD%90%EA%B0%80-%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C\">뭐가 문제일까?</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</div>","excerpt":"배포를 하려다가… 흑집소 서비스를 더 개발해서 오픈하려 했지만… 일단 홍보 전 몇가지 기능만 오픈해서 데이터를 모아보자는 생각에 배포를 준비하게 되었다. 로컬 환경을 떠나서 EC2의 서비스 환경을 구성하던 도중, 전에 개발했던 MyMeLink의 기록을 찾아서 적용하기 시작했다. package.json의 script 부분도 알맞게 변경 후 아래와 같이 구성되어 있었다. 위의 내용 중 실행 쪽은 가려둔 상태이다. 근데 실행을 하니… 아래와 같은 에러가 발생하였다. 뭐가 문제일까? 위 에러를 보면 알겠지만 run-s라는 것을 못찾아서 그렇다. 근데 따로 뭔가 설치하진 않았던것 같은데… 그래서 웹에서 찾아보니… 내가 설치를 안한게 있었다… 이상한데…package.json 비교해봤지만 저거는 따로 안깔았었다. 무튼 아래 패키지를 설치하니 잘 되었다. 여담인데 스택오버플에서 아래와 같이…  왜 비추 5개가 박혀있는 것인가… 정황은 잘 모르겠지만, 그 정도로 우매했던 질문인 것인가 라는 생각이…","frontmatter":{"date":"2023.01.18","title":"yarn에서 run-s 실행이 안될 때 (With package.json)","categories":"node-js","emoji":"📜"},"fields":{"slug":"/node-js/230118_yarn_runs_not_excute/"}},"next":{"id":"8a07abbd-aa68-5d80-a53f-4ce1a3c266ce","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA40lEQVQY04WRzWrCQBSFfZpk7k9mJpOOmKoo1daqqEHENrgRarrqonEpLnQpdNFHFtMGNRiEw8DA/c7cc6aCLK9EHrKXnRI9dVJh4EKVwp10QFKT8pElAALy2eLP8RasAJmNDRefjSQ1LyNwhAyb7FvhuMIRAIRSl79M/DCcdTaH591vI0nZ2Prqu73eVaP4cflloziMPwopcthTgOQ/vbbX+872J1wkJLVudauTNzt5r82XQT8yvVEJnEUiqU1vHAymqt7KAhO4AAKE457WRr5TGAABYN6N+m+rpPMifPd7LuEj8+5dpmSMFhYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1231c0073a9bc0704f04fff13d13ffe0/7c297/thumbnail_react.webp 180w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/33ecc/thumbnail_react.webp 360w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/df77d/thumbnail_react.webp 720w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/cf465/thumbnail_react.webp 800w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1231c0073a9bc0704f04fff13d13ffe0/e9ea2/thumbnail_react.png 180w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/53918/thumbnail_react.png 360w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/242a6/thumbnail_react.png 720w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/78d47/thumbnail_react.png 800w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1231c0073a9bc0704f04fff13d13ffe0/242a6/thumbnail_react.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"개인적인-스터디를-하다가\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9D%B8%EC%A0%81%EC%9D%B8-%EC%8A%A4%ED%84%B0%EB%94%94%EB%A5%BC-%ED%95%98%EB%8B%A4%EA%B0%80\" aria-label=\"개인적인 스터디를 하다가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개인적인 스터디를 하다가…</h1>\n<p>Typescript에서 useRef에 대한 사용법을 조사하다…<br>\n좀 딥하게(?) 약간은 좀 알아보고자 찾고 학습한 내용을 포스팅으로 정리해봤다.</p>\n<p>역시 매번 느끼는데 웹 문서 스크롤로 몇번 내리고 예제 몇번 해보면 되는데,<br>\n이걸 문서화 하는건 역시 시간이 든다.<br>\n하지만 이렇게 함으로써 머리속에서 정리가 되고 내 경험치가 쌓이겠지… 라는 위안으로 포스팅을 시작해본다.</p>\n<h2 id=\"useref\" style=\"position:relative;\"><a href=\"#useref\" aria-label=\"useref permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UseRef?</h2>\n<p>뭐 알다시피 React Hook의 일종이다.<br>\n함수의 형태는 다음과 같이 생겼다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">useRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>initialValue<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> MutableRefObject<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//1</span>\n<span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">useRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>initialValue<span class=\"token operator\">:</span> <span class=\"token constant\">T</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> RefObject<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//2</span>\n<span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">useRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">undefined</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> MutableRefObject<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//3</span></code></pre></div>\n<p>저것에 대해서는 차차 알아보고 저렇게 생겼다는 것을 알아두자.<br>\n.current 프로퍼티로 전달된 인자(<strong>initialValue</strong>)로 초기화된 변경 가능한 ref 객체를 반환한다.</p>\n<p>말이 뭔가 어려운데 쉽게 <strong>DOM</strong> 객체를 조작하거나, 컴토넌트의 특정 부분을 선택할 수 있는 방법을 제시하는 Hook이다.<br>\n그래서 간단한 사용 예시는…<br>\n코드를 보자</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">SomeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> inputRef <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">useRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'App'</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>Hi<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>input placeholder<span class=\"token operator\">=</span><span class=\"token string\">'hello'</span> ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>inputRef<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a = '</span><span class=\"token punctuation\">,</span> inputRef<span class=\"token punctuation\">.</span>current<span class=\"token operator\">?.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Check<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>예제 코드가 좀 엉망이지만 input에 값을 입력하고 버튼을 클릭하면,<br>\n콘솔에 input의 입력 값이 나오게 된다.</p>\n<p>여기서도 한 가지 중요 포인트는 이 <strong>.current</strong>로 변경시킬 때 <strong>리랜더링을 발생시키지 않는다</strong> 라는 점을 유의해야 한다.<br>\n그래서 어떤 가변적인 값을 유지하기에 좋다.<br>\n공홈에도 이렇게 명시되어 있다.</p>\n<blockquote>\n<p>본질적으로 useRef는 .current 프로퍼티에 변경 가능한 값을 담고 있는 “상자”와 같습니다.</p>\n</blockquote>\n<p>무튼 돌아와서…<br>\n위의 선언된 useRef를 보면 반환 값이 <strong>MutableRefObject</strong>와 <strong>RefObject</strong> 이렇게 두 가지로 되어 있다.</p>\n<p>먼저 답을 이야기 하면…</p>\n<p><strong>MutableRefObject</strong>는 로컬 변수 용도로… 즉 값 형태로 사용할 때 쓰는 타입이고,<br>\n<strong>RefObject</strong>는 DOM 객체를 담을 때 쓰는 타입이다.</p>\n<p>자세한 것은 각각 타입을 설명하면서 다루겠다.</p>\n<br>\n<h3 id=\"mutablerefobject\" style=\"position:relative;\"><a href=\"#mutablerefobject\" aria-label=\"mutablerefobject permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MutableRefObject</h3>\n<p>이름만 봐도 알 수 있다.<br>\n변형적인 Ref 객체…(너무 원시적인가 -_-;;)</p>\n<p>무튼 변수와 같은 값을 담는 참조 객체라는 것이다.<br>\n간단한 코드를 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">SomeCom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> ageRef <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">useRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">number</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">click4Event</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    ageRef<span class=\"token punctuation\">.</span>current <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ageRef.current = '</span><span class=\"token punctuation\">,</span> ageRef<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>click4Event<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>한살 Plus<span class=\"token operator\">~</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위 코드를 실행하면 콘솔에 ageRef.current가 +1하는 모습을 볼 수 있을 것이다.<br>\n그리고 랜더링이 일어나지 않는 부분도 확인 가능할 것이다.</p>\n<p>위에서 선언된 세 가지 중 1번 항목이 여기와 같다.</p>\n<blockquote>\n<p>function useRef<T>(initialValue: T): MutableRefObject<T> //1</p>\n</blockquote>\n<p>근데 여기서 무지성으로 ageRef에 숫자 0대신 null을 넣어보자.<br>\n에러가 날 것이다.</p>\n<p>왜 에러가 나냐 하면 선언된 형태 중 1번이 아닌 <strong>2번</strong>을 사용하기 때문이다.\n이유는 아래로 내려가자</p>\n<br>\n<h3 id=\"refobject\" style=\"position:relative;\"><a href=\"#refobject\" aria-label=\"refobject permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RefObject</h3>\n<p>설명에 앞서 아래의 선언을 보자.</p>\n<blockquote>\n<p>function useRef<T>(initialValue: T | null): RefObject<T> //2</p>\n</blockquote>\n<p>잘 보면 전달인자에 제너릭으로 된 초기화 외에 또 올 수 있는 값은 <strong>null</strong>이라고 명시되어 있다.<br>\n이를 보면 위 <strong>MutableRefObject</strong>예제에서 null을 주입했다면 <strong>RefObject</strong>를 반환하는 선언으로 변경된 것을 확인할 수 있다.</p>\n<p><strong>RefObject</strong> 타입은 DOM 유형을 담을 때 사용한다.<br>\n근데 읽기 전용인거 같은데, input 같은거를 ref로 가져와서 수정해보면 또 된다.</p>\n<p>이거는 <strong>current</strong> 하위 속성의 value는 프로퍼티 플래그가 얇은 복사(Shallow)를 하기 때문이다.<br>\n그래서 current 프로퍼티 자체를 수정하려 하면 에러가 나지만, current는 에러가 나지 않는다.</p>\n<br>\n<h3 id=\"기타-사항-및-알아둘-점\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%ED%83%80-%EC%82%AC%ED%95%AD-%EB%B0%8F-%EC%95%8C%EC%95%84%EB%91%98-%EC%A0%90\" aria-label=\"기타 사항 및 알아둘 점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기타 사항 및 알아둘 점</h3>\n<p>useRef는 항상 didMount가 되어 DOM에 반영이 된 후에 사용하자.<br>\n당연한 이야기겠지만 DOM을 참조해야 하는데 DOM이 mount 되기 전이면 당연 값은 null이나 undefined 일 것이다.<br>\n그래서 <strong>useEffect</strong>에서 사용하는 것이 좋다.</p>\n<p>그리고 조건 랜더링이나 컴포넌트가 unmount 되는 상황이 올 수 있기에 항상 체크를 하고 사용하는 것이 좋다.<br>\nif문 등으로 <strong>textInputRef.current</strong> 를 검사하고 사용하면 좋다.</p>\n<h2 id=\"참조\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EC%A1%B0\" aria-label=\"참조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참조</h2>\n<p><a href=\"https://ko.reactjs.org/docs/hooks-reference.html#useref\">React 공식 참조 문서(useRef)</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#useref\">UseRef?</a></p>\n<ul>\n<li><a href=\"#mutablerefobject\">MutableRefObject</a></li>\n<li><a href=\"#refobject\">RefObject</a></li>\n<li><a href=\"#%EA%B8%B0%ED%83%80-%EC%82%AC%ED%95%AD-%EB%B0%8F-%EC%95%8C%EC%95%84%EB%91%98-%EC%A0%90\">기타 사항 및 알아둘 점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%B0%B8%EC%A1%B0\">참조</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2023.01.15","title":"React useRef에 대하여","categories":"react","emoji":"📜"},"fields":{"slug":"/react/230115_useref/"}},"prev":{"id":"eacb5029-7772-508b-a62e-76a8a37a1b84","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVQY0zWQzUpCYRCGP9uUBNlBtALDmVAJxJrRkGBeqkXUJj1GLSopQWxXLVpHm9bRLugH2qcX0BVEVxBdRrsgiBPfsQaG92dW87jUc+s6eAh/0lfN/HR3wxWzdUdijsUcKRyrV58R9/H6rDbBihnfsyAgtTHfu8l+6yO4D6Pgpnk2cC6Rt5USiWVYbJQUWVabIrUcC5IkNktiAauNs2Kd1DZZrcGCHql1WJFwqX74lrprRMHt9n4xU1+mJZyywh93WK3Nal1WHLPYLou1SWyLFCELDlkwz4IjFuux4JwEOZcb7IX8dPDqLirJQhklqqJGCmFFlQVlFiyyoEqCDoudkJiS2BwplBVrJP4DrJLYAgnSLvqKRr7fPzOXL4/OD9Xwx27IL1aJc4EUlX+Wf+yGXr0O/S+t8FTK08kYcAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/95a159ff13e5784dc37dcaa8b9344fb2/7c297/thumbnail.webp 180w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/33ecc/thumbnail.webp 360w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/df77d/thumbnail.webp 720w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/5c666/thumbnail.webp 1080w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/95f20/thumbnail.webp 1440w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/d5269/thumbnail.webp 2560w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/95a159ff13e5784dc37dcaa8b9344fb2/e9ea2/thumbnail.png 180w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/53918/thumbnail.png 360w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/242a6/thumbnail.png 720w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/b4ad3/thumbnail.png 1080w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/89066/thumbnail.png 1440w,\n/static/95a159ff13e5784dc37dcaa8b9344fb2/c7a69/thumbnail.png 2560w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/95a159ff13e5784dc37dcaa8b9344fb2/242a6/thumbnail.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"슬슬-데이터를-이동해볼까\" style=\"position:relative;\"><a href=\"#%EC%8A%AC%EC%8A%AC-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EC%9D%B4%EB%8F%99%ED%95%B4%EB%B3%BC%EA%B9%8C\" aria-label=\"슬슬 데이터를 이동해볼까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>슬슬 데이터를 이동해볼까…</h1>\n<p>기존 개발 서버에서 쓰던 디비를 몇 가지 옮겨서 쓸 일이 있어서 찾아보다가…<br>\n또 잊을까봐 정리해두려고 쓰는 포스팅..</p>\n<p>구성은 Aws Ubuntu의 Docker 환경에서 진행하였다.</p>\n<br>\n<h2 id=\"mongodb-backup\" style=\"position:relative;\"><a href=\"#mongodb-backup\" aria-label=\"mongodb backup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MongoDb Backup</h2>\n<p>일단 Docker 안의 MongoDB에 접근해야 한다.<br>\n접근 명령어는 아래와 같이…<br>\n저 뒤의 <strong>mongo</strong>는 docker 컨테이너 이름인데 각자 알맞게 적어준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo docker exec --it mongo /bin/bash</code></pre></div>\n<p>Shell에 접근 후 전체 디비를 뜨는 경우 옵션을 안줘도 되지만,<br>\n나는 특정 디비만 백업하면 되는 것이라서 아래와 같이 명령어를 수행했다.</p>\n<p>그리고 <strong>out</strong>뒤의 인자는 덤프를 뜬 뒤의 디렉토리를 정해주는건데 Shell 내부 디렉토리를 가리킨다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># mongodump --out /backup/ --db mydb</code></pre></div>\n<p>만약 디비가 없는 경우 아래와 같이 에러가 나므로 주의</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># mongodump --out /backup/ --db mydb\n2023-01-18T11:49:23.716+0900\tFailed: error creating intents to dump: error getting collections for database `mydb`: (Unauthorized) command listCollections requires authentication</code></pre></div>\n<br>\n<p>내 디비의 경우 계정 비밀번호가 있었는데 이 경우 아래와 같이 옵션을 주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> -u : 디비 접근 가능 id\n -p : 계정 암호\n --db : 대상 디비</code></pre></div>\n<p>정상적으로 덤프를 따면 아래와 같이 덤프가 생성되고 담기게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># mongodump --out /backup/ -u mydbuser -p 12345 --db mydb\n2023-01-18T02:56:20.823+0000\twriting mydb.a_data to /backup/mydb/a_data.bson\n2023-01-18T02:56:20.828+0000\twriting mydb.a_data to /backup/mydb/a_data.bson\n2023-01-18T02:56:20.829+0000\twriting mydb.a_data to /backup/mydb/a_data.bson\n2023-01-18T02:56:20.837+0000\tdone dumping mydb.a_data (0 documents)\n2023-01-18T02:56:20.839+0000\tdone dumping mydb.a_data (153 documents)\n2023-01-18T02:56:20.842+0000\tdone dumping mydb.a_data (0 documents)\n2023-01-18T02:56:20.852+0000\twriting mydb.a_data to /backup/mydb/a_data.bson\n2023-01-18T02:56:21.042+0000\tdone dumping mydb.a_data (1051 documents)</code></pre></div>\n<p>이렇게 하면 백업 데이터가 <strong>backup</strong> 디렉토리에 저장이 된다.<br>\n이것을 이제 밖으로 빼려면 아래와 같이 수행한다.<br>\n실행은 shell 밖에서 해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># sudo docker cp [docker 내 컨테이너 이름]:[아까 백업 담겼던 디렉토리] [저장할 디렉토리]\n\n$ sudo docker cp mongo:/backup/ ./my_backup</code></pre></div>\n<br>\n<h2 id=\"mongodb-resotre\" style=\"position:relative;\"><a href=\"#mongodb-resotre\" aria-label=\"mongodb resotre permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MongoDb Resotre</h2>\n<p>위에서는 백업을 했으니 이제는 다시 복원시킬 차례다.<br>\n옮길 곳이 나는 로컬에서 Aws에서 도는 ubuntu였다.</p>\n<p>백업 디렉토리는 파일질라 등으로 옮겨주고…</p>\n<p>이제 대상지도 같은 환경이라 가정하고…<br>\n대상 도커 컨테이너 내에 넣어준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># sudo docker cp [현재 백업파일이 있는 디렉토리] [docker 내 컨테이너 이름]:[docker 내 저장할 디렉토리]\n\n$ sudo docker cp ./my_backup mongo:/backup</code></pre></div>\n<p>그리고 MongoDB에 접속해 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo docker exec -it mongo /bin/bash</code></pre></div>\n<p>그리고 해당 백업 디렉토리가 존재하는지 확인 후 아래의 명령어대로 리스토어를 실행한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># mongorestore -u tester -p 12345 --db mydb ./backup\n2023-01-18T12:05:40.287+0900\tThe --db and --collection flags are deprecated for this use-case; please use --nsInclude instead, i.e. with --nsInclude=${DATABASE}.${COLLECTION}\n2023-01-18T12:05:40.292+0900\tbuilding a list of collections to restore from backup dir\n2023-01-18T12:05:40.293+0900\treading metadata for mydb.a.data from backup/data.metadata.json\n.....\n2023-01-18T12:05:40.490+0900\t1204 document(s) restored successfully. 0 document(s) failed to restore.\n#</code></pre></div>\n<p>이렇게 하면 백업 &#x26; 복원이 간단하게 끝났다.</p>\n<h3 id=\"기타\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%ED%83%80\" aria-label=\"기타 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기타</h3>\n<p>이거를 직접 통신으로 하는 방법도 있던 것 같은데…<br>\n일단 할 일이 많기 때문이 이런 노가다 방법으로 처리했다.</p>\n<p>향후 시간이 될때 더 고차원적인 방법을 찾아봐야겠다.</p>","frontmatter":{"date":"2023.01.18","title":"MongoDB 백업(Backup) & 복원(Restore) (With Docker)","categories":"mongodb","emoji":"📜"},"fields":{"slug":"/mongodb/230118_mongo_dump/"}},"site":{"siteMetadata":{"siteUrl":"https://elfinlas.github.io","comments":{"utterances":{"repo":"elfinlas/blog_utterances"}},"projects":[{"title":"마와셀(웹) - 와인 가격 비교","description":"와인 가격 비교 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223393940649","github":"","web":"https://appmyc.info","googlePlay":"","appStore":""}},{"title":"마와셀(엡) - 와인과 셀러 관리, 시음노트","description":"보유한 와인의 관리, 시음노트 작성, 보유 와인 셀러의 관리 어플리케이션","techStack":["Dart","Flutter","hive","provider"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223531933037","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.myc","appStore":"https://itunes.apple.com/kr/app/apple-store/6474965246"}},{"title":"흑우집합소(웹) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223059966682","github":"","web":"https://bcow.world/","googlePlay":"","appStore":""}},{"title":"흑우집합소(앱) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Dart","Flutter","drift","provider"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223232966579","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.bcow_world","appStore":"https://itunes.apple.com/kr/app/apple-store/6470312130"}}]}}},"pageContext":{"slug":"/node-js/230118_yarn_runs_not_excute/","nextSlug":"/react/230115_useref/","prevSlug":"/mongodb/230118_mongo_dump/"}},"staticQueryHashes":["1186322783","1321405810","3649515864"]}
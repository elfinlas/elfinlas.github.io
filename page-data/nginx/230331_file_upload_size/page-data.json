{"componentChunkName":"component---src-templates-post-template-index-tsx","path":"/nginx/230331_file_upload_size/","result":{"data":{"cur":{"id":"2f17ef50-4797-585f-92f2-b54070e776a6","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAAB4zZGdJL/AP/EABoQAAICAwAAAAAAAAAAAAAAAAABAhEQEiH/2gAIAQEAAQUCtibucu6rCP/EABYRAQEBAAAAAAAAAAAAAAAAAAAREv/aAAgBAwEBPwHSv//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/Aar/xAAZEAEBAAMBAAAAAAAAAAAAAAABABAhIjH/2gAIAQEABj8C9jbcsxj/xAAbEAACAwADAAAAAAAAAAAAAAABEQAhMVFhkf/aAAgBAQABPyFI37Hs6XdRgYdS0FCFXiAC3P/aAAwDAQACAAMAAAAQwP8A/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERUf/aAAgBAwEBPxCMEp//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8QykP/xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAhQXH/2gAIAQEAAT8QWGInt4cFCtTFPPmByQI0na/PJjksDmFCgeuuMhYzu//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/498bbc62b7c7109bb1e79faf8d355cb5/7c297/thumbnail_nginx.webp 180w,\n/static/498bbc62b7c7109bb1e79faf8d355cb5/33ecc/thumbnail_nginx.webp 360w,\n/static/498bbc62b7c7109bb1e79faf8d355cb5/84c6d/thumbnail_nginx.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/498bbc62b7c7109bb1e79faf8d355cb5/98e5d/thumbnail_nginx.jpg 180w,\n/static/498bbc62b7c7109bb1e79faf8d355cb5/543cd/thumbnail_nginx.jpg 360w,\n/static/498bbc62b7c7109bb1e79faf8d355cb5/40619/thumbnail_nginx.jpg 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/498bbc62b7c7109bb1e79faf8d355cb5/40619/thumbnail_nginx.jpg\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"파일-업로드를-했는데\" style=\"position:relative;\"><a href=\"#%ED%8C%8C%EC%9D%BC-%EC%97%85%EB%A1%9C%EB%93%9C%EB%A5%BC-%ED%96%88%EB%8A%94%EB%8D%B0\" aria-label=\"파일 업로드를 했는데 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>파일 업로드를 했는데…</h1>\n<p>흑우집합소를 개발하고, 로컬에서 잘 되던 파일 업로드 기능이 이상하게 배포만 하면 에러가 났다. -_-;;<br>\nNest.Js의 서버측에서는 파일 사이즈를 분명 설정하고 잘 맞춰뒀는데 왜 그런 에러가 발생하는지 이유가 궁금했다…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApklEQVQI1y2M64qDMBhE+/7v1i5eoFA10Xrpqux2f8RqviR7SqMDhwPDMCexnuA93h34A+cIISDWshizsyz71nvESdyISMRayyenop6odIVqGiqtKbWmUIprcYsulULVNasI/+zZgsPYFyKO17qyblt0PHx+XRiznCnNGJOUKcuZs5zH+RK77yRhTFNMWeGaO9K2+H5A2o7nMPDX9/x2HT/3FjM/eAMGm+KgcbtBsAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5478dd8f9eb0b70a42a8af6e0c0d8917/7c297/img01.webp 180w,\n/static/5478dd8f9eb0b70a42a8af6e0c0d8917/33ecc/img01.webp 360w,\n/static/5478dd8f9eb0b70a42a8af6e0c0d8917/df77d/img01.webp 720w,\n/static/5478dd8f9eb0b70a42a8af6e0c0d8917/d571a/img01.webp 809w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5478dd8f9eb0b70a42a8af6e0c0d8917/e9ea2/img01.png 180w,\n/static/5478dd8f9eb0b70a42a8af6e0c0d8917/53918/img01.png 360w,\n/static/5478dd8f9eb0b70a42a8af6e0c0d8917/242a6/img01.png 720w,\n/static/5478dd8f9eb0b70a42a8af6e0c0d8917/55aab/img01.png 809w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5478dd8f9eb0b70a42a8af6e0c0d8917/242a6/img01.png\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>에러는 복잡했는데 Status코드가 <strong>413</strong>이 돌아왔다.</p>\n<p>이 에러 코드는 클라이언트에서 보낸 요청의 크기가 서버에서 설정한 최대 한도를 초과해서 발생하는 문제다.<br>\n근데 서버는 분명 설정을 해뒀으니 누가 문제일까?</p>\n<p>역시 범인은 Nginx였다.</p>\n<h2 id=\"처리방법은\" style=\"position:relative;\"><a href=\"#%EC%B2%98%EB%A6%AC%EB%B0%A9%EB%B2%95%EC%9D%80\" aria-label=\"처리방법은 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>처리방법은?</h2>\n<p>몹시 간단하다.<br>\nNginx의 설정 값 중 <strong>client_max_body_size</strong> 값을 지정해주면 된다. <strong>(마크다운 문법 에러 때문에 _ 조심)</strong></p>\n<h3 id=\"client_max_body_size-설정하기\" style=\"position:relative;\"><a href=\"#client_max_body_size-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"client_max_body_size 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>client_max_body_size 설정하기</h3>\n<p>nginx의 설치된 경로에 별도로 바꾸지 않았다면, <strong>nginx.conf</strong>파일을 열고 아래와 같이 값을 입력해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">user www-data;\nworker_processes auto;\npid /run/nginx.pid;\n\nhttp {\n\n\t##\n\t# Basic Settings\n\t##\n\n\tsendfile on;\n\ttcp_nopush on;\n\ttypes_hash_max_size 2048;\n\tclient_max_body_size 100m; # 이 부분처럼 설정해주고 용량을 적당하게 지정하자.\n\n    ....\n}</code></pre></div>\n<p>이렇게 처리하면 잘 될 것이다.<br>\n만약 위에 client_max_body_size 옵션 만으로도 에러가 지속되면 버퍼쪽도 올려줘야 한다.</p>\n<h3 id=\"proxy_buffer_size와-proxy_buffers-설정하기\" style=\"position:relative;\"><a href=\"#proxy_buffer_size%EC%99%80-proxy_buffers-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"proxy_buffer_size와 proxy_buffers 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>proxy_buffer_size와 proxy_buffers 설정하기</h3>\n<p>참고로 Nginx는 기본 버퍼가 16KB다.<br>\n그래서 이 부분을 더 늘려서 사용하면 된다.</p>\n<p>이것도 위에 나온 경로에 아까 설정한 client_max_body_size 값 바로 아래에 정해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">user www-data;\nworker_processes auto;\npid /run/nginx.pid;\n\nhttp {\n\n\t##\n\t# Basic Settings\n\t##\n\n\tsendfile on;\n\ttcp_nopush on;\n\ttypes_hash_max_size 2048;\n\tclient_max_body_size 100m;\n    proxy_buffer_size   64k; # 버퍼 설정 64KB\n    proxy_buffers   4 64k; # 버퍼 설정 64KB\n\n    ....\n}</code></pre></div>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p><strong>마크다운 버그인지 저기 속성들이 _(언더바)가 들어가는데 2개 이상 쓰면 저렇게 글이 뭉개진다.</strong><br>\n<strong>그래서 저 옵션은 꼭 잘 확인하자.</strong></p>\n<p>이렇게 처리한다면 더 이상 413이니 이상한 에러는 안날 것이다.<br>\n물론 백엔드 코드가 잘못되어 있다면 에러는 발생하겠지만…</p>\n<p>PS : 하다보니 Nginx가 범인이 아니라 무지한 내가 범인인듯…</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%B2%98%EB%A6%AC%EB%B0%A9%EB%B2%95%EC%9D%80\">처리방법은?</a></p>\n<ul>\n<li><a href=\"#client_max_body_size-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\">client_max_body_size 설정하기</a></li>\n<li><a href=\"#proxy_buffer_size%EC%99%80-proxy_buffers-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\">proxy_buffer_size와 proxy_buffers 설정하기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n</li>\n</ul>\n</div>","excerpt":"파일 업로드를 했는데… 흑우집합소를 개발하고, 로컬에서 잘 되던 파일 업로드 기능이 이상하게 배포만 하면 에러가 났다. -_-;; Nest.Js의 서버측에서는 파일 사이즈를 분명 설정하고 잘 맞춰뒀는데 왜 그런 에러가 발생하는지 이유가 궁금했다…  에러는 복잡했는데 Status코드가 413이 돌아왔다. 이 에러 코드는 클라이언트에서 보낸 요청의 크기가 서버에서 설정한 최대 한도를 초과해서 발생하는 문제다. 근데 서버는 분명 설정을 해뒀으니 누가 문제일까? 역시 범인은 Nginx였다. 처리방법은? 몹시 간단하다. Nginx의 설정 값 중 client_max_body_size 값을 지정해주면 된다. (마크다운 문법 에러 때문에 _ 조심) client_max_body_size 설정하기 nginx의 설치된 경로에 별도로 바꾸지 않았다면, nginx.conf파일을 열고 아래와 같이 값을 입력해준다. 이렇게 처리하면 잘 될 것이다. 만약 위에 client_max_body_size 옵션 만으로…","frontmatter":{"date":"2023.03.31","title":"Nginx에서 파일 업로드 사이즈 용량 처리","categories":"nginx","emoji":"📜"},"fields":{"slug":"/nginx/230331_file_upload_size/"}},"next":{"id":"5a2718d3-9222-5d1f-9b76-3b2c466e8c80","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABMElEQVQoz42S0Y6CMBBFW6Cl0GmhxYorrJpAsolP+v8fdzetrqtmxX24GToZztxOhzHGcC+vCEOzwqA9drTCJ3XYmRX2NuDQrJN647A2LYzSeP6fPSciQBTir8KknGegvESTqwRXolwGRmdK/haFEDBNE7bDAOf9Q+26btCWehkYryfy4nbWWmMcxwQmopTjjF+aVRauomVgnFWeZQ85znnSc21XEnxtl4FxLnFOPyApZXJpjEFd18jumnmp0Wn7D4dXYLziPM84Ho84n844n06pwc2hJHS6eePQBpTi8srRTV4UYJwl5fLx9Z3UCNQuA3tlMbuPtIss42grwtZ22BiHnlz6vpw9Dm2PWqpl4A1cWXyFEVRWqLmAzmQSpShSLHnxfrH5NZJQmNzm5YK/0jegveteJRG0qAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/39caabbd44b8d6bf6560fecef746ecb3/7c297/thumbnail_til.webp 180w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/33ecc/thumbnail_til.webp 360w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/df77d/thumbnail_til.webp 720w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/dd3ab/thumbnail_til.webp 895w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/39caabbd44b8d6bf6560fecef746ecb3/e9ea2/thumbnail_til.png 180w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/53918/thumbnail_til.png 360w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/242a6/thumbnail_til.png 720w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/b002d/thumbnail_til.png 895w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/39caabbd44b8d6bf6560fecef746ecb3/242a6/thumbnail_til.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><br><br><br><br></p>\n<h1 id=\"개발하며-얻은-til\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%B0%9C%ED%95%98%EB%A9%B0-%EC%96%BB%EC%9D%80-til\" aria-label=\"개발하며 얻은 til permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개발하며 얻은 TIL</h1>\n<p>흑우집합소 개발하며 얻은 내용 및 노션에 작성한 내용을 정리한 포스팅이다.<br>\n오늘 개발하면서 배운 내용은 아래와 같다.</p>\n<ol>\n<li>예외처리의 미흡함 (예외처리 부분)</li>\n<li>문자열 상수(String Literal) - Typescript Object 키 문제</li>\n<li>반복적 코드를 줄이는 리팩토링</li>\n</ol>\n<p>각 항목은 아래의 내용을 참고하자.</p>\n<h2 id=\"1-예외처리-부분\" style=\"position:relative;\"><a href=\"#1-%EC%98%88%EC%99%B8%EC%B2%98%EB%A6%AC-%EB%B6%80%EB%B6%84\" aria-label=\"1 예외처리 부분 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 예외처리 부분</h2>\n<p>오늘도 개발을 하던 도중 코드가 이상한 부분을 찾게 되었다.<br>\n백엔드 측의 에러 핸들링 부분이었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>exception <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//토큰 문제가 발생한 경우</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-1'</span> <span class=\"token operator\">||</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-2'</span> <span class=\"token operator\">||</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-3'</span> <span class=\"token operator\">||</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-4'</span> <span class=\"token operator\">||</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-5'</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> decodeData <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>decodeJwtOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">accessJwtDecode</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token constant\">HEADER_JWT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//로그아웃 처리</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>logoutAccountInboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      email<span class=\"token operator\">:</span> decodeData<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span>\n      joinType<span class=\"token operator\">:</span> decodeData<span class=\"token punctuation\">.</span>joinType<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token constant\">HEADER_JWT</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Error Handler 부분의 일부다.<br>\n여기서 저기 <strong>const decodeData</strong> 부분의 로직을 보면 request의 헤더로부터 jwt를 가져오는 부분이 있다.</p>\n<p>만약 헤더에 jwt를 안가지고 올 경우 어떻게 될까?<br>\n또 버그를 양산하는 모양새가 된다.</p>\n<p>물론 <strong>jwtStrategy</strong>에서 검증을 하겠지만, 혹시 <strong>AuthExceptionHandler</strong>를 strategy 없이 사용하는 곳에서 발생했다면?<br>\n그래서 이 부분은 검사를 한번 더 하는 방향으로 로직을 수정했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>exception <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//토큰 문제가 발생한 경우</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-1'</span> <span class=\"token operator\">||</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-2'</span> <span class=\"token operator\">||</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-3'</span> <span class=\"token operator\">||</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-4'</span> <span class=\"token operator\">||</span>\n    exception<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token string\">'8-5'</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//만약 JWT가 헤더 안에 있다면...</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token constant\">HEADER_JWT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> decodeData <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>decodeJwtOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">accessJwtDecode</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token constant\">HEADER_JWT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">//로그아웃 처리</span>\n      <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>logoutAccountInboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        email<span class=\"token operator\">:</span> decodeData<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span>\n        joinType<span class=\"token operator\">:</span> decodeData<span class=\"token punctuation\">.</span>joinType<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    response<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token constant\">HEADER_JWT</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 한번 보호를 함으로써 예외를 막을 수 있었다.</p>\n<h2 id=\"2-typescript-object-키-문제\" style=\"position:relative;\"><a href=\"#2-typescript-object-%ED%82%A4-%EB%AC%B8%EC%A0%9C\" aria-label=\"2 typescript object 키 문제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Typescript Object 키 문제</h2>\n<p>개발을 하던 도중 아래와 같은 코드를 작성했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> <span class=\"token constant\">F_HEADER_BKEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test_key'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> defaultH<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">'key-str'</span><span class=\"token operator\">:</span> <span class=\"token string\">'value-str'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">'F_HEADER_BKEY'</span><span class=\"token operator\">:</span> <span class=\"token string\">'111aaa'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'show value = '</span><span class=\"token punctuation\">,</span> defaultH<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이렇게 작성할 경우 결과는 아래와 같아 나온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[LOG]: \"show value = \",  {\n  \"key-str\": \"value-str\",\n  \"F_HEADER_BKEY\": \"111aaa\"\n}</code></pre></div>\n<p>내가 원하는 그림은 <strong>F-HEADER_BKEY</strong>의 값이 저 상수 이름 값이 아닌,<br>\n<strong>test_key</strong> 상수의 값이 들어가길 원했다.</p>\n<p>이 문제를 해결하려면 아래와 같이 작성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> <span class=\"token constant\">F_HEADER_BKEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test_key'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span>\n<span class=\"token keyword\">const</span> defaultH<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">'key-str'</span><span class=\"token operator\">:</span> <span class=\"token string\">'value-str'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\ndefaultH<span class=\"token punctuation\">[</span><span class=\"token constant\">F_HEADER_BKEY</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"aaa\"</span>\n\n<span class=\"token comment\">//결과</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token constant\">LOG</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token string\">\"show value = \"</span><span class=\"token punctuation\">,</span>  <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"key-str\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"value-str\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"test_key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"aaa\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>맨 처음처럼 나타나는 이유는 내가 선언한 <strong>defaultH</strong>의 경우,<br>\n타입이 다음과 같이 <strong>{ [key: string]: string }</strong> 되어 있다.</p>\n<p>즉 key는 string으로 되어 있기에 string 자체로 인식을 해버린다.<br>\n하지만 두 번째 제대로 나오는 부분에서는 Object형에 접근하기 위한 값으로 사용한 것이,<br>\n문자열(string)이 아닌 **상수 문자열(string literal)**를 사용했기에 적용이 된다.</p>\n<p>그리고 하나 더 찝어서 이야기 하면 아래와 같은 코드도 동작이 안될 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">defaultH<span class=\"token punctuation\">.</span><span class=\"token constant\">F_HEADER_BKEY</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"aaa\"</span>\n\n<span class=\"token comment\">//결과</span>\n<span class=\"token punctuation\">[</span><span class=\"token constant\">LOG</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token string\">\"show value = \"</span><span class=\"token punctuation\">,</span>  <span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"key-str\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"value-str\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"test_key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"aaa\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"F_HEADER_BKEY\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"a111\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이거는 간단한 것이 object에 .(Dot)으로 접근 시 해당 키를 이용해 접근하는 방식이다.<br>\n하지만 여기도 <strong>F-HEADER_BKEY</strong>를 문자열 자체로 받아들인다.</p>\n<p>이게 문자열 상수 값으로 받아들여지지 않고, 그냥 문자열 자체로 받아들인단 의미다.<br>\n그래서 혹시 선언된 객체형에 키를 동적으로 쓰고 싶다면 <strong>[]</strong> 형식을 이용해서 접근하는게 좋다.</p>\n<h2 id=\"3-반복적-코드를-줄이는-리팩토링\" style=\"position:relative;\"><a href=\"#3-%EB%B0%98%EB%B3%B5%EC%A0%81-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%A4%84%EC%9D%B4%EB%8A%94-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81\" aria-label=\"3 반복적 코드를 줄이는 리팩토링 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 반복적 코드를 줄이는 리팩토링</h2>\n<p>백엔드 측을 개발하면서 다음과 같은 코드가 있었다.<br>\n(아래 코드는 예시를 위해 사용하여 일부 변수 및 내용이 코드 문법에 어긋날 수 있습니다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JwtStrategy</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">PassportStrategy</span><span class=\"token punctuation\">(</span>Strategy<span class=\"token punctuation\">,</span> <span class=\"token string\">'Jwt'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">VERIFY_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> verifyjwtOutboundPort<span class=\"token operator\">:</span> VerifyJwtOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">DECODE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> decodJwtOutboundPort<span class=\"token operator\">:</span> DecodeJwtOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">CREATE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> createJwtOutboundPort<span class=\"token operator\">:</span> CreateJwtOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_ACCOUNT_EMAIL_JOINTYPE_STATUS_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findAccountEmailJoinTypeOutboundPort<span class=\"token operator\">:</span> FindAccountEmainJoinTypeStatusOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">LOGOUT_ACCOUNT_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> logoutAccountInboundPort<span class=\"token operator\">:</span> LogoutAccountInboundPort<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token operator\">&lt;</span>ParamsDictionary<span class=\"token punctuation\">,</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> ParsedQs<span class=\"token punctuation\">,</span> Record<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">any</span><span class=\"token operator\">>></span><span class=\"token punctuation\">,</span> options<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>res<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> jwt <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token constant\">HEADER_JWT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/**\n     * JWT가 존재하지 않는 경우 에러 처리\n     */</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>jwt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">(</span>AuthJwtErrorCode<span class=\"token punctuation\">.</span><span class=\"token function\">jwtNotFound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> account<span class=\"token operator\">:</span> Account <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAccountInJwt</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">,</span> <span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//...Some work</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">//JWT 내에서 계정 정보를 가져오는 함수</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token function\">getAccountInJwt</span><span class=\"token punctuation\">(</span>jwt<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> tokenType<span class=\"token operator\">:</span> JwtType<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>Account<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//Access가 만료된 경우 리프레시 토큰도 체크해줘야 한다.</span>\n    <span class=\"token keyword\">const</span> jwtData <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>decodJwtOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">accessJwtDecode</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//계정 정보를 가져온다.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>findAccountEmailJoinTypeOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      u_email<span class=\"token operator\">:</span> jwtData<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span>\n      ua_joinType<span class=\"token operator\">:</span> jwtData<span class=\"token punctuation\">.</span>joinType<span class=\"token punctuation\">,</span>\n      uStatus<span class=\"token operator\">:</span> <span class=\"token constant\">ACCOUNT_STATUS_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACTIVE</span><span class=\"token punctuation\">,</span>\n      uAccAuth<span class=\"token operator\">:</span> jwtData<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>근데 코드를 작성하다보니…<strong>getAccountInJwt</strong> 함수의 경우 다른 곳에서도 비슷한 방식으로 사용되고 있었다.<br>\n쉽게말해 중복적으로 코드가 작성되고 있었다.</p>\n<p>이 부분은 <strong>Inbound Port</strong> 성향의 서비스 로직으로 분리할 수 있었다.<br>\n난 <strong>Port &#x26; Adaptor</strong> 아키텍쳐 방식을 사용할 때 In과 Out을 저번에 받은 강의 내요을 토대로 사용한다.</p>\n<p>In 성향은 외부 세계에서 요청이 오는 경우로 나누고,<br>\nOut은 백엔드 내에서 처리하여 인프라 쪽과 연계되는 경우로 나눈다.</p>\n<p>지금처럼 Jwt를 받아서 그 안에 담겨있는 정보를 요청해야 하는 경우,<br>\n이 성향은 Inbound 성향이라 할 수 있다.</p>\n<p>설령 내부에서 호출한다 해도 jwt라는 속성 자체가 외부에서 오기 때문이다.<br>\n물론 인프라 측의 DB 로직을 한번 타긴 하는데, 난 이런 경우 처음 접근하는 변수를 기준으로 잡는다.</p>\n<p>그래서 이 부분은 <strong>Inbound Port</strong>로 만들었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//Inbound Port 정의</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> JwtType <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'src/domain/auth/types/jwt.enums'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">GET_ACCOUNT_IN_JWT_INBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'Get_Account_In_Jwt_Inbound_Port'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">GetAccountInJwtInputDto</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  jwt<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  jwtType<span class=\"token operator\">:</span> JwtType<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">GetAccountInJwtOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">GetAccountInJwtInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">excute</span><span class=\"token punctuation\">(</span>params<span class=\"token operator\">:</span> GetAccountInJwtInputDto<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//인바운드 인터페이스 구현체 서비스</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetAccountInJwtService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">GetAccountInJwtInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">DECODE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> decodJwtOutboundPort<span class=\"token operator\">:</span> DecodeJwtOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_ACCOUNT_EMAIL_JOINTYPE_STATUS_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findAccountEmailJoinTypeOutboundPort<span class=\"token operator\">:</span> FindAccountEmainJoinTypeStatusOutboundPort<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">excute</span><span class=\"token punctuation\">(</span>params<span class=\"token operator\">:</span> GetAccountInJwtInputDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//Access가 만료된 경우 리프레시 토큰도 체크해줘야 한다.</span>\n    <span class=\"token keyword\">const</span> jwtData <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>decodJwtOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">accessJwtDecode</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>jwt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//계정 정보를 가져온다.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>findAccountEmailJoinTypeOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      u_email<span class=\"token operator\">:</span> jwtData<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span>\n      ua_joinType<span class=\"token operator\">:</span> jwtData<span class=\"token punctuation\">.</span>joinType<span class=\"token punctuation\">,</span>\n      uStatus<span class=\"token operator\">:</span> <span class=\"token constant\">ACCOUNT_STATUS_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACTIVE</span><span class=\"token punctuation\">,</span>\n      uAccAuth<span class=\"token operator\">:</span> jwtData<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>위와 같이 별도 Inbound Service로 분리할 경우 아래와 같이 간단하게 작성할 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token comment\">//여기서 아래의 getAccountInJwtService 인터페이스 주입을 해준다.</span>\n\n<span class=\"token comment\">//Get Account</span>\n<span class=\"token keyword\">const</span> account<span class=\"token operator\">:</span> Account <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>getAccountInJwtService<span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> jwt<span class=\"token punctuation\">,</span> jwtType<span class=\"token operator\">:</span> <span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//기존 코드</span>\n<span class=\"token comment\">//const account: Account = await this.getAccountInJwt(jwt, JWT_TYPE.ACCESS_TOKEN);</span></code></pre></div>\n<br>\n<p>이렇게 함으로써 다른 영역에서도 해당 로직을 재사용할 수 있게 되었다.</p>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>개발을 하면서 계속 더 나은 코드를 작성하는 건 뭐랄까…<br>\n완벽할 수 없지만, 완벽에 가까워지도록 하는 형태가 된다고 해야 할까?</p>\n<p>그런 의미로 리팩토링은 참 재미있는 것 같다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#1-%EC%98%88%EC%99%B8%EC%B2%98%EB%A6%AC-%EB%B6%80%EB%B6%84\">1. 예외처리 부분</a></li>\n<li><a href=\"#2-typescript-object-%ED%82%A4-%EB%AC%B8%EC%A0%9C\">2. Typescript Object 키 문제</a></li>\n<li><a href=\"#3-%EB%B0%98%EB%B3%B5%EC%A0%81-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%A4%84%EC%9D%B4%EB%8A%94-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81\">3. 반복적 코드를 줄이는 리팩토링</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></li>\n</ul>\n</div>","frontmatter":{"date":"2023.03.31","title":"23년 3월 24일 TIL & 개발노트 (Typescript에서 문자열 상수, 그리고 코드 리팩토링)","categories":"til","emoji":"📜"},"fields":{"slug":"/til/230324_til/"}},"prev":{"id":"e60e3535-0e51-5dbf-b163-d223bb2d970c","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQoz5VSTUsCURT1X7TqY9O+VbRQIdpWizZCqxb1A4JWBS3cFAgtIspNiyCCoEVBRWJJQhqWFbop6GNg+nJSEccZ5+PNeyfm6ehIRnbgvHfhvXvu4d7rAQBGKacbjDFOd/wXbXicwIEliND2I+2F7cKu2Hl3//VwkVwe8nwIBV8AheFJFPwBkCeh1bFFWxL5TazarVTBTFJzaB/y4gqkXh+kHi9y3V4Ux2c47UK0okDd3IW2dwwzcw8jcQ395BzGVQba4RnIo4DK8gas14+mIJUrYFUNRjyFr4FRSP0jyHUNwkikQWUFcnAV+mmCF5YXQjBvstAjcZRng1y0srQOWizVe2jVbBupO6jhbZSm5iD1+ZEfmgARRDC1Cu0oBjOdhXF5C+0gCj2W5I5sUfLwDD16Aevtsy5Ia/0gLyLU8A6UtS0Ux6ZhJNMtze8EjaG4J2WJ76Bluf26UNaYtGPEWbkfa8M/EdKs5iT+gw3BX3eNtbrvBN9Ty+sRGu0ozQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7685b7a900370c34be4e657df3f862d/7c297/thumbnail_nestjs.webp 180w,\n/static/b7685b7a900370c34be4e657df3f862d/33ecc/thumbnail_nestjs.webp 360w,\n/static/b7685b7a900370c34be4e657df3f862d/84c6d/thumbnail_nestjs.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7685b7a900370c34be4e657df3f862d/e9ea2/thumbnail_nestjs.png 180w,\n/static/b7685b7a900370c34be4e657df3f862d/53918/thumbnail_nestjs.png 360w,\n/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"배포를-하기-전에\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%ED%8F%AC%EB%A5%BC-%ED%95%98%EA%B8%B0-%EC%A0%84%EC%97%90\" aria-label=\"배포를 하기 전에 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배포를 하기 전에…</h1>\n<p><a href=\"https://bcow.world\">흑우집합소</a> 테섭에 배포를 하고나서 몇 가지 테스트를 진행하던 도중 pm2 로그를 잠시 확인했다.</p>\n<p><img src=\"/img01.png\" alt=\"\"></p>\n<p>저기 보면 clientIp라고 되어 있는 곳에 IP가 뜨는데 뭔가 좀 이상했다…<br>\nIpV4가 나와야 하는데 IpV6 형식으로 나왔다.</p>\n<p>사실 큰 상관은 없을 것 같은데 그래도 서버 내에서 로깅이나 확인할 때 IpV6 형식으로 되어 있다면 불편할 것 같았다.<br>\n그래서 이걸 V4 형식으로 바꿨다.</p>\n<p>방법은 여러가지가 있지만, 제일 쉽고 아무것도 설치하지 않아도 되는 방식으로 했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> NestFactory<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>AppModule<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> bodyParser<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//Some init</span>\n\n  <span class=\"token keyword\">await</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0.0.0.0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'[SERVER-ON] = '</span><span class=\"token punctuation\">,</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>저렇게 <strong>app.listen</strong>함수 뒤에 전달인자로 <strong>hostname</strong>을 전달해주면 된다.<br>\n저 함수를 타보면 아래와 같은 형태이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">/**\n     * Starts the application.\n     *\n     * @param {number|string} port\n     * @param {string} [hostname]\n     * @param {Function} [callback] Optional callback\n     * @returns {Promise} A Promise that, when resolved, is a reference to the underlying HttpServer.\n     */</span>\n    <span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> callback<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> hostname<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> callback<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>저 hostname에 ipv4 형식을 문자열로 전달하면 이제 Nest.Js 내에서 ip 주소 표현은 IpV4로 바뀌게 된다.</p>","frontmatter":{"date":"2023.04.01","title":"Nest.js에서 Ip 조회할 때 IpV6로 표시되는 것을 IpV4로 바꾸기","categories":"nest_js","emoji":"📜"},"fields":{"slug":"/nest_js/230401_ipv6_ipv4/"}},"site":{"siteMetadata":{"siteUrl":"https://elfinlas.github.io","comments":{"utterances":{"repo":"elfinlas/blog_utterances"}},"projects":[{"title":"마와셀(웹) - 와인 가격 비교","description":"와인 가격 비교 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223393940649","github":"","web":"https://appmyc.info","googlePlay":"","appStore":""}},{"title":"마와셀(엡) - 와인과 셀러 관리, 시음노트","description":"보유한 와인의 관리, 시음노트 작성, 보유 와인 셀러의 관리 어플리케이션","techStack":["Dart","Flutter","hive","provider"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223531933037","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.myc","appStore":"https://itunes.apple.com/kr/app/apple-store/6474965246"}},{"title":"흑우집합소(웹) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223059966682","github":"","web":"https://bcow.world/","googlePlay":"","appStore":""}},{"title":"흑우집합소(앱) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Dart","Flutter","drift","provider"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223232966579","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.bcow_world","appStore":"https://itunes.apple.com/kr/app/apple-store/6470312130"}}]}}},"pageContext":{"slug":"/nginx/230331_file_upload_size/","nextSlug":"/til/230324_til/","prevSlug":"/nest_js/230401_ipv6_ipv4/"}},"staticQueryHashes":["1186322783","1321405810","3649515864"]}
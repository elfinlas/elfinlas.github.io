{"componentChunkName":"component---src-templates-post-template-index-tsx","path":"/letsencrypt/211105_letscert-fail/","result":{"data":{"cur":{"id":"e8a0547b-d342-55b2-8418-d2dedec58e82","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHt01Eg/8QAFxABAQEBAAAAAAAAAAAAAAAAAQIAIP/aAAgBAQABBQKlMVXP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAQUAAAAAAAAAAAAAAAAAIQABAhEg/9oACAEBAAY/Ag1oxz//xAAbEAABBAMAAAAAAAAAAAAAAAARAAEgIUFRkf/aAAgBAQABPyEAUn4szvUf/9oADAMBAAIAAwAAABAwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQEAAgMAAAAAAAAAAAAAAAERACEgMXH/2gAIAQEAAT8QCuYMTSdtxKAa1BD3fH//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bb33e76bd9db94cffcc5ccf708664183/7c297/thumbnail.webp 180w,\n/static/bb33e76bd9db94cffcc5ccf708664183/33ecc/thumbnail.webp 360w,\n/static/bb33e76bd9db94cffcc5ccf708664183/df77d/thumbnail.webp 720w,\n/static/bb33e76bd9db94cffcc5ccf708664183/5c666/thumbnail.webp 1080w,\n/static/bb33e76bd9db94cffcc5ccf708664183/95f20/thumbnail.webp 1440w,\n/static/bb33e76bd9db94cffcc5ccf708664183/0b34d/thumbnail.webp 1920w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bb33e76bd9db94cffcc5ccf708664183/98e5d/thumbnail.jpg 180w,\n/static/bb33e76bd9db94cffcc5ccf708664183/543cd/thumbnail.jpg 360w,\n/static/bb33e76bd9db94cffcc5ccf708664183/20801/thumbnail.jpg 720w,\n/static/bb33e76bd9db94cffcc5ccf708664183/b37e7/thumbnail.jpg 1080w,\n/static/bb33e76bd9db94cffcc5ccf708664183/33266/thumbnail.jpg 1440w,\n/static/bb33e76bd9db94cffcc5ccf708664183/aaf92/thumbnail.jpg 1920w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bb33e76bd9db94cffcc5ccf708664183/20801/thumbnail.jpg\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"220925-내용-추가\" style=\"position:relative;\"><a href=\"#220925-%EB%82%B4%EC%9A%A9-%EC%B6%94%EA%B0%80\" aria-label=\"220925 내용 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22.09.25 내용 추가</h1>\n<p>여기서 진행한 방식의 경우 <strong>standalone</strong> 방식이다.<br>\n이 방식은 80포트를 강제로 내려서 인증 대상이 진짜 사용하는 서비스인지를 체크하기에 매우 비효율적인 방식이다.</p>\n<p>최근 방식의 경우 Webroot나 DNS 인증을 사용하는데, 이번에 DNS 인증에 대하여 포스팅을 진행했다.<br>\nWebroot도 사용하지만 와일드카드(ex: *.api.com 등) 인증이 불가하기 때문에 DNS 인증을 사용할 것을 추천한다.<br>\nDNS 인증 방식이 필요한 경우 아래 포스팅을 참고하자.</p>\n<p><a href=\"https://elfinlas.github.io/letsencrypt/220923_use-letsencrypt\">LetsEncrypt 적용법 (DNS 인증 &#x26; AWS)</a></p>\n<br>\n<h2 id=\"letsencrypt-갱신이-불가능\" style=\"position:relative;\"><a href=\"#letsencrypt-%EA%B0%B1%EC%8B%A0%EC%9D%B4-%EB%B6%88%EA%B0%80%EB%8A%A5\" aria-label=\"letsencrypt 갱신이 불가능 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Let’sEncrypt 갱신이 불가능??</h2>\n<p>Let’sEncrypt를 적용하고 나서 갱신 테스트를 해보는데 이상한 에러를 마주했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Attempting to renew cert (dev.net) from /your/letsencrypt/path/renewal/dev.net.conf produced an unexpected error: The manual plugin is not working; there may be problems with your existing configuration.\n\nThe error was: PluginError('An authentication script must be provided with --manual-auth-hook when using the manual plugin non-interactively.'). Skipping.\nAll renewal attempts failed. The following certs could not be renewed:\n  /your/letsencrypt/path/live/dev.net/fullchain.pem (failure)</code></pre></div>\n<p>아 뭐가 이렇게 안되지? 라고 삽질했었으나…<br>\n이것저것 찾아본 결과 아래의 문제가 원인이었다</p>\n<blockquote>\n<p>원인은 갱신을 auto 모드가 아닌 manual 모드로 진행한 문제</p>\n</blockquote>\n<p>원인을 제공했던 명령어는 다음과 같다</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo certbot certonly --manual --preferred-challenges=dns --email test@test.com --server https://acme-v02.api.letsencrypt.org/directory --agree-tos --debug --no-bootstrap -d dev.net</code></pre></div>\n<p><strong>메뉴얼 모드로 만든 인증서는 자동으로 갱신이 불가능하다.</strong><br>\n그래서 난…다시 오토 모드로 새로 만들었다…</p>\n<p>이 문제를 겪으신 분은 다시 오토 모드로 빠르게 시작하는걸…추천한다..\n난 어떻게 해보려다가 1시간 말아먹었다…</p>\n<ul>\n<li><a href=\"https://darkstart.tistory.com/109?category=871909\">참고 블로그</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#letsencrypt-%EA%B0%B1%EC%8B%A0%EC%9D%B4-%EB%B6%88%EA%B0%80%EB%8A%A5\">Let’sEncrypt 갱신이 불가능??</a></li>\n</ul>\n</div>","excerpt":"22.09.25 내용 추가 여기서 진행한 방식의 경우 standalone 방식이다. 이 방식은 80포트를 강제로 내려서 인증 대상이 진짜 사용하는 서비스인지를 체크하기에 매우 비효율적인 방식이다. 최근 방식의 경우 Webroot나 DNS 인증을 사용하는데, 이번에 DNS 인증에 대하여 포스팅을 진행했다. Webroot도 사용하지만 와일드카드(ex: *.api.com 등) 인증이 불가하기 때문에 DNS 인증을 사용할 것을 추천한다. DNS 인증 방식이 필요한 경우 아래 포스팅을 참고하자. LetsEncrypt 적용법 (DNS 인증 & AWS) Let’sEncrypt 갱신이 불가능?? Let’sEncrypt를 적용하고 나서 갱신 테스트를 해보는데 이상한 에러를 마주했다. 아 뭐가 이렇게 안되지? 라고 삽질했었으나… 이것저것 찾아본 결과 아래의 문제가 원인이었다 원인은 갱신을 auto 모드가 아닌 manual 모드로 진행한 문제 원인을 제공했던 명령어는 다음과 같다 메뉴얼 모드로 만든 …","frontmatter":{"date":"2021.11.05","title":"Let'sEncrypt 갱신이 불가할 때 (produced an unexpected error The manual plugin is not working)","categories":"letsencrypt","emoji":"📜"},"fields":{"slug":"/letsencrypt/211105_letscert-fail/"}},"next":{"id":"bb244d93-b04a-54c3-af51-134296f4af72","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHt01Eg/8QAFxABAQEBAAAAAAAAAAAAAAAAAQIAIP/aAAgBAQABBQKlMVXP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAQUAAAAAAAAAAAAAAAAAIQABAhEg/9oACAEBAAY/Ag1oxz//xAAbEAABBAMAAAAAAAAAAAAAAAARAAEgIUFRkf/aAAgBAQABPyEAUn4szvUf/9oADAMBAAIAAwAAABAwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQEAAgMAAAAAAAAAAAAAAAERACEgMXH/2gAIAQEAAT8QCuYMTSdtxKAa1BD3fH//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bb33e76bd9db94cffcc5ccf708664183/7c297/thumbnail.webp 180w,\n/static/bb33e76bd9db94cffcc5ccf708664183/33ecc/thumbnail.webp 360w,\n/static/bb33e76bd9db94cffcc5ccf708664183/df77d/thumbnail.webp 720w,\n/static/bb33e76bd9db94cffcc5ccf708664183/5c666/thumbnail.webp 1080w,\n/static/bb33e76bd9db94cffcc5ccf708664183/95f20/thumbnail.webp 1440w,\n/static/bb33e76bd9db94cffcc5ccf708664183/0b34d/thumbnail.webp 1920w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bb33e76bd9db94cffcc5ccf708664183/98e5d/thumbnail.jpg 180w,\n/static/bb33e76bd9db94cffcc5ccf708664183/543cd/thumbnail.jpg 360w,\n/static/bb33e76bd9db94cffcc5ccf708664183/20801/thumbnail.jpg 720w,\n/static/bb33e76bd9db94cffcc5ccf708664183/b37e7/thumbnail.jpg 1080w,\n/static/bb33e76bd9db94cffcc5ccf708664183/33266/thumbnail.jpg 1440w,\n/static/bb33e76bd9db94cffcc5ccf708664183/aaf92/thumbnail.jpg 1920w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bb33e76bd9db94cffcc5ccf708664183/20801/thumbnail.jpg\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"220925-내용-추가\" style=\"position:relative;\"><a href=\"#220925-%EB%82%B4%EC%9A%A9-%EC%B6%94%EA%B0%80\" aria-label=\"220925 내용 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>22.09.25 내용 추가</h1>\n<p>여기서 진행한 방식의 경우 <strong>standalone</strong> 방식이다.<br>\n이 방식은 80포트를 강제로 내려서 인증 대상이 진짜 사용하는 서비스인지를 체크하기에 매우 비효율적인 방식이다.</p>\n<p>최근 방식의 경우 Webroot나 DNS 인증을 사용하는데, 이번에 DNS 인증에 대하여 포스팅을 진행했다.<br>\nWebroot도 사용하지만 와일드카드(ex: *.api.com 등) 인증이 불가하기 때문에 DNS 인증을 사용할 것을 추천한다.<br>\nDNS 인증 방식이 필요한 경우 아래 포스팅을 참고하자.</p>\n<p><a href=\"https://elfinlas.github.io/letsencrypt/220923_use-letsencrypt\">LetsEncrypt 적용법 (DNS 인증 &#x26; AWS)</a></p>\n<br>\n<h2 id=\"letsencrypt-유효기간\" style=\"position:relative;\"><a href=\"#letsencrypt-%EC%9C%A0%ED%9A%A8%EA%B8%B0%EA%B0%84\" aria-label=\"letsencrypt 유효기간 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Let’sEncrypt 유효기간?</h2>\n<blockquote>\n<p>혹시 아직 Let’sEncrypt를 설치하지 않으신 분이라면 <a href=\"https://elfinlas.github.io/letsencrypt/211105_letsencrypt-install/\">Let’sEncrypt 설치후 AWS에 적용하기</a> 에 설치법을 참고하시길 바란다</p>\n</blockquote>\n<p>Let’sEncrypt는 무료인 대신에 인증서를 주기적으로 인증해줘야 한다<br>\n그래서 보통 이것을 크론탭으로 처리해서 편하게 간다.</p>\n<p>경각심(?)을 위해 직접 갱신하는 분(?)도 봤지만…자동으로 하는게 정신 건강에 좋다..<br>\n물론 LetsEncrypt 팀에서 메일을 주기도 한다. (만료 10일전, 당일) 이렇게?</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsElEQVQoz3WRyY7UMBCG8z7cQeLpuM5lxNyQkFjEBR6A6xxaQhwQ3KaX6YbO5nScxXbs9OYk/48ccRoJS59KVqlcrq+iutFMMoG6rpgLwSzLeDgc6L3nMAwIcRzHPclvAL6TfCD5iuQzki8BvCD53Hv/83w+M/LXK7RSFEL4LMve5nl+m6bprZTyjbX2Yq3l6XT6QfIjgC8APgP4BOA9gA8A3oU7ySNJRrmb8Kc5Ubc1mqbVSqnWGNMCUCQRAMBpmv5LyIfG1lpExh1pj2eE2mEYwngzT85EciA5/mN4yjiOCI9HvbNTEseDEGIoy9IXReGrqgpxCD6LooAQObRq6WxH23XsnWVnDI3R88+6rqNzjsYYRkoprlYrbrfbmc1mM7PebPiwXGK9XnO1fuTvRDAVJeOsYJwdmArJNC+ZJEnwz7IseTweGfV9/2u3290IIe7iOH4dx/Hdfr+/ESL/2jb17FYZi9JcWagLD/pKoa4stKfsPOu6Ye/crCm4jC6XS15V1b2UctE0zUJW1aKu5L3Up6V0pHRAaSfUbqLpLFVb0xpNo1sGDWFCrfW8nLDlv2m2VXnYzij9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/23bd11ee4136eab350fd4b6e5d41bae8/7c297/img_01.webp 180w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/33ecc/img_01.webp 360w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/df77d/img_01.webp 720w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/5c666/img_01.webp 1080w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/95f20/img_01.webp 1440w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/a3b48/img_01.webp 1534w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/23bd11ee4136eab350fd4b6e5d41bae8/e9ea2/img_01.png 180w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/53918/img_01.png 360w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/242a6/img_01.png 720w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/b4ad3/img_01.png 1080w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/89066/img_01.png 1440w,\n/static/23bd11ee4136eab350fd4b6e5d41bae8/68141/img_01.png 1534w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/23bd11ee4136eab350fd4b6e5d41bae8/242a6/img_01.png\"\n            alt=\"img 01\"\n            title=\"img 01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>저번에 크론탭으로 해뒀는데 뭔가 잘못 건들여서 실행이 안되어 이번에 다시 셋팅하게 되었고 내용을 정리해서 올려본다.</p>\n<h2 id=\"letsencrypt-crontab-적용해보기\" style=\"position:relative;\"><a href=\"#letsencrypt-crontab-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"letsencrypt crontab 적용해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Let’sEncrypt Crontab 적용해보기</h2>\n<h3 id=\"갱신-기간-여부-확인\" style=\"position:relative;\"><a href=\"#%EA%B0%B1%EC%8B%A0-%EA%B8%B0%EA%B0%84-%EC%97%AC%EB%B6%80-%ED%99%95%EC%9D%B8\" aria-label=\"갱신 기간 여부 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>갱신 기간 여부 확인</h3>\n<p>LetsEncrypt 인증서는 90일 유효하며, 만료 20일 전부터 갱신이 가능하다.<br>\n갱신이 가능한지 여부는 아래의 명령어를 통해 확인이 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> sudo certbot certificates</code></pre></div>\n<p>아래는 커맨드 후 결과 예시이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ubuntu@:~$ sudo certbot certificates\nSaving debug log to /your/letsencrypt/path/letsencrypt.log\n\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nFound the following certs:\n  Certificate Name: dev.net\n    Serial Number: 22233344URSerialNumber\n    Key Type: RSA\n    Domains: dev.net\n    Expiry Date: 2123-12-31 00:00:00+00:00 (VALID: 89 days)\n    Certificate Path: /your/letsencrypt/path/fullchain.pem\n    Private Key Path: /your/letsencrypt/path/privkey.pem\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</code></pre></div>\n<p>인증 기간이 20일 이하면 가능하다.</p>\n<h3 id=\"갱신-여부-확인\" style=\"position:relative;\"><a href=\"#%EA%B0%B1%EC%8B%A0-%EC%97%AC%EB%B6%80-%ED%99%95%EC%9D%B8\" aria-label=\"갱신 여부 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>갱신 여부 확인</h3>\n<p>먼저 갱신이 제대로 되는지 테스트를 해보려면 아래의 명령어를 수행해본다</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> sudo certbot renew --pre-hook \"service nginx stop\" --post-hook \"service nginx start\" --dry-run</code></pre></div>\n<p>미들웨어는 자신이 맞는거를 사용하면 된다. (필자는 nginx)<br>\n뒤에 —dry-run 이 테스트를 수행하게 해주는 옵션이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ubuntu@:~$ sudo certbot renew --pre-hook \"service nginx stop\" --post-hook \"service nginx start\" --dry-run\nSaving debug log to /your/letsencrypt/path/letsencrypt.log\n\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nProcessing /your/letsencrypt/path/renewal/dev.net.conf\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nSimulating renewal of an existing certificate for dev.net\n\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nCongratulations, all simulated renewals succeeded:\n  /your/letsencrypt/path/live/dev.net/fullchain.pem (success)\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</code></pre></div>\n<p>위와 같이 축하한다고 뜨면 인증하는데 문제가 없다는 뜻이다.</p>\n<blockquote>\n<p>PS : 만약 인증이 안된다고 뜨고 에러에 다음과 같은 구문(produced an unexpected error The manual plugin is not working) 이 있는 경우 <a href=\"https://elfinlas.github.io/letsencrypt/211105_renew-certbot\">이곳</a>을 참고하자.</p>\n</blockquote>\n<br>\n<h3 id=\"갱신-처리-with-crontab\" style=\"position:relative;\"><a href=\"#%EA%B0%B1%EC%8B%A0-%EC%B2%98%EB%A6%AC-with-crontab\" aria-label=\"갱신 처리 with crontab permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>갱신 처리 (With crontab)</h3>\n<p>먼저 크론탭을 열어 작성해주고…</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> crontab -e</code></pre></div>\n<p>만약 크론탭이 먼저 선등록 되어 있는지 확인하려면..</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> cat /etc/crontab -> 등록된 크론탭 확인</code></pre></div>\n<p>먼저 난 3개월마다 매 1일에 스크립트를 수행하게 해줬다.<br>\n크론탭 명령어는 아래와 같이 작성했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> 1 0 1 1-12/3 * sudo certbot renew --pre-hook \"service nginx stop\" --post-hook \"service nginx start\" >> /mylog/letsencrypt/log/$(date '+%Y%m%d').log</code></pre></div>\n<p>그리고 마지막으로 크론탭을 재시작 해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> sudo service cron restart</code></pre></div>\n<p>그럼 이제 정상적으로 등록이 된 것이다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#letsencrypt-%EC%9C%A0%ED%9A%A8%EA%B8%B0%EA%B0%84\">Let’sEncrypt 유효기간?</a></p>\n</li>\n<li>\n<p><a href=\"#letsencrypt-crontab-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0\">Let’sEncrypt Crontab 적용해보기</a></p>\n<ul>\n<li><a href=\"#%EA%B0%B1%EC%8B%A0-%EA%B8%B0%EA%B0%84-%EC%97%AC%EB%B6%80-%ED%99%95%EC%9D%B8\">갱신 기간 여부 확인</a></li>\n<li><a href=\"#%EA%B0%B1%EC%8B%A0-%EC%97%AC%EB%B6%80-%ED%99%95%EC%9D%B8\">갱신 여부 확인</a></li>\n<li><a href=\"#%EA%B0%B1%EC%8B%A0-%EC%B2%98%EB%A6%AC-with-crontab\">갱신 처리 (With crontab)</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2021.11.05","title":"Let'sEncrypt 자동 갱신 처리하기","categories":"letsencrypt","emoji":"📜"},"fields":{"slug":"/letsencrypt/211105_renew-certbot/"}},"prev":{"id":"cff3d302-6237-52ca-9664-3b3953f576f7","html":"<h2 id=\"vscode로-node-개발을-진행하다가\" style=\"position:relative;\"><a href=\"#vscode%EB%A1%9C-node-%EA%B0%9C%EB%B0%9C%EC%9D%84-%EC%A7%84%ED%96%89%ED%95%98%EB%8B%A4%EA%B0%80\" aria-label=\"vscode로 node 개발을 진행하다가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VSCode로 Node 개발을 진행하다가…</h2>\n<p>공부 겸 이번 프로젝트에 적용시키려고 Node를 공부하고 예제를 돌려보려던 중…<br>\n이상한 점을 발견했다.</p>\n<p><strong>express</strong>를 분명 <strong>yarn add express</strong> 이렇게 로컬 프로젝트 영역에 설치했음에도 VSCode에서 해당 모듈을 참고하는 곳은 엉뚱한 곳을 가리키고 있었다.</p>\n<p>경로가 Mac OS 기준으로..</p>\n<blockquote>\n<p>/User/YourHome/Library/Caches/typescript/YourVersion/node_modules/@types/…</p>\n</blockquote>\n<p>이상해서 저기를 열었다가 지워도 똑같이 생성되고 계속 참조했다.<br>\n그래서 이곳저곳 찾다가…<br>\n아주 간단하게 해결하였다.</p>\n<br>\n<h2 id=\"solution\" style=\"position:relative;\"><a href=\"#solution\" aria-label=\"solution permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solution</h2>\n<ol>\n<li>VSCode의 환경설정을 들어가서 (Mac 기준 : Command + ,) 검색창에 아래의 키워드 검색</li>\n<li><strong>disableAutomaticTypeAcquisition</strong> 이거 항목이 체크가 안되어 있을건데 체크해준다.</li>\n<li>라이브러리 참조 영역을 삭제하고 VSCode 재시작 해본다.</li>\n</ol>\n<p><img src=\"/img01.png\" alt=\"\"></p>\n<br>\n<h3 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h3>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/48480676/why-vscode-is-importing-packages-from-typescript-cache\">스택오버플로우 유사 질문</a></li>\n<li><a href=\"https://blog.actorsfit.in/a?ID=01700-fdba4144-d6f0-41bd-a475-59f7cc21ca68\">해답</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#vscode%EB%A1%9C-node-%EA%B0%9C%EB%B0%9C%EC%9D%84-%EC%A7%84%ED%96%89%ED%95%98%EB%8B%A4%EA%B0%80\">VSCode로 Node 개발을 진행하다가…</a></p>\n</li>\n<li>\n<p><a href=\"#solution\">Solution</a></p>\n<ul>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2021.11.09","title":"VSCode에서 노드 모듈이 이상한 곳을 가리킬 때.. (.../Library/Caches/typescript/.../node_modules/@types/.....)","categories":"node-js","emoji":"📜"},"fields":{"slug":"/node-js/211109-vscode-nodemodule/"}},"site":{"siteMetadata":{"siteUrl":"https://elfinlas.github.io","comments":{"utterances":{"repo":"elfinlas/blog_utterances"}},"projects":[{"title":"마와셀(웹) - 와인 가격 비교","description":"와인 가격 비교 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223393940649","github":"","web":"https://appmyc.info","googlePlay":"","appStore":""}},{"title":"마와셀(엡) - 와인과 셀러 관리, 시음노트","description":"보유한 와인의 관리, 시음노트 작성, 보유 와인 셀러의 관리 어플리케이션","techStack":["Dart","Flutter","hive","provider"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223531933037","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.myc","appStore":"https://itunes.apple.com/kr/app/apple-store/6474965246"}},{"title":"흑우집합소(웹) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223059966682","github":"","web":"https://bcow.world/","googlePlay":"","appStore":""}},{"title":"흑우집합소(앱) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Dart","Flutter","drift","provider"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223232966579","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.bcow_world","appStore":"https://itunes.apple.com/kr/app/apple-store/6470312130"}}]}}},"pageContext":{"slug":"/letsencrypt/211105_letscert-fail/","nextSlug":"/letsencrypt/211105_renew-certbot/","prevSlug":"/node-js/211109-vscode-nodemodule/"}},"staticQueryHashes":["1186322783","1321405810","3649515864"]}
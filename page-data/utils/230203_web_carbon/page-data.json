{"componentChunkName":"component---src-templates-post-template-index-tsx","path":"/utils/230203_web_carbon/","result":{"data":{"cur":{"id":"d96c43aa-76c2-5976-9689-4e0a0afd812d","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 662px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQY002PS0/DMBCEc2/jtDY50IY2bzvpA6EITgk4TckBUh5C/P+fMmi3DephpPHs5/XYkVJiPp+zRr9cSiwXEotbifVK4rFSnAWBRLg+5yN/LcocMkopKEUBwQrts4/vk4+fDx+d9fH5ftGbj98vH0/VDbN0b7z/v1AIgclkAtd1WUK4yFKBTSHwcC8QRwKFFshTF6XxoDMPqztxxQtMp1N4nsdLnSRJsNvtkGUZjDHQ2iDPDdKUfAljSiQJzTaI4wxRlCKKEubzPEccxyiKAkEQYDabwTkej+j7Hl3XgXxd1+j7VzRNjWEYOLP2BadhwOFwQNtaWGvRNA3atmWeuKqquLGz3+/5FWpJCsMQZUmtEm48NqGz1pp1/onmZjTbbrfMUcM/Y8CqEMBza1wAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a8d0ea289f057622777bc3907cca8803/7c297/thumbnail.webp 180w,\n/static/a8d0ea289f057622777bc3907cca8803/33ecc/thumbnail.webp 360w,\n/static/a8d0ea289f057622777bc3907cca8803/82a5e/thumbnail.webp 662w\"\n              sizes=\"(max-width: 662px) 100vw, 662px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a8d0ea289f057622777bc3907cca8803/e9ea2/thumbnail.png 180w,\n/static/a8d0ea289f057622777bc3907cca8803/53918/thumbnail.png 360w,\n/static/a8d0ea289f057622777bc3907cca8803/46b67/thumbnail.png 662w\"\n            sizes=\"(max-width: 662px) 100vw, 662px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a8d0ea289f057622777bc3907cca8803/46b67/thumbnail.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"코드를-이쁜-이미지로\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9D%B4%EC%81%9C-%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A1%9C\" aria-label=\"코드를 이쁜 이미지로 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>코드를 이쁜 이미지로…</h1>\n<p>가끔 코딩 유튜브나 블로그에 보면 코드 이미지를 괜찮게 만들어서 올리는 것을 봤다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrklEQVQoz4WS24rcMAyG5w3anVnHsi0fkkwmk8webwqFFkqhff83+oqdnWWWQnvxIUu2xC/Ju98/vrO8zpTjzDidGKaZ8XT+wHCaP5yb395d7dLyLs+v7E7zmZIFLQNuPCO5p9OI1dCsOI/6Hu8TRoTgM6o9NvcYzUjKGGv4vD/ggrI7ziveZUqZiGlAY08nDmMFI47Oypu/xTrrNv8WKxxMh6bCblouqFp8Lkg5It7T+YhLGVFFYsSHiIaeGHtcHrCxKutxGlAtpDjgfCTEXBUuhJCQoBgXNmVXqkK3KbISEBfovNJVW3mPa1MeUq4KV5y3iCZspSoMsfnit3buO/tfDsZsBY/nlb44xnnCjRMhZ8K0EI4z2lflvs2nJb1xLXLbTX3TCo7zwr0xXNZCGkY09xyHlZRGnNfWZm2pzsjXOdUf4Hxr1Vj7d8G6lE6EVJSgW2LQ3GyMGR8SGkrbftRCzgUXYru/FquzrIo1F3bD6YwVQ4wOEcXagHMRI7b9rY39O5/u9u/xu8OV+xavynfffv5ieXhifXxmfXxhubHnh6d/8PzhPF8eef3ylT/ONCZFy/xrTgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8e9d7408175eaabb20155cc809acc9d0/7c297/img01.webp 180w,\n/static/8e9d7408175eaabb20155cc809acc9d0/33ecc/img01.webp 360w,\n/static/8e9d7408175eaabb20155cc809acc9d0/df77d/img01.webp 720w,\n/static/8e9d7408175eaabb20155cc809acc9d0/79c77/img01.webp 925w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8e9d7408175eaabb20155cc809acc9d0/e9ea2/img01.png 180w,\n/static/8e9d7408175eaabb20155cc809acc9d0/53918/img01.png 360w,\n/static/8e9d7408175eaabb20155cc809acc9d0/242a6/img01.png 720w,\n/static/8e9d7408175eaabb20155cc809acc9d0/c6456/img01.png 925w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8e9d7408175eaabb20155cc809acc9d0/242a6/img01.png\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이런 느낌으로 된 이미지였는데 이걸 한땀한땀 올리진 않을거 같아서 찾아봤다.</p>\n<h2 id=\"carbon-now\" style=\"position:relative;\"><a href=\"#carbon-now\" aria-label=\"carbon now permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Carbon now</h2>\n<p><a href=\"https://carbon.now.sh\">Carbon Now</a><br>\n위와 같은 이미지를 만들어주는 사이트다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACLUlEQVQoz32Sy08TURTGu+DhwunMtPPodGY6j86UFnmZFlppohsNiQZcoBAkSBBTiYYYH4mPRDEYEhDwsQDjxmjcufMv/Jl7GxpY6OK7ZybnnO9855HJ5XII6LouraZpqGoWRVGJQo12S2e6qdNsdO1wTee8oqKqqow9nSuQOfk4cdi2TRAEeJ5PmpS4OBEyNhoyciFkdKREJfVxXY9SyadQKJwh6xGKSsKhKAqVSoV2u02r1aLRmKRebzI1dYnJySaNRlPaer3O9HSbWq0mczRN73FkxGNZlqwmUCwWe3AcB9dzcV0Xz/MoFGxM08BxhK9A0XGkFRA+qdA0TarVKmmaUi6X8X1fIkkSwiDAMg0MI4+qKIyNTzBzfZZyHBGnFbywTBglBH5EJR3CtmwyQl0cx1KNQD6fxzAMiZkbcyytdVhYXuPWnbs8fPKCzuYzqd52iuQsB9MsYOQsglIo558Rj2gpm832BmwYJgP9fWwfHvPz9x/e7B/yaucTB99+sf/1hyymaSq5nC4hNi5G0iMUP6dPIG8YnBsc4PXOAUvL6yTpMKW4ypVrs7z/eIxpWWe2K3L/SdhVKAgHebm9y83Fe5TjcZKhES5fnWVr74tc4n8JRcvd9Ws94v7+Pt7ufebdwRELqx0WVzd4vrXLh6PvsgNx/CfxYlyCQxKKamEYdk/EdeXAXc/DMk3m5hfobD5lZX2DlfUH3H/0mNvLq1KNjHO7JyVyoyiSyv8CTNA+BAJUv7QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a183587070c2af0fe2f134de4e575d8b/7c297/img02.webp 180w,\n/static/a183587070c2af0fe2f134de4e575d8b/33ecc/img02.webp 360w,\n/static/a183587070c2af0fe2f134de4e575d8b/df77d/img02.webp 720w,\n/static/a183587070c2af0fe2f134de4e575d8b/8e7f8/img02.webp 1057w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a183587070c2af0fe2f134de4e575d8b/e9ea2/img02.png 180w,\n/static/a183587070c2af0fe2f134de4e575d8b/53918/img02.png 360w,\n/static/a183587070c2af0fe2f134de4e575d8b/242a6/img02.png 720w,\n/static/a183587070c2af0fe2f134de4e575d8b/c3ac1/img02.png 1057w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a183587070c2af0fe2f134de4e575d8b/242a6/img02.png\"\n            alt=\"img02\"\n            title=\"img02\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>코드를 입력하면 언어에 맞춰서 잘 꾸며준다.<br>\n보여주는 창의 테마도 상단에서 바꿀 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 691px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACHklEQVQoz5WS20uTYRjA33QnE78dvrnp1vbNcHOb7uAUInFzUxTSoosgNzoYakRdpASVnexKusgsMFwimumSnBqUIFp3sW6D/qJffJ8jvFhgF7/3eU/Pj+d9eUQkEkGlra2tIupZNBYjGo0SjcYOKa/bEwmSqR4tqnfj8TgiHA7j8Xjw+/0oioLVatWw2Wy43W6CwSA2qwWrxYxeV41Br8Og11MlBMFQiJnXeTo6O/F6vSSTSURDQwMqLpeLxsZGnE7nXxwOB15F4VLuGldHb5EbGSN3Y5zcyDjZ62Pa3sTDZ/SfO49dljWpsFgsHOVohVJdHV7Fx+rOPl9//GJjv8TmXomtgxJb30oUD0rs/fzN/ekZjAa9liPUoRKyLGM2S3i8Cosbn3nyYp6eVIb2CwP4En34Ehli6Yssb+8x+eg5JqMBu93+b6GKWSoLP+4wOvmUaknhpKeVE/YQwtqMydXKm5XN/xQqPhbWiozcfYzJGcPlTyM3d2HztWM53cHsYoGJqWlNKB+3wvxakSt3HiB0DoTUhKhTEDVuquoDvHy3fjzh4R+aUXxN5AvbTM/m6R7KkhwapnvwMt2Dwwxmb7K0uas9ucZkxF5fj5AkiUqostraWtynPMwtFVgu7jK/ssGr/HtmF1aYW/zA29VPrH/5zu17U+h1Oq1LREtLC5VQG1qNauOn0r2k+/q1mMqUKc97+wc4c7aLQCCg5fwBNmFmARRjoA4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/791a0531ee80160b6f5ef9f13834c87e/7c297/img03.webp 180w,\n/static/791a0531ee80160b6f5ef9f13834c87e/33ecc/img03.webp 360w,\n/static/791a0531ee80160b6f5ef9f13834c87e/366f1/img03.webp 691w\"\n              sizes=\"(max-width: 691px) 100vw, 691px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/791a0531ee80160b6f5ef9f13834c87e/e9ea2/img03.png 180w,\n/static/791a0531ee80160b6f5ef9f13834c87e/53918/img03.png 360w,\n/static/791a0531ee80160b6f5ef9f13834c87e/2928f/img03.png 691w\"\n            sizes=\"(max-width: 691px) 100vw, 691px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/791a0531ee80160b6f5ef9f13834c87e/2928f/img03.png\"\n            alt=\"img03\"\n            title=\"img03\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>코드의 배경색도 변경이 가능하며…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 326px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF9klEQVQ4y2WV20+b9xnHTc4cjLFfn/369L4YfHx9BBtjDrYxwRBMQjglKSSM0JKENmmTBmI2ciBp2nRk0pIipGbNst1MS5uMrFLUaV13t3VIu5gm9Y9Yxy52s6t9Jpx0Ku3FVz/9pJ8+ep7v8/yeRyUIegyCls6DQ7QuPid37Xe0dhfxNXuIRKLIsowkSZXT3exHbzRjEt3oTRYMFhHBbMUh+dELekxGCyrR7sRht9HVP0J48XMyV/9IS1eRTDpFJtOBy+UiFouRSCRwenwIZhFRacfijaO3OjE4ZFyeCEa9EcnhRWXWazELGpo8HvqOz3N4+k2CShS7KNLU1EwgEMDn8+H3+/EFw9hdMnanC5ckI3sDWBxujBY7FpPtRYTu0gKOUpmW0Uv4PW68HqkSUTqdxuvzIcuNZHM5+or99PcPMDY2zujYeOU+MHCItlSKutpatDotDdoGVIFLn+G7/AWFpScY9AI1tbW4XU5CwW1ftGjUNUTDAdLJOJ3trRwdGmBipERnW4x8Z5r2TAa1Wo0gCOh0OlS+c4/xnf8tmTcecnrmB9y4dYc3F65y9q1lzlxcYebCCifPv8Px+dscee0WB0/doOuV67RN3iE2fKnibX19PTrdS6Bj+CauiVWaSpd48OBnfP3v//KXr/7BF3/7F0/+tMVHf9hi9dMtfvh4i3OP/smx9S0Kq18Teu8/CDPPCfh9NDQ0VGAVYJUgoxIaEVwh3rvzPl/+9Ss+fv5nfvFskw8eb/LuLzcpf7jJ/L1NJt/fZOjmJl1LX+Jf+DvGYw8JhQJovg3cZWimyuDF2BjjypUyTz/9PWs/f8rqhxvcuP+My6vPOHN7g6lrG5QWNxhcfEbH+Q1cs58hDP74+8DdL4Hmpjhzc2e4t/6Qq7fvs7CyxuvLa8wsrjHx1hql+TXyr66RPLVG4NgH2EYfoMktEgoF0Wi+Bax3RTkgKliaE4yPj7OwdJ3X3lhk+lyZiVfLHJ4uc/CVMp3jZVqGywQGy7gPXkHouYq6dQblu8A9Jh9VhmZEf5JCocCJqRmGRiYpDk+RL02R6Z+ipXcKJTdFc+cUzvQUptZJ6uLT1PhLKKEQGo1mp4cqwYMjmCYej9PZ3UNruptYKkuoJYs3lkWOZHGEslj8WYTmLOrGLHvdeaodKRTlO8DdRi8qoQl3+MW/dbplRIeMxS5jtMkIFokGk4TaKFGtl9ink9jTIKGql9mvlVAUZSewSiej0riQwu3U1dWiUqnYtXs3Vbu+0Z4XqnqhXRXtrbw7sG/f94EHpHYOyB3Y2oZYCtj5fNnFR79xMvLEiemTE1h+/YjY2x9jc3zCaeEpjwzrrGnSRPsv4DyyjBLw7Wwb8fA1nBM/IXziJnPTJ7n307ss37rOxZUVZpZucPztWxw5u0LhxDL50R/ROnCZdHGWpuI8Yn4OJejfCXRP3MU9tU7q9F2i0Qi5ngK5bJ6oEiGdTJJJJYlHFLLd7cSiIXp7s7S2JujpztCRShAOR3am3DjzkMa5X5E6u048rFDs66Ovr5dYLEKqLUkmkyEcCZPryRMKhSj0FIhHE3R1Zkkm0wRDwcpw0Gq1lT+tsvuTWLwttOUOUW8zY5UbkZvD1NQZaNDasLsldFojTqsHo2BBkmQ0VjVmp4BNMpKIJzAYDJjN5opUme0oUi30HipyVG+nz2HheEFkeMDG0SErSdlBIi2SGhVxR7UEvY2U9MdImY/QZhmjUMxWVsV2JttSVVfXcGD/flyhALPVRiYsOi6OmJiZ0DN7Sk9WFmnLmcidM2OP70XxyUxWz9OtnSWvfx1PwEldrbqS9rZUsViUQDBI2CfjGipjK57EcuE0uckc/Se7Kv2mF8xIopf+3kEODZZ49/47CNZ69qtVRMLRinf/n9jbqzIQCKOEAqS6S8Q78rSUesn2tZMvpvHIjYTDComWOJ1dHXR3dTE2MkY4FEEJhYlGoy8n9ssqm4xq3E41er0Bq9mA1WTEajBi2t6/RjN2ux2bzYbVaq2YbjKZKtFs30VRrBRku8LfAP8HFDdKmDA4RDAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/254cdc475023a6e8699ea0d2ce58ac58/7c297/img04.webp 180w,\n/static/254cdc475023a6e8699ea0d2ce58ac58/10585/img04.webp 326w\"\n              sizes=\"(max-width: 326px) 100vw, 326px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/254cdc475023a6e8699ea0d2ce58ac58/e9ea2/img04.png 180w,\n/static/254cdc475023a6e8699ea0d2ce58ac58/15a61/img04.png 326w\"\n            sizes=\"(max-width: 326px) 100vw, 326px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/254cdc475023a6e8699ea0d2ce58ac58/15a61/img04.png\"\n            alt=\"img04\"\n            title=\"img04\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVQoz32Sz2sTQRTHg1Jt2mR/zKbRzW52Zja7O5uNWAj1VEUI6EENIg3YYHvLXyBeeuqhHhVR6Vnaf/QjM9ESRTx8+fLmvfeZN8NrZVlGnudorZFSYmPrNlYuHq41TFF5gR6VaK2QSiOVQkrl6i2j3+/TGo/HTCYTjDEopUiSxHnTNJSVIZOKoVSkg5hmdszD2YIHdUluGmJVIq3SnLpqSJKUlqWHYUgQBM5DIQi8Dr3MUJ5+Jz+9ZHTyjeLkK2b1A/XyA36nTSiimx7P8xgMBsRxTMtOI4TYUETg7XJvtE+xuiZ/ukQ8ekXbPOf+izOK5SeCzl1EFN30WLB92R9Ae9PfQPn2M0JOCYb7bEcKb3pEvrgg6Gz/HxhtJG1h+Auol1/YSqfc3qu5FSr8g2NGiwvCbhsR9f4NtH9oD3zfXysI8Xbb9NSEYnVFPD9n79l7J/nuEn30EW/njquz9ba32+06mAP+Xhk76Vp2XTJ0WWMO55jHr9d+OKd+8obyYObyaqPHDlVVlQP+BGLP4PZ2mcxLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a6cdac9355dec29e7571c9f648c1b15b/7c297/img05.webp 180w,\n/static/a6cdac9355dec29e7571c9f648c1b15b/33ecc/img05.webp 360w,\n/static/a6cdac9355dec29e7571c9f648c1b15b/df77d/img05.webp 720w,\n/static/a6cdac9355dec29e7571c9f648c1b15b/a42ef/img05.webp 1025w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a6cdac9355dec29e7571c9f648c1b15b/e9ea2/img05.png 180w,\n/static/a6cdac9355dec29e7571c9f648c1b15b/53918/img05.png 360w,\n/static/a6cdac9355dec29e7571c9f648c1b15b/242a6/img05.png 720w,\n/static/a6cdac9355dec29e7571c9f648c1b15b/cf562/img05.png 1025w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a6cdac9355dec29e7571c9f648c1b15b/242a6/img05.png\"\n            alt=\"img05\"\n            title=\"img05\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>에디터 표시 설정 및 라인 높이 줄번호 폰트 등의 설정, 그리고 미리 설정된 테마 기능도 지원한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC30lEQVQoz1WS/U8TZxzA+zMzveOu99bry/WuBWxLKSg4XmrbrNYWphDA/TKnsGCMhIEZqIytY2xOYyBu0ZllZhNNJr5AFpO5+faDiYv+Wx/zXNFkP3zy3D25fJ7PN/cERsYm8RmdYHgX8Vw7MsaJmVk+nT5FrjOLHbYI22FsU8U2WolYBpLs0dKSIJXM4XkuwWCQwM7z12y/eMO9f1/xQPC0yf0nr9h58Zobtx8wv7RC49IGJ08vkJ9cpXf6N/rGZ7l+xeDhpsnMVCem5SHLQQJ/Pn7JwsI5RmoHGRiucGCgxIeFJn2DBzlxapZjx6eoj04y/Mk0A599T/5Yg+LxOc5+4fL5VITD1SzRqIskBQncefScWv0omtKCHtFQFBlZVZE1gw/27KFUOczyd5dYXrvMmfNr1M5tcWj5b8YW17m3meGvrb3MTHdjWi6tovDW9j9URkZRNY3OjEdn1iWSbCPVniYctikfqnH12i/cvHWH9avXWFnfZPXGI1Y3fmVna4GXzy4wPzeBaUZpbZUI/LH9mMrwUZSQRtyJ+mhhm5hloSiqX1iv1+jdv48Dfb0kohaWJhE2NIJSGEV1yOf78NzdnyIKP6ofQdV1NMNCCemEdAPVMJEVlUK5wlChQDKVoqenByfhYpoWpmXhJuI4Tox8vgvP85pCUVj9eIygLKObli8TaL5QoVIbYXx8glKpRLFYpL29nY6ODgzDIJfL0d/fT7VaJZFIIEkSgYfP/uPn3+9yYe0KS9/+yGLjHRf55vJP/LBxnVKxyNDQEIVCgba2NjKZDLZtEwqF/AOEMBaLNYVLjYt8+fUa8+cbzC2t/I+zX60yt7jsi0TJ4OAgqVTKF7qu61cKaTabJZlMNkeORGzi8RjxWAxHrLs48TgR2yaTTlMul98XCllXVxfpdNqvEqN2d3djWRayLBNQFMW3O04C1/X8DwTNPccfSdd1v0asougd4l2ginsrywjXWwANprHJpOgAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/44a50850a4181a4d9d248878b6515374/7c297/img06.webp 180w,\n/static/44a50850a4181a4d9d248878b6515374/33ecc/img06.webp 360w,\n/static/44a50850a4181a4d9d248878b6515374/df77d/img06.webp 720w,\n/static/44a50850a4181a4d9d248878b6515374/0692d/img06.webp 728w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/44a50850a4181a4d9d248878b6515374/e9ea2/img06.png 180w,\n/static/44a50850a4181a4d9d248878b6515374/53918/img06.png 360w,\n/static/44a50850a4181a4d9d248878b6515374/242a6/img06.png 720w,\n/static/44a50850a4181a4d9d248878b6515374/0b3a5/img06.png 728w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/44a50850a4181a4d9d248878b6515374/242a6/img06.png\"\n            alt=\"img06\"\n            title=\"img06\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 331px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZklEQVQ4y32TW0ybZRjHPy/tIdDTGLC26/fRghw+EMpoCy2MKaxh62Q4OXQDw8WCG8qM6ES6AwSQQcRtHYU5mBBgCxlZPM7MGecOdT1MvUDvnPHCS+LilYle/Mz3TW807uKX/5sn7/t//k/yPsKB7oN4PFVUVropLCwkLy+P/Px8XE4nkuhAdPwXx7+QJBFRdODxeBBmFlex20VcrmJEqQCT2UJObi5myyZ0Oj0ajRaNVotOp0On16LVa9D9zaOzFn1mJnqDgfKKCoRT0XmWz+fw4/1skjdMHO7eRmzsOHOTg8xNRrgwEWHxzAk6m/fR4Z6id/sSPYH36Qlc5OXtlwiVDzC71UHKLrK3yoPw9pn3+PIjGzy0s/Egi+GjdXyyMMvnl6JcXznHZ0tRvlqb4ciLBzlUs8qJplsMBr9gMHiDoV1x9vtOc11y8rurkHaPF2FsapqtUh5ZVicen5X+wz5aW1rZ3bSTUFOQpuBOWvY20flcmKdyd5BrLMZmlNlilLGZZWRTDddeHeDXn36mbd8LCEPj72LenMcTT4oUFG+hv9dH854Wnnl2B/X19QRqa2lorOfAnjCunBo2GyUsOgcWjR2DxkphRiXXIqNsPPyN1tY2hDdPnmJtMYdfvt/ED/cyGXjFw8LUOMvRYVaiIyyfHWHtwjg9bZ10Vpynr+4Kh2pWeKl6mb7aqzSXnmRVcvJAfprnvV6E1wZHSN8sB3z8uVHO6bFW7nxwmcSnS9y6epGba3N8/fECb/Ue4ejuD5kMJ3mnM8lUV4po9zp9zQvcrq7hD6+fsD+A0PdGhNj0WdbXvyOZjJNI3COVShGP32V+fp5YLMbszIyq0+dizMRmuXP7LvfT35BKpkkmUnybTpOIx9kfDiMcG53A7w/gdm+jqsqLz+fD4/Xi9/spKipSP3tJSckjZEWLkeUS5FJZ1dJSmWJZxlVQQGNjI8Lx0UnCHR10dXXR3t5GXV0tDQ0NhEIhysrKkGUZk8mExWLBbP4Hs4pSMxgM6h232021rxrh2MgEtYGAmkxJpayP1+slGAwiSRKiKGK32/8Xm82G0+lUVzYQCCD0Dw6pSZQOWVlZZGRkqKp0Veoul0tNoaR8HMpqKh7C65FhtUt2drY6hvJYUcXQarWq5krtcRiNRvR6vWr4FzA3GkXF45YVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5f6959dfe49f9b28d9bbc7b53ccd91d8/7c297/img07.webp 180w,\n/static/5f6959dfe49f9b28d9bbc7b53ccd91d8/c28f2/img07.webp 331w\"\n              sizes=\"(max-width: 331px) 100vw, 331px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5f6959dfe49f9b28d9bbc7b53ccd91d8/e9ea2/img07.png 180w,\n/static/5f6959dfe49f9b28d9bbc7b53ccd91d8/2ba93/img07.png 331w\"\n            sizes=\"(max-width: 331px) 100vw, 331px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5f6959dfe49f9b28d9bbc7b53ccd91d8/2ba93/img07.png\"\n            alt=\"img07\"\n            title=\"img07\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>그리고 내보내기는 단순 이미지 뿐만 아니라 iframe 링크, 이미지 자체 링크 등으로 제공이 가능하다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 160px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 159.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAgCAYAAAASYli2AAAACXBIWXMAAAsTAAALEwEAmpwYAAAE2UlEQVRIx61WTU8bVxSdqhIpNmA8xthgwI6/x994PMYfGBC4ARsbIlokShYJID6jiCipmtBEURckbZVE6S7ZtMtKkdpU3VRVmzTdZFFV6l861blkHCdBRJW6OLp33ozuO+/cc5+t9Pb24v+EsrW1BcH29usw1/8jFLfbDVe/E061F07HS6i9cLtd4Lv+/v7XwLXj1uWdywVlwO3CkC8IzZhCJDsu0HKTcHtG4PEMIhgKIRgMCkKhEAYGBuDxeOQ5EAi0YiDgh3vIByU/mkB59Roqd/5G6dYzFG4+RfXuPygvriMdj+K0PwCXyyUMYrEYdF1HJpOB3+/HyMgIhoeHMTQ0hNHRUWQqs1D0lAZj+VNErv6GyKUnCO79gMzBHygubCAS8MFiseL8+fNoNBqw2WxSLB6Po6OjAxMTE1hZWZFmDHu9SBamjgrml68i8dlTJPZ/gnbpCYybz1FcWEM06IPq6MPjx4/x4MEDqKoqTJLJJDo7O7G2tiYIh0IY8fqQKk5DMTIxjK1+Du3gBbQrvyJ8+Rdkv/gL40s7iIX9sFi7RDOHwyHIZrNS0GKxIJFIoFKpwGq1wnfaj1RpBkoyHkVyehljuw+RW78Pfe0eyhcfITZWRThwGqFwBF6vV0ANI5EIwuGw6GbC5/OJFFquAsXWbUE46IeRiUNPx5BLH0UtEkYikUQ+n4dhGK3IomR4eHiI6elpaRLfeb0j6LXboRgzZ/HRx8solMoolSsolsoCCl4ul1EsFiUWCgUBcx5zdXUVk5OTslar1TA3Nye6Kmfvv0Amm8N7iiI2IHgM6kVLDA4Owul0tvzWvkbrsAi9yaLUVWl+9SeMsSI+OHVKqNMe7Bx3JJMzZ84Ii3PnzmFjYwPNZhMXLlzA0tISFhcXpfPUkN+/LPgcuXwBFksnVNUBu90uu9PM7UPPdbKmF/nMSPT09EjDWgUbd56hsXAWkXAY6XQaqVRKRCfYOa6ZsT1nJGgd6k22omHj8Hfk8mNQVTsGBz0tdoxkxSOdhLcYNu88w6huIJ1KYa5WEyvMz89D0zQxLIuedP91dXVJo1oFZ658J3ZxOFR5wc7RuOwcu2lGM28H13hp0Oz1ev2oYKxUR61WF0tw6MksGo1KTlCj9rwd1Jnfl0qlVxrGy3VkMqNC3+Vyo6+vTy5Q6sOucp2RmrKr3d3dopsJsuKsz87OHjGMl+eR1XXZhR6j+6vVqoBd5GhR1/HxcfEbi57YFDLMGXlhwp2oixmpT3tO8AQmTCdQ99akxMp1zDcaCIWCLV3M2O5J5oTpRxPUlhPVpuG8aNjvdAobMuXux9nFnA4Tx9rG1JBaUb+pqSmxAHM24yRTm6P42ixTQxa0WizCjP6iNuw0Wb4L7DpvqFbBVxqGRCPqZ2rH/E3N2nHsLJOhrueEGe9B80ec88zuka15vOPw1pE5KVk9h0KhiEZzATPVD6HFYsjnx7DyySrS6UzLe28et92HLWOnJpowcjo63lfQ77DDqdqg9ljRZ++BvceCPtX2Tg1ZkBezFByIlbB9+Tp2rt3GzvUvsXvwNfZu3MXejXu4eOsb7F67jc3NzZfYass35c8Rb/H9/X252UVDxeZDl1ZFdO0RtM1vkdj7Hqn9H5G+8jOyB8+RWH+IAbf7rZvmTdCTlOBfEojOXSaU0toAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7d3d8e82dcb35c62436fc39aef509d43/748b5/img08.webp 160w\"\n              sizes=\"(max-width: 160px) 100vw, 160px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7d3d8e82dcb35c62436fc39aef509d43/065de/img08.png 160w\"\n            sizes=\"(max-width: 160px) 100vw, 160px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7d3d8e82dcb35c62436fc39aef509d43/065de/img08.png\"\n            alt=\"img08\"\n            title=\"img08\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>아래는 <strong>iframe</strong>으로 가져온건데 코드를 복사하거나 할 수 있다.</p>\n<iframe\n  src=\"https://carbon.now.sh/embed?bg=rgba%2528171%252C+184%252C+195%252C+1%2529&t=seti&wt=none&l=auto&width=680&ds=true&dsyoff=20px&dsblur=68px&wc=true&wa=true&pv=56px&ph=56px&ln=true&fl=1&fm=Hack&fs=18px&lh=184%2525&si=false&es=2x&wm=false\"\n  style=\"width: 1024px; height: 483px; border:0; transform: scale(1); overflow:hidden;\"\n  sandbox=\"allow-scripts allow-same-origin\">\n</iframe>\n<p>그리고 export를 선택하면 이미지 확대 및 파일명, 확장자 등을 선택할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 361px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACOElEQVQoz22RyYrUUBiFeylaVUklleFmvJXhZqwhna4eEEQQfAQRFITGnSuRxoVPJgi+gODGjeJa8RHUxSdJa0N1uzj8l/ycj3P+HCilGFQUBWXTUpQVRVFS1i1ls6KqW5q6pSpryqIcZ1uvqMqGo37HyckJk8kE0zQxDIODmaYxnU6ZaTpzJ8AMEqy4YG4JDH+JCHNM3cRzIqSvEHaIMV8QipREKg4Pu9F/BRzouq6xsGycYImXNQRVjxNIHKmIkhrHcslkzUrtWIY5ri1IohKVVfR9v5+wbVtqtSWNK/JsQyob8mVLkXUUqqfMOurskDLdUCQrimSYa043D9k0x3SH2/2E37/94OnjcwzdJo1LsrjGWtho2mxMPkj7O3Vdx7ZcHFtgmQ7rur9Z+dfP3zx/9gJ9ZpLExQj13HA0uba3p+Gb5wbjPhCS7f8Sfvn8lSePzgndjExWmObiCjbMf3IdH19E4+1CTxKIJZtmdxO4252xbU6JvAQZ5gjnMoFwg9E4QIa363jjLvITAi8m9nP69V267hrQXLikcc1Mm47pBhmGyXw+xxcxi4U13nS47fCnBw071/Y57e6z7Tb7QM+PSGXFnckthOPTqt1YcTK9PdYezINiPyX0lsggR9NnWAuH4+29m0CpGlp1RCDisc5guqwlUcvVeIbIT0miAhlkI1A4IdIvOOsfsO3W+0ARRMRRThypa8pZxgUyvnzLOMcTktcXb3j39j0fP3zi1csLlMrRNO0K+AfnxFFoxkwpGwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2e94d59ee5e68b0c19fdafd14f232d9c/7c297/img09.webp 180w,\n/static/2e94d59ee5e68b0c19fdafd14f232d9c/33ecc/img09.webp 360w,\n/static/2e94d59ee5e68b0c19fdafd14f232d9c/b6ca0/img09.webp 361w\"\n              sizes=\"(max-width: 361px) 100vw, 361px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2e94d59ee5e68b0c19fdafd14f232d9c/e9ea2/img09.png 180w,\n/static/2e94d59ee5e68b0c19fdafd14f232d9c/53918/img09.png 360w,\n/static/2e94d59ee5e68b0c19fdafd14f232d9c/88969/img09.png 361w\"\n            sizes=\"(max-width: 361px) 100vw, 361px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2e94d59ee5e68b0c19fdafd14f232d9c/88969/img09.png\"\n            alt=\"img09\"\n            title=\"img09\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>잘 쓰면 유용할 것 같다.<br>\n근데 유튜브 같은데는 괜찮을지 모르겠지만…<br>\n블로그 같은데는 복붙 해야 하는 경우가 좀 있는데 이미지일 경우 또 이미지 내 텍스트 따서 긁으려면 좀 답답할 때가 있다.</p>\n<p>그래서 블로그는 그냥 코드를 올리던지 둘다 하던지 개인의 선택으로 쓰면 될 것 같다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#carbon-now\">Carbon now</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></li>\n</ul>\n</div>","excerpt":"코드를 이쁜 이미지로… 가끔 코딩 유튜브나 블로그에 보면 코드 이미지를 괜찮게 만들어서 올리는 것을 봤다.  이런 느낌으로 된 이미지였는데 이걸 한땀한땀 올리진 않을거 같아서 찾아봤다. Carbon now Carbon Now 위와 같은 이미지를 만들어주는 사이트다.  코드를 입력하면 언어에 맞춰서 잘 꾸며준다. 보여주는 창의 테마도 상단에서 바꿀 수 있다.  코드의 배경색도 변경이 가능하며… \n 에디터 표시 설정 및 라인 높이 줄번호 폰트 등의 설정, 그리고 미리 설정된 테마 기능도 지원한다. \n 그리고 내보내기는 단순 이미지 뿐만 아니라 iframe 링크, 이미지 자체 링크 등으로 제공이 가능하다.  아래는 iframe으로 가져온건데 코드를 복사하거나 할 수 있다. 그리고 export를 선택하면 이미지 확대 및 파일명, 확장자 등을 선택할 수 있다.  정리 잘 쓰면 유용할 것 같다. 근데 유튜브 같은데는 괜찮을지 모르겠지만… 블로그 같은데는 복붙 해야 하는 경우가 좀 있는데 이미…","frontmatter":{"date":"2023.02.03","title":"(Web) 코드를 예쁜 이미지로 변환해주는 Carbon now","categories":"utils","emoji":"📜"},"fields":{"slug":"/utils/230203_web_carbon/"}},"next":{"id":"25661be2-fac1-5849-97cf-c686c89cf9c5","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQoz5VSTUsCURT1X7TqY9O+VbRQIdpWizZCqxb1A4JWBS3cFAgtIspNiyCCoEVBRWJJQhqWFbop6GNg+nJSEccZ5+PNeyfm6ehIRnbgvHfhvXvu4d7rAQBGKacbjDFOd/wXbXicwIEliND2I+2F7cKu2Hl3//VwkVwe8nwIBV8AheFJFPwBkCeh1bFFWxL5TazarVTBTFJzaB/y4gqkXh+kHi9y3V4Ux2c47UK0okDd3IW2dwwzcw8jcQ395BzGVQba4RnIo4DK8gas14+mIJUrYFUNRjyFr4FRSP0jyHUNwkikQWUFcnAV+mmCF5YXQjBvstAjcZRng1y0srQOWizVe2jVbBupO6jhbZSm5iD1+ZEfmgARRDC1Cu0oBjOdhXF5C+0gCj2W5I5sUfLwDD16Aevtsy5Ia/0gLyLU8A6UtS0Ux6ZhJNMtze8EjaG4J2WJ76Bluf26UNaYtGPEWbkfa8M/EdKs5iT+gw3BX3eNtbrvBN9Ty+sRGu0ozQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7685b7a900370c34be4e657df3f862d/7c297/thumbnail_nestjs.webp 180w,\n/static/b7685b7a900370c34be4e657df3f862d/33ecc/thumbnail_nestjs.webp 360w,\n/static/b7685b7a900370c34be4e657df3f862d/84c6d/thumbnail_nestjs.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7685b7a900370c34be4e657df3f862d/e9ea2/thumbnail_nestjs.png 180w,\n/static/b7685b7a900370c34be4e657df3f862d/53918/thumbnail_nestjs.png 360w,\n/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"저번-포스팅에-이어\" style=\"position:relative;\"><a href=\"#%EC%A0%80%EB%B2%88-%ED%8F%AC%EC%8A%A4%ED%8C%85%EC%97%90-%EC%9D%B4%EC%96%B4\" aria-label=\"저번 포스팅에 이어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>저번 포스팅에 이어…</h1>\n<p>저번 포스팅(<a href=\"https://elfinlas.github.io/cloud-flare/230127_use_r2/\">CloudFlare R2 사용해보기 Part 1</a>)에 이어 이번에는 R2에 파일 업로드와 다운로드, 삭제 등을 <strong>Nest.Js</strong>로 구현하는 것을 해보려 한다.<br>\n일단 프로젝트를 따로 파서 깃허브에 올려서 하려 했으나…</p>\n<p>생각해보니 각 설정들 부터 해서 <strong>Wrangler</strong>의 설정 및 배포 등 생각할 것과 직접 구현해야 할 부분이 많아지는 관계로…<br>\n일단 코드 조각으로 예시를 만들어보려 한다.</p>\n<p>그렇다고 생략을 엄청 하는 것은 아니고, 환경이 구성되어 있다면 해당 코드 예제가 도움될 것이라 생각이 든다.</p>\n<p>설명에 앞서 구성, 그리고 기타 사항은 다음과 같이 되어 있다.</p>\n<ul>\n<li>Nest.JS 사용</li>\n<li>Typescript 사용</li>\n<li><a href=\"https://elfinlas.github.io/cloud-flare/230127_use_r2/\">CloudFlare R2 사용해보기 Part 1</a> 포스팅까지 진행 완료된 CloudFlare 계정</li>\n<li><strong>Wrangler</strong> 프로젝트가 현재 진행하는(또는 따로 만든) 곳 내부에 존재하는 것을 예시로 진행</li>\n<li>먼저 <strong>files</strong>라는 도메인에서 진행한다. (아래 사진은 참고용)</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 261px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 133.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAADS0lEQVRIx5VVXW/iVhD1H6jUp7Zqm2DA2Bh/Xdv4G9uADSYmJVllV90oD63Uh0qV2qf9/6eaMdDsLh/pw9HF2PfcmXNm5koDzYIysuFuEzirGJM0Rm+k40ZWISsT9EfGVdB3quOCuKS+aqKvTKC7PtLVBnaYwpmmENMMQ81Cb6jzhmvoq0RuQlLGDka6A8MOUax2CJIFZos7FMsWujXlU4dj+zy0/1bikgyRwPZnMN0U9fY9moePaLZP+OXdM3ZPLxBBAcNNYXkZTPc86L0h0i5CgjYRENkK0fwO8axCWjYYmz4GqtVFcRWUibPXcDSBPDJR5DEW1QJhViPKllDG9ps1lBWdDZJYI9XA7cjFr2sDL48J/KyB5Ub4WVYx4AONN4GykQ629xUd0bxFUDSw3Rj58g7TuMRNX+Uoe8PxBXTviUcyRMymEKr2qTPm/j3KegcvXrBZppd26yWwKQkke1rAT2pMkwrLllx+xstvf6LavIPl5/CTCl68hBstLoK+cYIS0sEhMsAUIZrHj7D9FPmyhRvMWEdKhbS8BuKRDqLTg+EEKJsHiCBjl6l8/Kjg/9/iNncKOUOEChGKEKvdBzh+ijBdIilWCFLSMWLCa/1MwR0Jh3vC+v4Jjp8gLdcc4e1gjJu+dtx0bmCcJnRCLO6fYXsJsrJBmC6OBX5t8pwgtGEJD7tdyaZk84bJqBbpw/9FOKAq1wSEMPDpDxt+PGeHk7xmPSntUx3z+pCvIlTHFhQnwQ/tPzwLSUMy46feiAlvB9p+7XAge71+RkguD3QBOWm5VLJyDS/MYbkxD1wyyhQRP9P6pQwnNDTR12z8GGzghjk7TPp1o2zNoDKKZhUf9KVRnxOqJhTVQM8I8M3jJ7hRgWRWc6RBMmeSdB8xldDVlDtTLGiqiQd1DC/IEGZdJERI5UPRqhNxojvOuEwpK5qDIFhxZEm+YpJw34L0WzPc491B99BrHU+mLE+m+Hb7N9yw6Po4LjGbb7j9qC5Jw3yxQVlt2TS6Ig4t+RUhTW1Z9/B9/Tv8qESc13wDpsWaa5I2knbdMNWPw+KiKfLEx3ftXzBExLqR26SjFxXQLR+a4Z0t7osREtGMW6/iVIuq5RQp4nNteCD8F9y6PcvqoD05AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/63f833163615a6da2efd925b95c803eb/7c297/img01.webp 180w,\n/static/63f833163615a6da2efd925b95c803eb/3f80a/img01.webp 261w\"\n              sizes=\"(max-width: 261px) 100vw, 261px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/63f833163615a6da2efd925b95c803eb/e9ea2/img01.png 180w,\n/static/63f833163615a6da2efd925b95c803eb/51582/img01.png 261w\"\n            sizes=\"(max-width: 261px) 100vw, 261px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/63f833163615a6da2efd925b95c803eb/51582/img01.png\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<ul>\n<li><strong>레이어드 아키텍처</strong> 기반으로 코드가 구성되어 있다. (원래 <strong>포트 앤 어뎁터</strong>로 하려 했는데 아직 배우는 단계라…)</li>\n</ul>\n<br>\n<h2 id=\"1-worker-처리기-배포\" style=\"position:relative;\"><a href=\"#1-worker-%EC%B2%98%EB%A6%AC%EA%B8%B0-%EB%B0%B0%ED%8F%AC\" aria-label=\"1 worker 처리기 배포 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Worker 처리기 배포</h2>\n<p><a href=\"https://elfinlas.github.io/cloud-flare/230127_use_r2/\">CloudFlare R2 사용해보기 Part 1</a> 까지 한 뒤에 작성했던 <strong>index.ts</strong>에 대해서 CloudFlare에 배포를 해줘야 한다.<br>\n이 부분은 자주 쓸 수 있기에 <strong>package.json</strong>의 <strong>scripts</strong>에 등록을 해두고 쓰자.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"scripts\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        ...\n        <span class=\"token property\">\"r2:build:dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"wrangler publish -c ./my_worker/wrangler.toml\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 <strong>my_worker</strong>의 경우 서비스 생성할 때 이름을 적어주면 된다.<br>\n각자 프로젝트 디렉토리에 보면 자신이 정한 디렉토리명이 있는데 이를 넣어주면 된다.<br>\n그리고 실행 명령어도 입맛에 바꿔도 된다.</p>\n<p>이렇게 하고 아래 명령어처럼 배포를 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> yarn r2:build:dev</code></pre></div>\n<br>\n<p>그럼 콘솔에 배포가 잘 되고, CloudFlare 사이트의 Workers에서 등록한 서비스를 들어가서 배포 항목을 보면 확인이 가능하다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVklEQVQoz22STU7DMBCF3V1vwg3Y9EaIJWyR4AbcoYfgECCxqkS3XbQhapvEiT3j+UMT0qhIWBo9OW/8ZZ6TQESGiEZULCa0pt4bDL0Rs10tvdL/avbC8Xi0PkbLKVvsB+v6ZF2MFmO0lJINw3ApdW2aZty7d/FTStq2rXmFuvq2w7m2JkdjIvOJc052Op0MAKyU4iWTfm02m9XhcLht23ZVVdVNzvmVma3rOooxasg5WyYw5DLnE1VvGIFjFtVL/o/1eh3qug673S4AQDCzezeIqBCRBo/A9NsvIn54nPJ8Po9A34sIu6rqZ9d1y+12uyilLM0siMiDeznnAgAafBIHTAdH9Qj+ov+AIrIEgIWrqs5AACiIqMEv1QHTgRnoH8Xv7RJ58t49JhEFRHRYUNU770HEUkr5C7ye0IH+O03PfbnumfmFmZ+Y+ZmZH0XkzXsQkR34A50rV+t6PMZNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f6641b9ce995167297d289d8977bffc1/7c297/img02.webp 180w,\n/static/f6641b9ce995167297d289d8977bffc1/33ecc/img02.webp 360w,\n/static/f6641b9ce995167297d289d8977bffc1/df77d/img02.webp 720w,\n/static/f6641b9ce995167297d289d8977bffc1/5ce83/img02.webp 1032w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f6641b9ce995167297d289d8977bffc1/e9ea2/img02.png 180w,\n/static/f6641b9ce995167297d289d8977bffc1/53918/img02.png 360w,\n/static/f6641b9ce995167297d289d8977bffc1/242a6/img02.png 720w,\n/static/f6641b9ce995167297d289d8977bffc1/92844/img02.png 1032w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f6641b9ce995167297d289d8977bffc1/242a6/img02.png\"\n            alt=\"img02\"\n            title=\"img02\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<h2 id=\"2-프로젝트-구성\" style=\"position:relative;\"><a href=\"#2-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B5%AC%EC%84%B1\" aria-label=\"2 프로젝트 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 프로젝트 구성</h2>\n<p>먼저 <strong>Nest.JS</strong>환경이 구성되어 있어야 한다.(아마 진행자라면 다들 구성되어 있을 것이다.)<br>\n위에서 설명한 것과 같이 <strong>레이어드 아키텍쳐</strong> 기반으로 구성하고 설명한다.<br>\n각 구성은 다음과 같다.</p>\n<ul>\n<li>FileController : URL로 직접 접근하는 부분</li>\n<li>FileR2Service : R2 관련 로직을 핸들링하는 서비스 로직</li>\n<li>multerR2Options : Multer 처리 옵션 로직</li>\n</ul>\n<p>기타 설치해야 할 패키지는 아래와 같다.(같은 역할을 하는 다른 패키지를 써도 무방하다)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn add @types/multer --dev\nyarn add @nestjs/axios\nyarn add axios\nyarn add rxjs</code></pre></div>\n<p>각 구성 영역에 대해 설명한다.</p>\n<br>\n<h3 id=\"2-1-filecontroller\" style=\"position:relative;\"><a href=\"#2-1-filecontroller\" aria-label=\"2 1 filecontroller permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-1 FileController</h3>\n<p>컨트롤러 영역은 별거 없다.<br>\n물론 파일 업로드 및 다운로드, 삭제 등의 작업 시 권한이나 그런 로직은 제외한다.<br>\n순수하게 기능에만 집중한 예제이기에 해당 코드를 바로 사용하기 보다는 약간 로직을 추가해서 쓰는 것이 좋다.</p>\n<p>그리고 아래 예제는 내가 사용하던 코드인데 일부 코드는 공개가 불가능해서 조작하였다.<br>\n약간 억지같은 부분도 있지만 기능 구현이라는 관점만 봐주셨으면 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Controller<span class=\"token punctuation\">,</span> Delete<span class=\"token punctuation\">,</span> Get<span class=\"token punctuation\">,</span> Param<span class=\"token punctuation\">,</span> Post<span class=\"token punctuation\">,</span> Req<span class=\"token punctuation\">,</span> Res<span class=\"token punctuation\">,</span> UploadedFile<span class=\"token punctuation\">,</span> UseInterceptors <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FileInterceptor <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/platform-express'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Request<span class=\"token punctuation\">,</span> Response <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'express'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FilesSuccessCode<span class=\"token punctuation\">,</span> FilesSuccessResponse <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./files.response.success'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> multerR2Options <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./multer.options'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FilesService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./services/files.service'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'files'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FilesController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> fileService<span class=\"token operator\">:</span> FilesService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Post</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'upload'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">UseInterceptors</span></span><span class=\"token punctuation\">(</span><span class=\"token function\">FileInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token string\">'file'</span><span class=\"token punctuation\">,</span> multerR2Options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">fileUpload</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">UploadedFile</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> file<span class=\"token operator\">:</span> Express<span class=\"token punctuation\">.</span>Multer<span class=\"token punctuation\">.</span>File<span class=\"token punctuation\">,</span> <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Req</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileService<span class=\"token punctuation\">.</span><span class=\"token function\">upload</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> FilesSuccessResponse<span class=\"token punctuation\">.</span><span class=\"token function\">returnRes</span><span class=\"token punctuation\">(</span>FilesSuccessCode<span class=\"token punctuation\">.</span><span class=\"token function\">uploadFile4R2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'get/:file_id'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">downloaFiles</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Res</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> response<span class=\"token operator\">:</span> Response<span class=\"token punctuation\">,</span> <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Param</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> param<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileService<span class=\"token punctuation\">.</span><span class=\"token function\">fileDownload</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">.</span>file_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    response<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">'Content-disposition'</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">attachment; filename=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>result<span class=\"token punctuation\">.</span>fileName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    response<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> result<span class=\"token punctuation\">.</span>axiosResponse<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Delete</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'delete/:file_id'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">deleteFiles</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Param</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> param<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileService<span class=\"token punctuation\">.</span><span class=\"token function\">updateDeleteStatus</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">.</span>file_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> FilesSuccessResponse<span class=\"token punctuation\">.</span><span class=\"token function\">returnRes</span><span class=\"token punctuation\">(</span>FilesSuccessCode<span class=\"token punctuation\">.</span><span class=\"token function\">deleteFile4R2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 <strong>FilesService</strong>가 있는데 이 서비스 로직은 디비에 저장 및 로깅, 기타 작업 등을 처리하는 메인 서비스 로직인데 이 부분은 아래 서비스 로직에서 다루겠다.</p>\n<br>\n<h3 id=\"2-2-fileservice--filer2service\" style=\"position:relative;\"><a href=\"#2-2-fileservice--filer2service\" aria-label=\"2 2 fileservice  filer2service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-2 FileService &#x26; FileR2Service</h3>\n<p>여기는 실제 기능을 담당하는 구현 로직이다.<br>\n<strong>FilesService</strong>의 경우 일부 로직만 구현되어 있기에 그냥 호출 흐름 정도만 공개한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//FilesService</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FilesService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> r2Service<span class=\"token operator\">:</span> FilesR2Service<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * 파일 업로드 영역\n   * @param req\n   * @param file\n   */</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">upload</span><span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> file<span class=\"token operator\">:</span> Express<span class=\"token punctuation\">.</span>Multer<span class=\"token punctuation\">.</span>File<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>Files<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//R2에 파일 업로드를 처리한다.</span>\n    <span class=\"token keyword\">const</span> fileKey<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token function\">getUuid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> r2Result<span class=\"token operator\">:</span> R2UploadResult <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>r2Service<span class=\"token punctuation\">.</span><span class=\"token function\">uploadR2</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> fileKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * 파일 다운로드 영역\n   * @param id\n   * @returns\n   */</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">fileDownload</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>GetDownloadFile<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> entity <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>filesRepo<span class=\"token punctuation\">.</span><span class=\"token function\">findEntityById</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>r2Service<span class=\"token punctuation\">.</span><span class=\"token function\">getFileR2</span><span class=\"token punctuation\">(</span>entity<span class=\"token punctuation\">.</span>r2Key<span class=\"token punctuation\">,</span> entity<span class=\"token punctuation\">.</span>uploadName <span class=\"token operator\">+</span> <span class=\"token string\">'.'</span> <span class=\"token operator\">+</span> entity<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">updateDeleteStatus</span><span class=\"token punctuation\">(</span>fileId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>r2Service<span class=\"token punctuation\">.</span><span class=\"token function\">deleteFileData4R2</span><span class=\"token punctuation\">(</span>fileKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>내가 구성한 코드의 경우 파일 업로드 시 해당 파일명을 <strong>uuid</strong>로 바꿔서 관리했다.<br>\n그래서 실제 R2에 파일 업로드 시 <strong>aaa.png</strong> 파일명이라면 R2에는 acbv-3342 등의 UUID로 변경되어 저장된다.<br>\n이는 향후 다운로드 시 디비에 저장된 값으로 다시 바꿔서 전달하면 되는 부분인데 여기서는 자세하게 설명하지 않는다.</p>\n<p>다운로드는 컨트롤러에서 받은 유니크한 UUID 생성 키 값으로 파일 데이터를 찾아서 R2에 저장된 파일명을 가져온다.</p>\n<p>삭제의 경우 원래 파일 상태만 바꾸는데 이번 예제에서는 직접 삭제를 진행한다.</p>\n<p>다음은 실제 구현 로직인 <strong>FileR2Service</strong>이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> HttpService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/axios'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Injectable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AxiosError<span class=\"token punctuation\">,</span> AxiosRequestConfig <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> firstValueFrom<span class=\"token punctuation\">,</span> lastValueFrom<span class=\"token punctuation\">,</span> map <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'rxjs'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FilesR2Service</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> http<span class=\"token operator\">:</span> HttpService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">uploadR2</span><span class=\"token punctuation\">(</span>file<span class=\"token operator\">:</span> Express<span class=\"token punctuation\">.</span>Multer<span class=\"token punctuation\">.</span>File<span class=\"token punctuation\">,</span> fileKey<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>R2UploadResult<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> url<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getUrl4WorkerR2</span><span class=\"token punctuation\">(</span>fileKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> baseHeader<span class=\"token operator\">:</span> AxiosRequestConfig <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getR2DefaultAxiosHeader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> file<span class=\"token punctuation\">.</span>mimetype<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> data<span class=\"token operator\">:</span> R2UploadResult <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">lastValueFrom</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">,</span> baseHeader<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//데이터가 안올 때 처리 필요</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">getFileR2</span><span class=\"token punctuation\">(</span>r2Key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> fileName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>GetDownloadFile<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> url<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getUrl4WorkerR2</span><span class=\"token punctuation\">(</span>r2Key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> axiosConfg<span class=\"token operator\">:</span> AxiosRequestConfig <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getR2DefaultAxiosHeader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    axiosConfg<span class=\"token punctuation\">.</span>responseType <span class=\"token operator\">=</span> <span class=\"token string\">'arraybuffer'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//AxiosRequestConfig 추가</span>\n    <span class=\"token keyword\">const</span> fileData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> axiosConfg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      axiosResponse<span class=\"token operator\">:</span> <span class=\"token function\">firstValueFrom</span><span class=\"token punctuation\">(</span>fileData<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      fileName<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * [주의] R2에서 물리적 파일 삭제 처리 함수\n   * @param fileKey R2에 저장된 파일명\n   * @returns\n   */</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">deleteFileData4R2</span><span class=\"token punctuation\">(</span>fileKey<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> url<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getUrl4WorkerR2</span><span class=\"token punctuation\">(</span>fileKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> axiosConfg<span class=\"token operator\">:</span> AxiosRequestConfig <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getR2DefaultAxiosHeader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> axiosConfg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> callback <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">firstValueFrom</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> callback<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> <span class=\"token string\">'success'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * R2에 업로드 Url을 생성해주는 메서드\n   * @param fileName\n   * @returns\n   */</span>\n  <span class=\"token keyword\">private</span> <span class=\"token function\">getUrl4WorkerR2</span><span class=\"token punctuation\">(</span>fileName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//CF_R2_WORKER_URL = \"https://myworker.workers.dev/\"</span>\n    <span class=\"token keyword\">return</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">CF_R2_WORKER_URL</span> <span class=\"token operator\">+</span> fileName<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">getR2DefaultAxiosHeader</span><span class=\"token punctuation\">(</span>headerOpt<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> AxiosRequestConfig <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> baseHeader <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">'X-Auth-My-S-Key'</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">CF_R2_AUTH_KEY</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      headers<span class=\"token operator\">:</span> headerOpt <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">?</span> baseHeader <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>baseHeader<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>headerOpt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>자잘자잘한 로직이 많다.<br>\n코드를 보면 알겠지만 좀 지저분하고, 로직이 난잡한데 이는 비공개 코드를 지우느라 어색한 부분이 있어서 그렇다.(물론 코드 리팩토링이 아직 제대로 안됨 -_-;)</p>\n<p><strong>getUrl4WorkerR2</strong> 메서드의 경우 .env 파일에 있는 값을 가져오는데 저기서는 Worker Url이다.<br>\n자신이 설정한 URL로 설정해두자.</p>\n<p><strong>getR2DefaultAxiosHeader</strong> 메서드의 경우 Axios 요청 시 헤더 값이다.<br>\n여기서 헤더의 키 값은 <strong>wrangler.toml</strong>파일과 맞춰줘야 한다.<br>\n전 포스팅에서 만들었던 암호키를 넣으면 된다.</p>\n<p>그리고 헤더 이름도 <strong>index.ts</strong>에서 처리한 것과 같게 해줘야 한다. (너무 당연한 이야기…)<br>\n각자 구성에 맞춰서 진행해야 에러가 안난다.</p>\n<p>403뜨면 이 부분을 잘 확인해보자.</p>\n<p>그 외에 부분은 코드를 보면 이해가 될 것이다.<br>\n업로드 후 <strong>data</strong>를 로깅으로 찍어보면 아래와 같은 값이 나온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">data =  {\n  uploaded: '2023-01-31T00:59:59.713Z',\n  etag: '8b0e11242eda10911c1d203f33ab841b',\n  size: 630046,\n  version: '5307c9d4821a4ea903f7015ec19d72ef',\n  key: '7c7e5ae2-8260-499e-883c-949a0a687ada'\n}</code></pre></div>\n<p>각 설명은 아래를 참고하자</p>\n<ul>\n<li>uploaded : 업로드 날짜</li>\n<li>etag : 고유 etag 값</li>\n<li>size : 파일 사이트</li>\n<li>version : R2에서 사용하는 값</li>\n<li>key : 업로드한 파일명</li>\n</ul>\n<p>저기 로직에서 axios 통신을 보면 Workers의 HTTP 처리기 로직(index.ts)와 매칭이 된다.<br>\n이 부분을 잘 응용하면 좀 더 고도화 된 코드를 구현할 수 있는데, 귀찮으면 일단 여기 로직으로 시작해도 된다.</p>\n<br>\n<h3 id=\"2-3-multerr2options\" style=\"position:relative;\"><a href=\"#2-3-multerr2options\" aria-label=\"2 3 multerr2options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-3 multerR2Options</h3>\n<p>이건 약간 번외 파일인데…<br>\n각자 업로드에 맞춰서 사용하면 된다.</p>\n<p>아래는 그냥 내가 사용했던 샘플 코드인데…<br>\n그냥 어디선가 긁어온 코드를 그냥 사용했었다…</p>\n<p>물론 지금 내 서비스 코드는 다르게 되어 있지만…<br>\n여러분들도 입맛에 맞춰서 바꿔 사용해보시는 것을 추천한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> HttpException<span class=\"token punctuation\">,</span> HttpStatus <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> existsSync<span class=\"token punctuation\">,</span> mkdirSync <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'fs'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> diskStorage <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'multer'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> extname <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'path'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> multerR2Options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">fileFilter</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">.</span>mimetype<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\/(jpg|jpeg|png|gif)$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpException</span><span class=\"token punctuation\">(</span>\n          <span class=\"token punctuation\">{</span>\n            message<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            error<span class=\"token operator\">:</span> <span class=\"token string\">'지원하지 않는 이미지 형식입니다.'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          HttpStatus<span class=\"token punctuation\">.</span><span class=\"token constant\">BAD_REQUEST</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  limits<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    fieldNameSize<span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 필드명 사이즈 최대값 (기본값 100bytes)</span>\n    filedSize<span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 필드 사이즈 값 설정 (기본값 1MB) 10MB</span>\n    fields<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 파일 형식이 아닌 필드의 최대 개수 (기본 값 무제한)</span>\n    fileSize<span class=\"token operator\">:</span> <span class=\"token number\">16777216</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//multipart 형식 폼에서 최대 파일 사이즈(bytes) \"16MB 설정\" (기본 값 무제한)</span>\n    files<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//multipart 형식 폼에서 파일 필드 최대 개수 (기본 값 무제한)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>좀 성급한 정리의 감이 없지않아 있지만…\n위 코드를 참고하면 구현할 수 있을 것이다.</p>\n<p>R2와 S3는 사실 각각의 장단점을 가지고 있다.<br>\nS3는 접근 제어를 할 수 있지만, R2는 내가 알기론 다 공개형태이다.</p>\n<p>URL만 있으면 접근이 가능하다는 뜻이다.<br>\n그래서 이 부분이 서비스 구현에 맞다면 R2를 쓰는것이 좋지만…</p>\n<p>보안이 좀 필요하거나 하면 S3를 쓰는게 맞는 것 같다.</p>\n<p>각자 구성환경이 좀 다르겠지만…<br>\n보통 React 또는 Next.JS를 프론트에 두고, 백엔드는 Nest.js 또는 스프링, FastApi 등을 쓰고 할 것이다.</p>\n<p>근데 나는 Next.Js + Nest.Js 에 Ngix를 통해서 작업을 했다.<br>\n근데 Next.Js에서 미들웨어에서 파일에 대한 ByteArray를 전달할 때 좀 문제가 있었다.</p>\n<p>물론 이 부분은 다 구현해서 정리해뒀다.</p>\n<p>나중에 시간날 때 저 환경에서 파일 업로드 다운로드를 하는 부분에 대해 포스팅 해볼 예정이다.</p>\n<p>예제를 최대한 친절하게 작성해뒀지만…<br>\n이해가 안되는 부분이 있다면 댓글로 남겨주시면 확인 후 답변 드릴 예정이다.</p>\n<p>나중에 시간이 좀 많이 널널해지면 그땐 깃허브에 예제를 올리고 해당 포스팅 문서도 업데이트 하도록 할 예정이다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#1-worker-%EC%B2%98%EB%A6%AC%EA%B8%B0-%EB%B0%B0%ED%8F%AC\">1. Worker 처리기 배포</a></p>\n</li>\n<li>\n<p><a href=\"#2-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B5%AC%EC%84%B1\">2. 프로젝트 구성</a></p>\n<ul>\n<li><a href=\"#2-1-filecontroller\">2-1 FileController</a></li>\n<li><a href=\"#2-2-fileservice--filer2service\">2-2 FileService &#x26; FileR2Service</a></li>\n<li><a href=\"#2-3-multerr2options\">2-3 multerR2Options</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2023.02.03","title":"CloudFlare R2 사용해보기 Part 2 (With Nest.Js)","categories":"nest_js","emoji":"📜"},"fields":{"slug":"/nest_js/230203_r2_nestjs/"}},"prev":{"id":"33136f3f-ee90-5a0d-887d-0f2cef0335bb","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADRElEQVQ4y12US2wbVRSGB0Gl0CKoYFUhJCSQEEKwgx07NqxY0AULFqDSsgGkiq5KEEUNQmqqVpBKIaFCNCmQ4tJESdPmWezYscHEjR0Sv+K3x6/4NZ4ZP2LH+dDc2KHp4tdcnXvvd/9zztwrRXdVHlakXSGFjtxRuqMkOtdy63zmneXNxWEC7TIn3X/wwmQ/p1wTvGUbQuoCut9wu0J8V+OeJrNUTQvNqgkWNBlrNc1f9RybbZWPVm7zjvcG57ds/Jbe4NX57zlXsOwBH4TGd1XSVLkou7mQdHNR9nA6ZOeC7OZs1Elv1MkP2Q0iuyr36gkSqERbKmd8M1wve5AMUBdmuPNsF9holVjdzuNvlVlrFoS7fxpbYs5Zz+GoZcXaYEshtFMh1jEUaJb/BybQcDXyfOA3czps55PNZYZzXhY1mRN+i3DZL7vpjTmZ05J8k7jPxwGLOMQokcEwwAccGgF7LcukEuNOJc6MmhCHjOYDjJcj/KmnsFYzrDWLmPWUiG/uKGJfuK0I11K4Q/a1StxVE8yqSbHRXssIqJGe0RgjZqRrxLrNsehpATYYMlUhyYCFRMo6m60Swe0iVj2NqRQWi2+WwvxaCDJWDAnHI/kAt8oRlmsZ1ptFvK2SKNdSOY5NSSBZaxkUGjgrMic3LLwX+5vpqsxKNcPPOT/uZkE0x9jsa5UFwBgbqSY6tduiweVVMy/9eB7p3bV5PnRM88qtIXqWTTy2NMbrzmmOz41xyGHCVImRp7ZfY6MBhrqdDe0oZGhg8rt47co5pCMTQ0jf9XJ0fJCjS7/z6JWvkfrO0HNjgOddU5jVpLgtobZCt4EHfrUdhTR1bkf+5e2Bb5GenrrKka8+5dmFUZ6yj/PIYB9PDPZx2PwLn4fsFKgTQSOOTgxtXw8DZxJeTlwfRnryzk+8fOlLjpkGeMZ9l8etNzk0f4035kZwKUmCtTxePYdXy+LTc/iqOfy1/IGrmqLGYjrI5RUbUs/0VU5ZJ/nCPMFzE4O8uDDK+45JLEkfvkoadymJp5RkNR/HU9wbryupfWD3UtzXsox415AOTw1xNmCnQh1bPoKjGBMvS4o60U6qe6o+MNYPPChxNNxqln7LPP8BgQwLPksIP+0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b5f24e21be04a562b4404a504cee629c/7c297/img01.webp 180w,\n/static/b5f24e21be04a562b4404a504cee629c/33ecc/img01.webp 360w,\n/static/b5f24e21be04a562b4404a504cee629c/df77d/img01.webp 720w,\n/static/b5f24e21be04a562b4404a504cee629c/1230c/img01.webp 775w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b5f24e21be04a562b4404a504cee629c/e9ea2/img01.png 180w,\n/static/b5f24e21be04a562b4404a504cee629c/53918/img01.png 360w,\n/static/b5f24e21be04a562b4404a504cee629c/242a6/img01.png 720w,\n/static/b5f24e21be04a562b4404a504cee629c/49bb6/img01.png 775w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b5f24e21be04a562b4404a504cee629c/242a6/img01.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"오늘의-강의는\" style=\"position:relative;\"><a href=\"#%EC%98%A4%EB%8A%98%EC%9D%98-%EA%B0%95%EC%9D%98%EB%8A%94\" aria-label=\"오늘의 강의는 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>오늘의 강의는..</h1>\n<p>2일차 부터는 실제 Nest.Js에 대해서 알아보고, **포트 앤 어뎁터 아키텍쳐(Ports and Adapters Architecture)**에 대해 설명을 하는 시간을 가졌다.<br>\n강의를 들으면서 내용을 정리한 부분이다.</p>\n<p>옆에서 강의 틀고 노션 및 수기로(개판 필기체를 해석 하는데 힘들었다…) 작성한 것을 다시 곱씹고 하면서 강의 내용을 정리했다.<br>\n이렇게 라이브를 직접 옮기면서 작성한 것을 정리한 것이라 약간 엉성할 수 있다.<br>\n이 부분은 감안하고 봐주시길 바란다.</p>\n<br>\n<h2 id=\"강사님의-이야기-시간\" style=\"position:relative;\"><a href=\"#%EA%B0%95%EC%82%AC%EB%8B%98%EC%9D%98-%EC%9D%B4%EC%95%BC%EA%B8%B0-%EC%8B%9C%EA%B0%84\" aria-label=\"강사님의 이야기 시간 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>강사님의 이야기 시간</h2>\n<p>강사님의 개발자 일대기 이야기를 해주셨다.<br>\n재직한 회사에서 다양한 경험을 쌓으셨고 매 순간 열심히 하신 것 같다.</p>\n<p>어떤이는 운도 중요하여, 열심히 해도 운이 안좋으면 취업, 이직이 어렵다 라고 이야기 하는 사람도 있다.<br>\n하지만 개인적으로 거꾸로 아닌가 싶다.</p>\n<p><strong>열심히 노력하고 준비를 하고 있어여 기회가 온 운을 잡을 수 있는게 아닌가?</strong> 라는게 나의 생각이다.</p>\n<p><font color=\"red\"> 불확실성은 곧 희망이다.</font></p>\n<p>강사님의 이 멘트가 개인적으로 많이 와닿았다.</p>\n<br>\n<h2 id=\"실무-함수형-프로그래밍-빌드업\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EB%AC%B4-%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EB%B9%8C%EB%93%9C%EC%97%85\" aria-label=\"실무 함수형 프로그래밍 빌드업 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실무 함수형 프로그래밍 빌드업</h2>\n<p>오늘의 강의 내용은 아래와 같았다.</p>\n<ol>\n<li>Nest.Js 주요 컨셉</li>\n<li>Ports and Adapters Architecture</li>\n<li>Live Coding1 : Nest.js 로 프로젝트 아키텍처 구성하기</li>\n<li>Live Coding2 : 사전과제 로직 함께 리팩토링 하기</li>\n</ol>\n<p>초반에 많은 질의가 있었다.<br>\n간단하게 정리하면…</p>\n<ul>\n<li>Express를 안쓰는 것은 아니다.</li>\n<li>Express를 좀 더 추상화 한 개념이 Nest.js</li>\n<li>Nest.Js는 Express 기반이고, Angular에서 많은 영감을 받아서 개발하였다.</li>\n<li><strong>Layerd Architecture</strong>는 기업에서 많이 채택하는 아키택쳐</li>\n<li>쉽게 프로젝트를 구성할 수 있는 아키텍쳐</li>\n<li>Ports and Adapters Architecture 는 여기서 한 단계 더 진화된 아키텍처</li>\n<li>훨씬 더 직관적인 비즈니스 로직을 작성할 수 있는 아키텍쳐</li>\n</ul>\n<br>\n<h3 id=\"nestjs-주요-컨셉\" style=\"position:relative;\"><a href=\"#nestjs-%EC%A3%BC%EC%9A%94-%EC%BB%A8%EC%85%89\" aria-label=\"nestjs 주요 컨셉 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nest.js 주요 컨셉</h3>\n<p>Nest.Js 개발자는 고양이를 좋아한다.(?)</p>\n<br>\n<h4 id=\"controllers\" style=\"position:relative;\"><a href=\"#controllers\" aria-label=\"controllers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Controllers</h4>\n<p>컨트롤러에 대한 정의</p>\n<ul>\n<li>컨트롤러는 어플리케이션을 향한 요청을 받는 첫 번째 스탭</li>\n<li>라우팅 역할</li>\n<li>외부세계로 부터 들어온 요청이 어느 곳으로 가야하는지 안내하는 역할</li>\n<li>클라이언트로부터 요청이 들어오는 부분</li>\n<li>컨트롤러는 NestAPI 뿐만이 아닌 GraphQL이나 이런 것도 컨트롤러할</li>\n<li>요청이 들어오는 것이 컨트롤러이며, 요청이 되는 주체를 의미한다.</li>\n<li>외부 세계로 부터 들어온 요청이 어느 곳으로 가는게 맞냐 라는 역할</li>\n<li>사용자의 요청을 수행할 수 있는 비즈니스 로직에 요청을 보내는 주체</li>\n<li>하지만 컨트롤러는 순수함수가 아님을 유의한다. (외부에서 오는 요청 때문에…)</li>\n</ul>\n<br>\n<p>Nest.Js의 컨트롤러 생김새는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Controller<span class=\"token punctuation\">,</span> Get<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@nestjs/common\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cats\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsController</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">async</span> <span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> \"This action returns all cats\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>Nest.Js 컨트롤러는 <strong>Typescrit</strong>의 데코레이터 문법을 사용해 추상화를 했다.</li>\n<li>Nest.Js의 데코레이터 형식은 자바의 스프링과 모습이 비슷하다.</li>\n</ul>\n<br>\n<h4 id=\"providers\" style=\"position:relative;\"><a href=\"#providers\" aria-label=\"providers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Providers</h4>\n<ul>\n<li>NestJs의 근본이며 중요한 컨셉</li>\n<li>Nest.Js의 대다수의 클래스들이 provider로 구성</li>\n<li>provider는 디펜던시로 주입될 수 있다.</li>\n<li>컨트롤러는 HTTP 요청을 핸들링하고 더 복잡한 일들(디비 처리, 요청에 대한 작업 등)을 provider에게 위임 해야한다.</li>\n<li>provider에게 중요한 비즈니스 로직을 가둔다.</li>\n<li>provider는 그저 javascript의 class일 뿐이다.</li>\n<li>프레임워크에 종속되지 않은 클래스이고, javascript에서 클래스는 결국 프로토타입 함수다.</li>\n<li>provider는 순수함수가 될 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> cats<span class=\"token operator\">:</span> Cat<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token function\">create</span><span class=\"token punctuation\">(</span>cat<span class=\"token operator\">:</span> Cat<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cats<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>cat<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'cats'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> catsService<span class=\"token operator\">:</span> CatsService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Post</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Body</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> createCatDto<span class=\"token operator\">:</span> CreateCatDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>catsService<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>createCatDto<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>위 코드에서 보면 컨트롤러는 서비스 객체에게 위임한다.</li>\n<li>위임을 표시하는 것이 컨트롤러의 생성자 주입(의존성 주입 형태 중 하나)이 그 표현이다.</li>\n<li>즉 데코레이터 모두 빼면 함수이고, 함수형 프로그래밍 페러다임으로 적용이 가능하다.</li>\n<li>참고 <a href=\"https://docs.nestjs.com/providers\">Provider 공식문서</a></li>\n</ul>\n<br>\n<h4 id=\"modules\" style=\"position:relative;\"><a href=\"#modules\" aria-label=\"modules permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Modules</h4>\n<ul>\n<li>일종의 패키지 역할을 하는 것</li>\n<li>같은 도메인에 속한 것들을 응집화 할 수 있도록 도와주는 역할</li>\n<li>앱의 사이즈가 커질수록, 경계를 설정해서 복잡도를 매니징할 수 있다.</li>\n<li>경계(도메인)를 설정해서 각 모듈 간의 의존도를 제어할 수 있게 해준다.</li>\n<li>MSA도 모듈화의 방법 중 하나</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>CatsController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>CatsService<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>위 코드에서 데코레이터를 선언하고 controllers 배열에 controller 역할을 하는 것을 전달하고, providers도 동일하다.</li>\n<li>provider에서 @Injectable() 데코레이터만 붙이기만 하면 안되고, 모듈의 provider 배열에 전달해야 nest.js에 위임한다.</li>\n</ul>\n<br>\n<h4 id=\"dependency-injection\" style=\"position:relative;\"><a href=\"#dependency-injection\" aria-label=\"dependency injection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency Injection</h4>\n<ul>\n<li>Inversion of control (IoC)</li>\n<li>Nest.js 런타임 시스템에 dependency 인스턴스화를 위임한다.</li>\n<li>실제 객체를 인스턴스화 시키는 작업을 프레임워크에 위임하는 것</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsService</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cats\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> catsService<span class=\"token operator\">:</span> CatsService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>CatsController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>provide <span class=\"token operator\">:</span> CatsService<span class=\"token punctuation\">,</span> useClass <span class=\"token operator\">:</span> CatsService<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>위와같은 코드가 있을 때 Nest.js에서 처음에 부트스트랩을 할 때 인스턴스를 계산해서 필요한 클래스를 생성하고, 런타임 시점에 해당 컨트롤러나 프로바이더에 주입한다.</li>\n<li><strong>개발자가 의존성에 대해 직접 인스턴스 생성 및 관리를 할 필요가 없다.</strong></li>\n<li>위 코드를 기준으로 흐름을 보면 다음과 같다.</li>\n</ul>\n<br>\n<ol>\n<li>\n<p>CatsController를 인스턴스화 할 때, dependency(의존성)를 확인한다.</p>\n</li>\n<li>\n<p>CatsService 토큰은 CatsService 클래스를 리턴한다.</p>\n<ul>\n<li>여기서 나온 토큰의 의미는 식별자를 의미한다.</li>\n<li>하단의 @Module을 보면 providers 배열 안에 <strong>provide</strong>가 토큰(식별자 또는 구분자)를 가리킨다.</li>\n<li>저 토큰은 클래스도 되지만 일반 문자열(string)도 가능하다</li>\n<li><strong>useClass</strong>에는 직접 구현한 클래스를 넣는다.</li>\n<li>이 코드 어디서도 new 등으로 인스턴스 할당하는 로직을 볼 수 없다.</li>\n<li>providers에는 저렇게 토큰 명시를 해서 구현하기도 하고, 그냥 CatsService만 명시해서 쓰기도 한다.</li>\n</ul>\n</li>\n<li>\n<p>Singleton 스코프(default)로 CatsService를 인스턴스화 시킨다.</p>\n<ul>\n<li>그래서 Nest.js에서 부트스트랩 시 providers를 보고 식별자와 구현 클래스를 확인 후 CatsService 인스턴스를 싱글톤(기본값)으로 인스턴스화 한다.</li>\n</ul>\n</li>\n<li>\n<p>메모리 내에 캐시를 하고 재사용이 가능하게끔 만든다.</p>\n<ul>\n<li>Nest.js에는 컨테이너를 운영하는데 그 안에 CatsService 객체가 생성되어 있다.</li>\n<li>그래서 요청 시 미리 메모리에 올려 있는 것을 가져와서 쓴다.</li>\n</ul>\n</li>\n<li>\n<p>이 모든 과정은 Bottom up으로 dependency가 정확한 순서로 관리된다.</p>\n</li>\n</ol>\n<br>\n<p>이것이 <strong>Nest.js의 핵심 내용</strong>이다.</p>\n<p>스프링과 같다라고 하는 의견이 많았다.<br>\n나 또한 같은 것을 느꼈고, 어떤 이는 라이트 스프링이라고 이야기 했는데 정말 그런것 같다.</p>\n<p>과거 스프링을 4년 정도 개발했던 나로써 Nest.js 및 Typescript 언어에 대한 거부감이 없었고, 학습도 쉬웠다.<br>\n오히려 난 Javascript가 좀 난해했다. (타입이 없었고 너무 자유분방한 것 같아서 그랬었던 것 같다.)</p>\n<br>\n<h3 id=\"architectures\" style=\"position:relative;\"><a href=\"#architectures\" aria-label=\"architectures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Architectures</h3>\n<p>먼저 Layered Architecture에 대해 설명 및 한계에 대한 설명을 했다.</p>\n<h4 id=\"layered-architecture의-한계\" style=\"position:relative;\"><a href=\"#layered-architecture%EC%9D%98-%ED%95%9C%EA%B3%84\" aria-label=\"layered architecture의 한계 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Layered Architecture의 한계</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAACiUlEQVQoz4WR22sTURDG968uokUFBcGiUBRLVQSxSMEHW2lrpbWNadM0JE0Tk2yyu8lu9p7rbnP2cvZyzhlJ2pIgVD9+DzMP33wzDAcAlE4BYCwZ0simuHdDNIVFfRb3r+s52GKpx42GXb5R5nlJaWe0+pnd6tpCpyfKPVG2xY7Bd5BRBe+c+SUIbvFL4OUZ1rjRWBelqqKqqppT6tVufdQoSLVzqZYXmxeyXBu6egtQQW/ta809ld/Vhe8D5acl7tBQ575+WttYe7W1sbm3+aZ4eKgLE7nely41sazJv/udysDVePALnpWdGJmJcTwxM56VRcYBwzo36ltXIws5g7EluFpVuczXj7YdTXbUTrO8awoVz+IBlcGrgj+HoRLDFge3YowAREJl79fm4/HER55bvnxkmGe27cfxiJAxpQ6lDqEOIc6sDThgDBgFBikxA5wfjzW9Uxn1hb7dtO0KQkYUHQC8S9IPQfg2CNeDcD2O32P8OiG562QGAISqCBXGTijHWgPxDY/vDZxeDwX4B8AKQiuS9EDuLKvdh7b9VFWXouRw0ezGRFA7Z+Xi5yskX3lyqfLR0IqJVyPkiLIswAnAKcAJm3JMqDS/mVAMMBIb+7ntl2AP2WCQzd/rK6egDZNIT6iREiNJ9STVCTUJ1VPqzpNTok1QxnFsw5S0Qd0YtCyz7Xi2n3xj8JzQVYDVsfOsJdw3jCeKsoTjhbUp8+NU8ZB0vvMiULrSxcGXreWJrqaWRFiDUJ5QPkkbOKrhuB7iCqELr5p9azqlXclFNrbaqtAuQggwYXCHFs1sZqd+gKMUpyRN02sbvQvur2GMMdd1Dd0wTTMMg9ub/p98I4yxN1OSJPBP/QFjJm4f1QhrSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/04767991753789e9650f890b7fd22b4a/7c297/img02.webp 180w,\n/static/04767991753789e9650f890b7fd22b4a/33ecc/img02.webp 360w,\n/static/04767991753789e9650f890b7fd22b4a/df77d/img02.webp 720w,\n/static/04767991753789e9650f890b7fd22b4a/426c3/img02.webp 922w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/04767991753789e9650f890b7fd22b4a/e9ea2/img02.png 180w,\n/static/04767991753789e9650f890b7fd22b4a/53918/img02.png 360w,\n/static/04767991753789e9650f890b7fd22b4a/242a6/img02.png 720w,\n/static/04767991753789e9650f890b7fd22b4a/b59ab/img02.png 922w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/04767991753789e9650f890b7fd22b4a/242a6/img02.png\"\n            alt=\"img02\"\n            title=\"img02\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<a href=\"https://medium.com/java-vault/layered-architecture-b2f4ebe8d587\">이미지 출처 - java-vault</a></p>\n<p>레이어드 아키텍쳐를 사용하다 보면 배치에 대해 고민이 생기게 된다.</p>\n<p>예를 들어 고객이 생성되었을 때, 메일을 보내는 기능을 추가해주고 싶은데 이 경우 메일 서비스를 만들어주면 되긴 한다.<br>\n근데 메일 서비스를 만들 때, 메일 송신을 담당하는 인프라 코드(구글, 네이버 등 메일을 보내게 해주는 인프라)는 어느 곳에 둘 것인지에 대해 고민이 있었다.</p>\n<p>즉 메일 전신을 만들어주는 기능이 있고, 해당 메일을 보내는 기능도 있으며, 메일 보냈을 때 기록을 남기는 기능도 있을 것이다.<br>\n이렇게 일일히 구분해서 하다보면 혼란이 온다.</p>\n<p>답이 명쾌하지 않기 때문에 혼란이 가중화 된다.<br>\n그래서 레이어드 아키텍쳐는 다양한 비즈니스 로직을 충족시키기에는 한계가 있는 구조다.</p>\n<br>\n<h4 id=\"layered-architecture의-진화-port-and-adapter-architecture\" style=\"position:relative;\"><a href=\"#layered-architecture%EC%9D%98-%EC%A7%84%ED%99%94-port-and-adapter-architecture\" aria-label=\"layered architecture의 진화 port and adapter architecture permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Layered Architecture의 진화 (Port and Adapter Architecture)</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 708px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.22222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADj0lEQVQ4y0WT2VObVRjG8694oSPa8a533nin4//gjK3YjuPWUWnB2gVap2kDA7IkZCmB7IQtZIOEJmT9ku9LCGsIsRakdFrGqcoohK3n53wJ6tVz5pwzv3nnfZ5H40wPYn3Uy3Csv66DwU70vvtictlOZs0pDmWTOJJN1FUxU8sb2Qrp+HlaS3Vay1ZYx+PAffL2G2wGH6AJrbsJll0E110NLbsIlV3Cv+4mveoQh4q5AVTMKlwFc6yY63pStPAy0ceT4IP6Wb3TqIBwxUN43cO/8NC6W/jLLtIrNlGTjXVQ7WzC44KZfcnAvqRHlIZ4OttFydPOq5JV/YNGBY2VLBhT9/Ct2AhXRgmVnSJQ9ZJanxDHxRGhTvSqNCQOJD27KTPxXImZVIHt+Yc8m9Wxl+pDKHqOFSOamcoollQn1xyf0B35Af+qjWBlTHhzBjKJ78RurE3sS2Y2fFox3H6RrUgfi0qaBTnNHzkromjkueSgIkfZlRyNHc5ueDHMaemY+gK7Mkio0I/iOS/2Yk3sZ99Btn8oJrquEDNf5SDbz0vJynwyiZSMsjOrYyHqJpIrU81MojEm7tEbbceS1uEuDNDyUwt+2wei7H6djPWckG1vi/jga8wMXBLh/hYmdJd5Mj9MPL9MTsqwlzXWTTrINwzT6EKttNo+5YbnM4ZSnVy81sxI33viWegtgr1NomA/J9bGmhjTfSRKnjvsRLr4WzJwXLDUDTotmqnJDWAtb0IzvWLHt2zDkujCKffTfP0Clz9/n53IeXGQeJOtwBsEet4VRVc7ppsXqIzdopyPEits8Fia4td5C3NpmflihYVcHI0amaFkN7e9X9EVbcMpDXDHdl348j0sZr4Ui6OXhK/7CgXXLbHg6WA7pGUjP0NCXqKa9FAMD2P2pQllltlQHqEZmLvLt0Mfc/VhM45cPwNzP6L1fyNGl+ykKz7xIqYXqaFWhjuaxVHewKms51QxcKIYQdFzpJj4TfawJ5lQ3zV2uZeeyE28ioVodZzb7q9VuBgrWZHKDnGkmMTa+F02g1qxlR2lWozVAYc5PdulKL+UF/gzP8ypYlTb1IhNPTpVL/5VB53B7+kMtgnfmvO/6qkLP8j2iaWixHj+KYX4FM9ntESSMt7sJtuFACeyvgEMrLoIrLjwLzvP1MH0iu3/Lp9VTp10Tx7h94KHv2QrtZyBpaUS8ZUdXhQmOZENdeA/S0pphehoBqYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8fdf0f051ea9c4a19ee730080506d4cc/7c297/img03.webp 180w,\n/static/8fdf0f051ea9c4a19ee730080506d4cc/33ecc/img03.webp 360w,\n/static/8fdf0f051ea9c4a19ee730080506d4cc/cc093/img03.webp 708w\"\n              sizes=\"(max-width: 708px) 100vw, 708px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8fdf0f051ea9c4a19ee730080506d4cc/e9ea2/img03.png 180w,\n/static/8fdf0f051ea9c4a19ee730080506d4cc/53918/img03.png 360w,\n/static/8fdf0f051ea9c4a19ee730080506d4cc/d65de/img03.png 708w\"\n            sizes=\"(max-width: 708px) 100vw, 708px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8fdf0f051ea9c4a19ee730080506d4cc/d65de/img03.png\"\n            alt=\"img03\"\n            title=\"img03\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<a href=\"https://www.getoutsidedoor.com/2018/09/03/ports-adapters-architecture/\">이미지 출처 - getoutsidedoor</a></p>\n<p>외부에서 접근은 Rest Api가 될 수 있고, 개발자들끼리 CLI로도 올 수 있고 다양한 접근이 가능하다.\n그리고 내부에서 처리는 각 요구사항에 맞는 부분들의 도착지가 있다.</p>\n<p>이렇게 될 경우 모든 로직은 <strong>Business Logic</strong>이라는 부분으로 외부 내부의 시선이 모이게 된다.<br>\n위 그림에서처럼 왼쪽은 요청이 들어오는 영역이고, 오른쪽은 인프라에 영향을 끼치는 영역이다.</p>\n<p>오른쪽은 개발자가 크게 신경을 쓸 부분은 아니다.<br>\n어찌보면 각 인프라나 디비의 경우 구현체가 있고 거기까지 흐름을 가져다 주는게 개발자의 역할일 뿐이다.(강사님은 농담 뉘앙스로 내 알바 아님이라 표현하심 ㅋ)</p>\n<p>포인트는 <strong>우리가 작성하는 비즈니스 로직은 내부에 가두고, 들어오는 요청을 받는 부분의 문을 열어준다.(포트를 열어준다.)</strong></p>\n<p>위 그림에서 왼쪽 영역의 경우…<br>\n외부에서 요청한 것은 포트로 받고, 내가 작성한 비즈니스 로직을 사용하려면 포트로만 접근하여 사용할 수 있게끔 해주는 것.</p>\n<p>오른쪽 영역의 경우…<br>\n약속된 포트를 통해서만 구현체에게 명령을 준다라는 것.</p>\n<p><strong>이것이 포트 앤 어뎁터 아키텍쳐(Port and Adapter Architecture)이다.</strong></p>\n<p>이것을 다시 정리하면…</p>\n<ul>\n<li>인터페이스를 통해서 해당 포트로 접근이 가능하게끔 한다는 것이 포인트.</li>\n<li>내가 미리 약속한 인터페이스를 통해서만 포트에 접근이 가능하고, 포트를 통해서만 비즈니스 로직에 접근이 가능하다.</li>\n<li>그리고 비즈니스 로직에서 처리한 결과가 포트를 통해 외부세계(인프라나 디비 영역)에 영향을 준다.</li>\n<li>레이어드 아키텍쳐에서 특정 로직을 담당하는 코드를 어디에 위치해야 할 지를 고민하던 것들을 해결하기 위해 나왔다.</li>\n<li>무조건 포트를 통해서만 서로 통신을 한다.</li>\n</ul>\n<p>개념적인 이야기는 이게 끝이다.</p>\n<p>내부 세계(우리가 작성하는, 또는 작성해야 할 영역)는 각종 버그와 위험(잘못짠 코드..)이 도사리고 있다.<br>\n이런 위기를 구원해주는 패러다임이 있다.<br>\n패러다임은 프로그래밍 룰이 필요하고, 마인드셋(어떠한 사고로 프로그래밍을 할 것)이 필요하며, 우리가 작성한 어플리케이션 코드를 바라보는 철학이 필요하다.</p>\n<p>저번 시간에는 함수형 프로그래밍 룰을 통해 사이드 이팩트를 줄이고, 고차함수를 통해 함수를 합성하는 것을 배웠다.<br>\n이번에는 인터페이스라는 룰을 배울 것이다.</p>\n<br>\n<h4 id=\"interface\" style=\"position:relative;\"><a href=\"#interface\" aria-label=\"interface permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Interface</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACL0lEQVQ4y4VTi2riUBDN/3+CVTSuVAVppVWjixYrIuJWsCpCQWWVqKt5+EpMfJ5lBuJeH2UvJAP3zj33zDkz0uFwwL3veDxiOp2i0WigXq+j2+1iv9/zvndOkfbEOxLurNPpxJESbNvGYrGAruvYbrfnMy9eL0kE8T5ajuvC3mzgOg4c24ZlWViv1xdgo9EIrVaL2Xn7Ev2Iibjocur5GfFIBMmnJ/xUFDxGo4jH4xgOh+e8UqmEUCiE1Wr1D5BeXS6X2Gw2MAyDD6rVKn48POA1kUBWURgwk8kgGAwil8uxbiTFfD5nOcQKJdGI3X6Pha5DSafxGIvh93AIa7XCVFVhWxZ+fXwgmUyi3++znq7r3uh5YwqVEYlEUHl/h65pWJomTFXF3DCgGwYDUukemCjXjYa9Xo/LisViLDhp82c6xWQygT6bcZnlchl+v59luWfmBeB4PEY4HEY0GkX36wumacIghrrObEnvSqUCn8+HZrN5A8gMPbqO42C326FWq0GWZeSzWQYkxykSu8lkzOYUCgXOvdaPAcldepkuUJxrGl5fXiCHw2i329zQBEhTk0qlIMshloByaY8cv2hscovYiS81Pj8RCAS4/EQigWKxyDKQdvl8/pxHbdbpdPhhcp7ApXsjR+W8vb0hnU5z35EMFBVFYcaiTJqmYTabcU/yLF+7JDL1zCI5yHGx7/47yyKYmEyMVFVlzaj5rx//1uV7PUWR+nEwGNxMxXcM/wJHibFD8k0JAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3138e92f529c553b096e92ce9ed78800/7c297/img04.webp 180w,\n/static/3138e92f529c553b096e92ce9ed78800/33ecc/img04.webp 360w,\n/static/3138e92f529c553b096e92ce9ed78800/df77d/img04.webp 720w,\n/static/3138e92f529c553b096e92ce9ed78800/5c666/img04.webp 1080w,\n/static/3138e92f529c553b096e92ce9ed78800/8a635/img04.webp 1428w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3138e92f529c553b096e92ce9ed78800/e9ea2/img04.png 180w,\n/static/3138e92f529c553b096e92ce9ed78800/53918/img04.png 360w,\n/static/3138e92f529c553b096e92ce9ed78800/242a6/img04.png 720w,\n/static/3138e92f529c553b096e92ce9ed78800/b4ad3/img04.png 1080w,\n/static/3138e92f529c553b096e92ce9ed78800/a20ca/img04.png 1428w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3138e92f529c553b096e92ce9ed78800/242a6/img04.png\"\n            alt=\"img04\"\n            title=\"img04\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<a href=\"https://engineering-skcc.github.io/microservice%20inner%20achitecture/inner-architecture-2/\">이미지 출처 - SK(주) C&#x26;C’s TECH BLOG</a></p>\n<p>컨트롤러에서 들어오는 영역을 인바운드 어뎁터라 하고, 컨트롤러가 내부 비즈니스 로직을 처리하기 위한 문(포트)를 인바운드 포트라 한다.<br>\n내가 작성한 서비스 로직에서 처리 결과나 외부 세계로 작업 결과물을 내보내는 문(포트)를 아웃바운드 포트라 하고, 그 문과 연결되어 처리되는 부분을 아웃바운드 어뎁터라 한다.</p>\n<br>\n<h4 id=\"ports-and-adapters-architecture\" style=\"position:relative;\"><a href=\"#ports-and-adapters-architecture\" aria-label=\"ports and adapters architecture permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ports and Adapters Architecture</h4>\n<p>내용을 정리하면 아래와 같다.</p>\n<ul>\n<li>inbound-adapter : controller, GraphQL, REST, gRPC, CLI 등</li>\n<li>inbound-port : 서비스 로직으로 향하는 interface</li>\n<li>service : inbound-port 구현체</li>\n<li>outbound-port : 외부 세계로 향하는 interface</li>\n<li>outboud-adapter : outbound-port 구현체 (DB, Search Engine, Notification, Mail 등)</li>\n</ul>\n<br>\n<h3 id=\"수업-중간-질문\" style=\"position:relative;\"><a href=\"#%EC%88%98%EC%97%85-%EC%A4%91%EA%B0%84-%EC%A7%88%EB%AC%B8\" aria-label=\"수업 중간 질문 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>수업 중간 질문</h3>\n<p>실제 라이브 코딩 전 잠깐 질의 응답 시간이 있었는데 이를 간략하게 정리했다.<br>\nQ 는 수강생이 질문한 것이고, A는 강사님이 답변하신 부분이다.</p>\n<p>Q : 기존 레이어드 아키텍쳐에 비해 좋은 게 뭐가 있는가?<br>\nA : 지금 당장은 생각이 나지 않는다.</p>\n<p>Q : In-Out port 사이에 있는 service가 거대해 지는 문제점이 있지 않나?<br>\nA : 그렇게 하지 않기 위해 개발자가 노력해야 한다.<br>\n그래서 서비스를 최대한 최소 단위로 나누고, 그 안을 함수형 프로그래밍 페러다임을 적용하면 좋다(라고 개인적인 의견이라 말씀하심)</p>\n<p>Q :Service 부분을 MSA로 구성하고 port 부분만 gateway로 구상할 수 있는가?<br>\nA : 맞다. 포트 부분만 열어놨기 때문에 그 부분만 때서 처리하기 용이하다.<br>\n게이트웨이는 MSA 포워딩 해주는 서비스라는 것이라고 질문자가 응답함</p>\n<p>Q : 초기 어플리케이션 개발에 핵사고날(포트 앤 어뎁터) 아키텍쳐를 적용하는 경우가 있는가?<br>\nA : 있다.</p>\n<p>Q : Nest.js + fsts를 사용한 참조하기 괜찮은 레포지토리가 있는가?<br>\nA : 내가 만들지 않아서 없다.</p>\n<p>Q : 여러 DB를 분산한 경우 데이터를 모을 때 어떤 방법을 사용하였는가?<br>\nA : 다양한 방식으로 해결할 수 있다.<br>\n중앙 코어(데이터팀)에서 각 디비를 찔러서(호출) 한번에 모든 데이터를 수집해서 빅데이터 등으로 모은 뒤 필요한 데이터를 가공하여 api로 제공함<br>\n다양한 방법을 사용하기도 한다.<br>\n정답은 없고 각자 방법이 다 다르다.</p>\n<br>\n<p>번외로 강사님이 재직했던 곳에서는 MSA 구성이 각 서버가 각자의 디비를 가지고 있는 형태였고,<br>\n데이터가 분산되어 있기에, 서로 소통하며 데이터를 주고받을 수 있는 이벤트 드리븐(도메인 드리븐) 아키텍처가 적용되어 있었다고 하심.<br>\n하지만 설계에 정답은 없다.</p>\n<p>긴 설명 이후 잠시 휴식 후 이제는 라이브 코딩으로…</p>\n<br>\n<h3 id=\"live-coding1--nestjs-로-프로젝트-아키텍처-구성하기\" style=\"position:relative;\"><a href=\"#live-coding1--nestjs-%EB%A1%9C-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"live coding1  nestjs 로 프로젝트 아키텍처 구성하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Live Coding1 : Nest.js 로 프로젝트 아키텍처 구성하기</h3>\n<p><a href=\"https://docs.nestjs.com\">Nest.Js 공식문서</a>를 참고하며 진행하였다.<br>\n먼저 <a href=\"https://docs.nestjs.com/#alternatives\">공식 레포</a>를 참고해서 프로젝트 셋업을 진행하였다.</p>\n<p>npm install 하여 설치하며 기다리는 중 깜짝질문이 나왔다.</p>\n<blockquote>\n<p><strong>package.json.lock</strong>은 왜 있는 것인가?</p>\n</blockquote>\n<p>나도 이 부분을 몰랐다 -0-;;<br>\n대충 찾아보니 조금 더 명확한 버전을 제공하기 위해서다.<br>\n쉽게 고정된 버전을 동일하게 쓰기 위함이다.</p>\n<p>Nest.js에 대해 깊게 파지는 않고, 아키텍쳐에 대해서 알아볼 예정이다.<br>\n이번 라이브코딩 코드는 <a href=\"https://github.com/Jun4928/wanted-pre-onboarding-challenge-BE-task-JAN.2023/tree/main/lecture-2\">lecture-2</a>를 참고하면 된다.</p>\n<p>오늘의 목표는 Member의 리스트를 조회하는 API 작성이다.<br>\n이번 라이브 코딩에서 디비를 직접 다루진 않고 메모리 샘플 데이터로 진행한다.</p>\n<br>\n<h4 id=\"메모리-디비\" style=\"position:relative;\"><a href=\"#%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%94%94%EB%B9%84\" aria-label=\"메모리 디비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>메모리 디비</h4>\n<p>아래 코드가 메모리 디비로 쓸 샘플코드다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">Member</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> bigint\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> MemoryDatabase <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> members <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      id<span class=\"token operator\">:</span> <span class=\"token number\">1n</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token string\">'J'</span><span class=\"token punctuation\">,</span>\n      email<span class=\"token operator\">:</span> <span class=\"token string\">'j@gmail.com'</span><span class=\"token punctuation\">,</span>\n      phone<span class=\"token operator\">:</span> <span class=\"token string\">'010-3333-4444'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> Member<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">findMembers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">Promise</span><span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>members<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>여기서 <strong>bigint</strong>가 등장하는데 javascript에서는 큰 수를 다룰 때 쓰는 것이라고 한다.(나도 처음봤다.)<br>\n근데 개념은 이해하는게 Java에서도 유저 값 고유 id는 uuid나 정수형 쓸 때 Long을 쓰긴 해서 javascript에는 number만 쓰는줄 알았었다.</p>\n<p>근데 이거를 실제로 쓰려면 미들웨어를 붙여서 컨버팅하고 해야 해서 이번 실습에서는 number 타입을 쓰는 것으로 했다.</p>\n<p><strong>findMembers</strong> 클로저 함수는 Promise를 반환하는데 <strong>member</strong>배열을 반환한다.</p>\n<br>\n<h4 id=\"controller\" style=\"position:relative;\"><a href=\"#controller\" aria-label=\"controller permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Controller</h4>\n<p>다음은 컨트롤러 영역이다.<br>\n강사님 회사의 코드 전략 중 하나는 파일에 하나의 클래스에 하나의 함수만 가지는게 원칙이 있는데 이를 적용했다.</p>\n<p>그래서 이번에 처럼 조회하는 함수를 만들면 다음과 같은 코드가 만들어진다.<br>\n파일명은 <strong>get-members.controller.ts</strong>를 사용하였다.</p>\n<p>나는 그냥 <strong>get.members.controller.ts</strong> 이런 유형인데 하이픈도 같이 쓰기도 하나보다…</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Controller<span class=\"token punctuation\">,</span> Get<span class=\"token punctuation\">,</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">,</span>\n  FindMembersInboundPort<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../inbound-port/find-members.inbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> MemoryDatabase <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'src/lib/memory-database'</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetMembersController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersInboundPort<span class=\"token operator\">:</span> FindMembersInboundPort\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/members'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 하고 서버를 실행시키고 접근해본다.</p>\n<blockquote>\n<p><a href=\"http://localhost:3000/members\">http://localhost:3000/members</a></p>\n</blockquote>\n<p>근데 404가 뜬다.</p>\n<p>이유는 간단하다.<br>\n위에서도 언급했다시피 어노테이션(데코레이터)만 붙인다고 되는게 아니다.</p>\n<p>Module에도 등록을 해줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//member.module.ts</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>GetMembersController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>근데 이렇게 등록을 해도 여전히 404가 뜬다.<br>\n이것도 위에서 본바와 같이 <strong>app.module.ts</strong>에서 등록을 해줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//app.module.ts</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  imports<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>MemberModule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>AppController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>AppService<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 의존관계를 추적해보면 <strong>main.ts</strong>부터 시작해본다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> NestFactory<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>AppModule<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">await</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>저기서 AppMododule로 가져와서 App을 생성하는데,<br>\n저 AppModule을 타면 <strong>imports</strong>에 <strong>MemberModule</strong>을 가져오고,<br>\n거기서 controllers를 보니 <strong>GetMembersController</strong> 컨트롤러를 선언한 것을 확인할 수 있다.</p>\n<p>이제는 위의 코드를 Port And Adapter Architecture로 바꿔보겠다.</p>\n<br>\n<h4 id=\"아키텍쳐-적용해보기-inbound-port-interface\" style=\"position:relative;\"><a href=\"#%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0-inbound-port-interface\" aria-label=\"아키텍쳐 적용해보기 inbound port interface permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아키텍쳐 적용해보기 (Inbound-Port interface)</h4>\n<p>이제는 메모리 디비의 값을 가져오는 것을 해보려 한다.<br>\n위 이론에서 언급한 <a href=\"https://elfinlas.github.io/til/230114_wanted_preon_back02/#ports-and-adapters-architecture\">내용</a>처럼 inbound-port를 만들기 위해 인터페이스를 하나 만든다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 인터페이스는 하나의 역할만 하는 것을 목표로 하는게 이 아키텍쳐의 목표다.<br>\n위 인터페이스의 이름처럼 멤버를 찾는 역할을 하는 목표만 가진다.</p>\n<p>이제 이 인터페이스를 채워보겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.inbound-port.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Member <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/memory-database'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortInputDto</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>Member<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'FIND_MEMBERS_INBOUND_PORT'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span> <span class=\"token comment\">//이 부분은 아래 서비스쪽에서 다룹니다.</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>코드를 설명 전 이 코드에 함정이 있다.<br>\n다른 분들도 못맞췄고, 나도 못맞췄다.</p>\n<p>정답은 아래 코드다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>Member<span class=\"token operator\">></span></code></pre></div>\n<p>여기서 Member는 inbound쪽 영역이 아닌 디비 영역에…즉 인프라 코드에 있는 것이다.<br>\n이렇게 되면 의존성이 깨져버린다.</p>\n<p>그래서 서비스 로직을 작성할 때 요점은 <strong>처음부터 디비나 각종 의존성을 제거하고 작성하는 것</strong>이다.</p>\n<p>그럼 이 로직을 어떻게 바꾸냐 하면…</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.inbound-port.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortInputDto</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'FIND_MEMBERS_INBOUND_PORT'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 타이핑으로 직접 처리를 하면 된다.<br>\n이게 단점이 될 수 있다.</p>\n<p>물론 중복된 코드가 많아질 수 있지만 이것을 감수해야 하는 게 이 아키텍쳐다.<br>\n이렇게 되면 엔티티와 별개로 DTO가 필요해진다.</p>\n<p>이 룰은 강한 룰이지만, 이렇게 하는 것이 필수는 아니며 교육 차원 및 이런 습관을 들이는 것이 중요하다.<br>\n나도 이 부분은 공감했고, 내 프로젝트에 이 룰을 적용하여 리팩토링을 진행해 봐야겠다고 생각이 들었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//DB Entity</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">Member</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> bigint\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//inbound port dto</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></code></pre></div>\n<p>이와 같이 코드가 분리될 경우 의존성은 없어지고, 완전한 분리가 되어 서로의 간섭이 없어지며 유지보수가 용이해진다.<br>\n이 부분은 트레이드 오프가 있는데 얻을 수 있는 것은 의존성 제거다.</p>\n<p>이렇게 함으로써 저 inboud-port 인터페이스는 의존성이 없게 되었다.</p>\n<p>다른 분이 좋은 의견을 주셨는데 이런 타입들을 외부에서 별도 모듈을 통해서 관리하고,<br>\n이 모듈을 임포트해서 저 port에서 가져와서 쓰는 것도 된다고 하셨다.</p>\n<p>근데 이렇게 될 경우 해당 모듈에 대한 의존성이 생기는 것이므로,<br>\n해당 모듈도 관리 포인트가 되고 의존성을 신경써 줘야 한다.(결국 또 등가교환이 이뤄진다.)</p>\n<p>개인적으론 그냥 강사님이 보여주신 의존성 제로 방식이 더 좋은 것 같다.<br>\n이제는 서비스 로직으로 들어간다.</p>\n<br>\n<h4 id=\"아키텍쳐-적용해보기-service\" style=\"position:relative;\"><a href=\"#%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0-service\" aria-label=\"아키텍쳐 적용해보기 service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아키텍쳐 적용해보기 (Service)</h4>\n<p>서비스는 아까 작성한 inbound-port를 구현해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.service.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FindMembersService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>아직 완성되지는 않았지만 대략 이런 형태로 구현이 될 것이다.<br>\n근데 이 코드에서도 함정이 있는데 바로 타입스크립트의 함정이다.</p>\n<p>(물론 이 코드는 완성된 결과물이 아니지만…)<br>\n이 코드에서 MemoryDatabase.findMembers() 함수가 리턴하는 값은 디비의 <strong>Member</strong>타입이고, 여기엔 id가 있다.<br>\n하지만 지금 반환을 보면 OutputDto고 여기엔 <strong>id</strong>값이 없다.</p>\n<p>이 부분은 <strong>Typescript</strong>의 **덕 타이핑(Duck Typing)**덕분에 에러가 안나고 넘어간다.<br>\n덕 타이핑은 간단하게 설명하면 일종의 동적 타이핑 종류이고, 구조적으로 타입이 맞기만 하면 에러 없이 허용을 한다.<br>\n이거는 나중에 따로 포스팅을 하면서 공부해봐야겠다.</p>\n<br>\n<p>이제 프로젝트를 구동하기 위해 위 서비스를 주입해야 하는데<br>\n서비스 자체를 주입하는건가? 포트를 주입하는 건가를 햇갈릴 수 있다.</p>\n<p>물론 정답은 포트다.<br>\n포트를 통해서만 호출하기 때문이다.</p>\n<p>의존성 주입을 해야 하는데 Nest.js에서는 생성자 주입을 많이 사용한다.<br>\n컨트롤러에 서비스 로직을 주입할 때는 아래 코드와 같이 작성된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetMembersController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersInboundPort<span class=\"token operator\">:</span> FindMembersInboundPort\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/members'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 생성자를 보면 **@Inject()**라는 데코레이터가 사용되었는데 이게 의존성 주입 역할을 해준다.<br>\n저 데코레이터에 전달된 값이 아까 이론에서 <a href=\"https://elfinlas.github.io/til/230114_wanted_preon_back02/#dependency-injection\">언급</a>했던 토큰이다.</p>\n<p>이제 위의 <a href=\"https://elfinlas.github.io/til/230114_wanted_preon_back02/#%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0-service\">서비스</a> 설명 중 포트 인터페이스 코드가 어디에 어떤 역할인이 알 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'FIND_MEMBERS_INBOUND_PORT'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span></code></pre></div>\n<p>그럼 여기서 의문이 들 것이다.<br>\n아까 <strong>Module</strong>설명을 할 때 Provider에서 토큰과 클래스가 있었는데 어떻게 적용해야 하는가?</p>\n<p>아래 코드를 보면서 설명한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//Member Module</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./inbound-port/find-members.inbound-port'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FindMembersService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./service/find-members.service'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n      provide<span class=\"token operator\">:</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">,</span>\n      useClass<span class=\"token operator\">:</span> FindMembersService<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>여기서 중요한 것은 useClass에는 Port interface가 아닌 해당 Port를 구현한 구현체가 작성된 점이다.<br>\nNest.js에게 이런 토큰 **(FIND_MEMBERS_INBOUND_PORT)**을 찾으면 해당 구현체는 FindMembersService 라고 말해주는 것이다.</p>\n<p>그리고 의존성 주입을 할 때는 아래와 같이 토큰만 주입을 받는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersInboundPort<span class=\"token operator\">:</span> FindMembersInboundPort<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 되면 Nest.js는 토큰을 본 다음에 실제 구현체인 FindMembersService를 가져와서 주입해준다.<br>\n토큰을 쓰게 되면 <strong>추상화 된 개체들(인터페이스 구현체 및 기타 구현체)을 쓸 때 식별자로 사용</strong>이 가능해진다.</p>\n<p>근데…스프링은 이걸 아주 옛날에 이런 개념을 적용했는데…<br>\n역시 <strong>Spring</strong>은 정말 잘 만들어진 프레임워크인것 같다는 생각이 다시금 들었다.<br>\n특히 위 방식도 **@Qualifier()**에서 이미 사용한 방식이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">//Java sample</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyData</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"userData\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">UserData</span> userData<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Java spring에서는 이런식으로 가끔 사용했었다.</p>\n<p>다시 원점으로 돌아와서…<br>\nNest.js에게 이 토큰으로 식별하여 찾을 경우 useClass가 가리키는 객체를 인스턴스화 해서 사용해 달라는 것이다.</p>\n<br>\n<p>다시 돌아와서…<br>\n실제 컨트롤러의 호출단은 다음과 같이 바꿀 수 있게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// import { MemoryDatabase } from 'src/lib/memory-database'</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/members'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>findMembersInboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//return MemoryDatabase.findMembers()</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 되면 컨트롤러에서 메모리 디비에 대한 의존성도 사라진다.<br>\n여기까지 코드와 내용을 보면 각 영역마다의 의존도가 없다는 것을 알 수 있다.</p>\n<p>컨트롤러 코드를 다시 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//get-members.controller.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Controller<span class=\"token punctuation\">,</span> Get<span class=\"token punctuation\">,</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">,</span>\n  FindMembersInboundPort<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../inbound-port/find-members.inbound-port'</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetMembersController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersInboundPort<span class=\"token operator\">:</span> FindMembersInboundPort\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/members'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>findMembersInboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 서비스 로직은 찾아볼 수 없다.<br>\n다 각자 분리가 되어 있음을 알 수 있다.</p>\n<p>그런데 어떤 분이 의견을 주셨는데 이 구조를 사용하면 파일 갯수가 엄청 늘어나지 않는가? 였다.<br>\n강사님이 좋은 말씀을 주셨다.</p>\n<blockquote>\n<p>맞는 말이다.<br>\n그런데 코드 하나에 엄청난 라인을 자랑하는 방식을 사용할 것인지…아니면 짧은 라인의 코드를 가진 복수의 파일 방식을 사용할 것인지?</p>\n</blockquote>\n<p>난 당연 후자였다.<br>\n무튼 실행을 하면 데이터가 잘 나오는데 덕타이핑 덕분에 id도 그대로 노출이 된다.</p>\n<p>이제는 서비스 로직을 보고 개선해나갈 차례다.<br>\n아래가 서비스 로직이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.service.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FindMembersService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기도 보면 MemoryDatabase.findMembers()로 직접 호출을 하는데 이 의존도를 끊어보겠다.<br>\n이제는 outboud-port와 adapter를 만들어준다.</p>\n<p>outbound-port도 동일하게 작성을 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.outbound.port.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersOutboundPortInputDto</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersOutboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'FIND_MEMBERS_OUTBOUND_PORT'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">FindMembersOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersOutboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersOutboundPortOutputDto<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그리고 아까 컨트롤러에 주입했던 것처럼 서비스에도 outbound-port를 주입해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.service.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  FindMembersInboundPort<span class=\"token punctuation\">,</span>\n  FindMembersInboundPortInputDto<span class=\"token punctuation\">,</span>\n  FindMembersInboundPortOutputDto<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../inbound-port/find-members.inbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span><span class=\"token punctuation\">,</span>\n  FindMembersOutboundPort<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../outbound-port/find-members.outbound-port'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FindMembersService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersOutboundPort<span class=\"token operator\">:</span> FindMembersOutboundPort\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>findMembersOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>이렇게 되면 메모리 쪽의 의존도를 끊을 수 있게 되었다.<br>\n하지만 아직 <strong>FindMembersOutboundPort</strong>의 구현체가 없기 때문에 이를 만들어준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.repository.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  FindMembersOutboundPort<span class=\"token punctuation\">,</span>\n  FindMembersOutboundPortInputDto<span class=\"token punctuation\">,</span>\n  FindMembersOutboundPortOutputDto<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../outbound-port/find-members.outbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> MemoryDatabase <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/memory-database'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FindMembersRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersOutboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersOutboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>당연한 이야기겠지만 해당 구현체에서는 메모리 의존을 해도 된다.<br>\n근데 outbound-port에서 dto에는 id가 없기에 타입에 맞춰서 반환 값을 바꿔준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersOutboundPortInputDto<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersOutboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">const</span> members <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> members<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> member<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n        email<span class=\"token operator\">:</span> member<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span>\n        phone<span class=\"token operator\">:</span> member<span class=\"token punctuation\">.</span>phone<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그리고 module에 선언을 해줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//member-module.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Module <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> GetMembersController <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./controller/get-members.controller'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./inbound-port/find-members.inbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FindMembersService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./service/find-members.service'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./outbound-port/find-members.outbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FindMembersRepository <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./outbound-adapter/find-members.repository'</span>\n\n<span class=\"token comment\">// 오늘 할 것: member 의 리스트를 조회하는 API 작성</span>\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>GetMembersController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// inbound-port</span>\n    <span class=\"token punctuation\">{</span>\n      provide<span class=\"token operator\">:</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">,</span>\n      useClass<span class=\"token operator\">:</span> FindMembersService<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token comment\">// outbound-port</span>\n    <span class=\"token punctuation\">{</span>\n      provide<span class=\"token operator\">:</span> <span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span><span class=\"token punctuation\">,</span>\n      useClass<span class=\"token operator\">:</span> FindMembersRepository<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기까지 하면 Port and adapter 아키텍쳐를 적용한 모습이다.</p>\n<p>서비스 로직이나 디비를 가져오는 리파지토리 로직에 대해 테스트 코드 작성도 쉽고, 코드 자체도 간결에서 읽기 편하다.<br>\n여기까지 하고 나니 내가 짠 코드는 벌레같은 코드였구나 라는 생각이 들 정도였다.</p>\n<br>\n<h4 id=\"테스트-코드-작성\" style=\"position:relative;\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\" aria-label=\"테스트 코드 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>테스트 코드 작성</h4>\n<p>이 부분은 강의를 듣다가 단순 코드를 작성하는 부분이 많아서 <a href=\"https://github.com/Jun4928/wanted-pre-onboarding-challenge-BE-task-JAN.2023/blob/main/lecture-2/src/member/service/find-members.service.spec.ts\">Github 코드</a> 및 아래 테스트 코드로 대체한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FindMembersService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./find-members.service'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  FindMembersOutboundPort<span class=\"token punctuation\">,</span>\n  FindMembersOutboundPortInputDto<span class=\"token punctuation\">,</span>\n  FindMembersOutboundPortOutputDto<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../outbound-port/find-members.outbound-port'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MockFindMembersOutboundPort</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> result<span class=\"token operator\">:</span> FindMembersOutboundPortOutputDto\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>result<span class=\"token operator\">:</span> FindMembersOutboundPortOutputDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> result\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersOutboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersOutboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>result\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'FindMembersService Spec'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'멤버 리스트를 반환한다.'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> member <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span>\n        email<span class=\"token operator\">:</span> <span class=\"token string\">'A@gmail.com'</span><span class=\"token punctuation\">,</span>\n        phone<span class=\"token operator\">:</span> <span class=\"token string\">'0103123123'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">const</span> findMemberService <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FindMembersService</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">new</span> <span class=\"token class-name\">MockFindMembersOutboundPort</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> findMemberService<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toStrictEqual</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span>\n        email<span class=\"token operator\">:</span> <span class=\"token string\">'A@gmail.com'</span><span class=\"token punctuation\">,</span>\n        phone<span class=\"token operator\">:</span> <span class=\"token string\">'0103123123'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>아까 서비스 로직을 보면 <strong>@inject</strong>를 제외한 어느 곳에서도 Nest.js의 기능을 사용하지 않고, 순수 Typescript로 구성되어 있음을 알 수 있다.<br>\n이는 테스트 코드를 작성할 때 Nest.js에 대한 의존이 낮다는 것을 의미한다.</p>\n<p>그리고 보통 단위 테스트 등을 할 때 디비에 대한 의존도가 있을 수 있는데, 이렇게 할 경우 독립적으로 테스트가 가능하다.</p>\n<br>\n<h4 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h4>\n<p>마지막 항목인 <strong>4. Live Coding2 : 사전과제 로직 함께 리팩토링 하기</strong>는 시간이 없어서 다음 강의에 다루기로 하였다.</p>\n<p>그리고 수강생들의 질의가 이것저것 많았는데 그 중 하나가 아래였다.</p>\n<p>Q : 포트 아키텍쳐 단점</p>\n<ol>\n<li>타이핑이 많아진다.</li>\n<li>모듈간의 의존성 관리가 아렵다(모든 아키텍쳐의 공통점)</li>\n</ol>\n<p>사실 타이핑이 많은게 나은 것 같다.</p>\n<p>그리고 강사님의 정리 내용을 요약하자면…</p>\n<ul>\n<li>어떤 아키텍쳐가 정답이 없다.</li>\n<li>선택한 아키텍쳐에 대한 이해도와 필요성, 숙련도에 따라 적용하면 된다.</li>\n<li>핵사곤 아키텍쳐라고 하기도 하는데 이건 더 어렵기에 포트 앤 어뎁터로 준비했다.</li>\n</ul>\n<p>강의는 3시간 밖에 안되었는데 내가 쓴 엉망 필기체 및 요약본…그리고 노션에 정리한 코드 및 url 등을 다 따서 복습을 해보니…<br>\n이거 또한 일인듯 했다…</p>\n<p>안그래도 흑우집합소 개발에 매진해야 했지만, 아무래도 너무 시간을 지체했었고,<br>\n한번 적용해봐야지 라는 생각에 시작했는데 아무래도 다음 강의 자료는 금방 할 수 없을 듯 하다.</p>\n<p>참고로 아직 함수형 프로그래밍은 나오지 않았고, 함수형을 위한 빌드업 과정이었다.<br>\n강의를 정리하면서 들으니 내용을 흘려 들은게 많아서 자세히 이해할 수 없었지만,<br>\n정리하면서 보니 이제는 그 흐름이나 맥락이 이해되었다.</p>\n<p>사실 이번 백엔드 강의는 나에게 너무 유익했던 시간이고, 소중한 내용을 배울 수 있어서 좋았다.<br>\n지금 <strong>이펙티브 타입스크립트</strong>책 내용 정리 포스팅도 준비중이긴 한데 일단 이 강의 내용 정리부터 하고 또 해봐야겠다.</p>\n<p>다음 강의 정리는 준비되는 대로 포스팅 하도록 하겠다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EA%B0%95%EC%82%AC%EB%8B%98%EC%9D%98-%EC%9D%B4%EC%95%BC%EA%B8%B0-%EC%8B%9C%EA%B0%84\">강사님의 이야기 시간</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%8B%A4%EB%AC%B4-%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EB%B9%8C%EB%93%9C%EC%97%85\">실무 함수형 프로그래밍 빌드업</a></p>\n<ul>\n<li>\n<p><a href=\"#nestjs-%EC%A3%BC%EC%9A%94-%EC%BB%A8%EC%85%89\">Nest.js 주요 컨셉</a></p>\n<ul>\n<li><a href=\"#controllers\">Controllers</a></li>\n<li><a href=\"#providers\">Providers</a></li>\n<li><a href=\"#modules\">Modules</a></li>\n<li><a href=\"#dependency-injection\">Dependency Injection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#architectures\">Architectures</a></p>\n<ul>\n<li><a href=\"#layered-architecture%EC%9D%98-%ED%95%9C%EA%B3%84\">Layered Architecture의 한계</a></li>\n<li><a href=\"#layered-architecture%EC%9D%98-%EC%A7%84%ED%99%94-port-and-adapter-architecture\">Layered Architecture의 진화 (Port and Adapter Architecture)</a></li>\n<li><a href=\"#interface\">Interface</a></li>\n<li><a href=\"#ports-and-adapters-architecture\">Ports and Adapters Architecture</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%88%98%EC%97%85-%EC%A4%91%EA%B0%84-%EC%A7%88%EB%AC%B8\">수업 중간 질문</a></p>\n</li>\n<li>\n<p><a href=\"#live-coding1--nestjs-%EB%A1%9C-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\">Live Coding1 : Nest.js 로 프로젝트 아키텍처 구성하기</a></p>\n<ul>\n<li><a href=\"#%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%94%94%EB%B9%84\">메모리 디비</a></li>\n<li><a href=\"#controller\">Controller</a></li>\n<li><a href=\"#%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0-inbound-port-interface\">아키텍쳐 적용해보기 (Inbound-Port interface)</a></li>\n<li><a href=\"#%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0-service\">아키텍쳐 적용해보기 (Service)</a></li>\n<li><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\">테스트 코드 작성</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2023.02.07","title":"23년 1월 원티드 프리온보딩 백엔드 2일차 TIL (실무 함수형 프로그래밍 빌드업) (Wanted Pre Onboarding BackEnd)","categories":"til","emoji":"📜"},"fields":{"slug":"/til/230114_wanted_preon_back02/"}},"site":{"siteMetadata":{"siteUrl":"https://elfinlas.github.io","comments":{"utterances":{"repo":"elfinlas/blog_utterances"}},"projects":[{"title":"마와셀(웹) - 와인 가격 비교","description":"와인 가격 비교 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223393940649","github":"","web":"https://appmyc.info","googlePlay":"","appStore":""}},{"title":"마와셀(엡) - 와인과 셀러 관리, 시음노트","description":"보유한 와인의 관리, 시음노트 작성, 보유 와인 셀러의 관리 어플리케이션","techStack":["Dart","Flutter","hive","provider"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223531933037","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.myc","appStore":"https://itunes.apple.com/kr/app/apple-store/6474965246"}},{"title":"흑우집합소(웹) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223059966682","github":"","web":"https://bcow.world/","googlePlay":"","appStore":""}},{"title":"흑우집합소(앱) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Dart","Flutter","drift","provider"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223232966579","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.bcow_world","appStore":"https://itunes.apple.com/kr/app/apple-store/6470312130"}}]}}},"pageContext":{"slug":"/utils/230203_web_carbon/","nextSlug":"/nest_js/230203_r2_nestjs/","prevSlug":"/til/230114_wanted_preon_back02/"}},"staticQueryHashes":["1186322783","1321405810","3649515864"]}
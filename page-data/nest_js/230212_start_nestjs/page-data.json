{"componentChunkName":"component---src-templates-post-template-index-tsx","path":"/nest_js/230212_start_nestjs/","result":{"data":{"cur":{"id":"44351d83-6a48-55ee-95b1-afeec6de3875","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQoz5VSTUsCURT1X7TqY9O+VbRQIdpWizZCqxb1A4JWBS3cFAgtIspNiyCCoEVBRWJJQhqWFbop6GNg+nJSEccZ5+PNeyfm6ehIRnbgvHfhvXvu4d7rAQBGKacbjDFOd/wXbXicwIEliND2I+2F7cKu2Hl3//VwkVwe8nwIBV8AheFJFPwBkCeh1bFFWxL5TazarVTBTFJzaB/y4gqkXh+kHi9y3V4Ux2c47UK0okDd3IW2dwwzcw8jcQ395BzGVQba4RnIo4DK8gas14+mIJUrYFUNRjyFr4FRSP0jyHUNwkikQWUFcnAV+mmCF5YXQjBvstAjcZRng1y0srQOWizVe2jVbBupO6jhbZSm5iD1+ZEfmgARRDC1Cu0oBjOdhXF5C+0gCj2W5I5sUfLwDD16Aevtsy5Ia/0gLyLU8A6UtS0Ux6ZhJNMtze8EjaG4J2WJ76Bluf26UNaYtGPEWbkfa8M/EdKs5iT+gw3BX3eNtbrvBN9Ty+sRGu0ozQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7685b7a900370c34be4e657df3f862d/7c297/thumbnail_nestjs.webp 180w,\n/static/b7685b7a900370c34be4e657df3f862d/33ecc/thumbnail_nestjs.webp 360w,\n/static/b7685b7a900370c34be4e657df3f862d/84c6d/thumbnail_nestjs.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7685b7a900370c34be4e657df3f862d/e9ea2/thumbnail_nestjs.png 180w,\n/static/b7685b7a900370c34be4e657df3f862d/53918/thumbnail_nestjs.png 360w,\n/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"nestjs-프로젝트-만들어보기\" style=\"position:relative;\"><a href=\"#nestjs-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"nestjs 프로젝트 만들어보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nest.Js 프로젝트 만들어보기</h1>\n<p>이번에는 Nest.Js 프로젝트 시작하는 포스팅을 준비했다.<br>\n워낙 기초적인 내용이고, 별로 설명할 것도 없으며 공식 홈페이지에 상세히 나와있지만…<br>\n내가 또 프로젝트 셋업할 때 잊을까봐 남겨두는 포스팅이다.</p>\n<p>진행은 MacOS에서 했다.</p>\n<h2 id=\"nestjs-설치\" style=\"position:relative;\"><a href=\"#nestjs-%EC%84%A4%EC%B9%98\" aria-label=\"nestjs 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nest.Js 설치</h2>\n<p>크게 두 가지 방법이 있다.<br>\n하나는 그냥 npm이나 yarn 등으로 cli를 받은 다음 설치하는 법과 Github 클론 방식이 있다.</p>\n<br>\n<h3 id=\"npm-yarn-설치\" style=\"position:relative;\"><a href=\"#npm-yarn-%EC%84%A4%EC%B9%98\" aria-label=\"npm yarn 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Npm (Yarn) 설치</h3>\n<p>Npm이나 Yarn이 설치되어 있다면 너무 간단하다.<br>\n프로젝트를 시작할 디렉토리에서 아래의 명령어를 입력해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># 단일 프로젝트 설치 시\n> yarn add @nestjs/cli\n\n# 글로벌 사용 시\n> yarn global add @nestjs/cli</code></pre></div>\n<p>나는 개인적으로 글로벌 설치를 안좋아해서 단일 프로젝트 방식으로 설치했다.<br>\n이렇게 하면 프로젝트 디렉토리 내에 <strong>node_modules</strong>, <strong>package.json</strong>, <strong>yarn.lock</strong> 파일과 디렉토리가 생긴다.</p>\n<p>여기서 아래와 같이 Next.Js를 설치해주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># 단일 프로젝트 설치 시\n> yarn nest new [프로젝트 이름]\n> yarn nest new NextJsExam\n\n# 글로벌 설치 방법 시\n> nest new NestJsExam</code></pre></div>\n<p>만약 자신이 특정 디렉토리에서 Nest.Js를 시작하길 원한다면 프로젝트 이름에 특정 디렉토리를 적어주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> yarn nest new ./Exam/UserExam01</code></pre></div>\n<p><strong>new</strong> 명령어를 통해 프로젝트를 생성하면 아래와 같이 진행된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 578px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQY022PzU7CUBBGeRgFCxav3F4uLW3pf22lgIimEqML9SmUJSY+9TGtyoK4OJlv852Z6ZjKp1zULDZP1PWK4HWP9/aF+/KJtf1APry3WNsd6nnPMCgRY42cRFh2hDEcc9of0Tu36A4knYGwmSUVfjInzivsqELYCXKaIac5yrv6yU6KmCQIHSCUi1Bey1BOaRyNrJF2mnAhfbSbYjkxtp/h+BnaTbDsEOVEeGHB2E05MxWGqdp5zEFoCEV2WxKXK9JyQza/I8xXxMWa9HqDUD5SB/R1QFdM6PZHbfmYw8umpUm2M6KyYn7zSLGsCbMleXVPUqzb7SfGZSvq/Rb/4+/Cb8CvqP0aUiiVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7bf08e99d0ab6c04c216a00fffbb0875/7c297/img01.webp 180w,\n/static/7bf08e99d0ab6c04c216a00fffbb0875/33ecc/img01.webp 360w,\n/static/7bf08e99d0ab6c04c216a00fffbb0875/9cd87/img01.webp 578w\"\n              sizes=\"(max-width: 578px) 100vw, 578px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7bf08e99d0ab6c04c216a00fffbb0875/e9ea2/img01.png 180w,\n/static/7bf08e99d0ab6c04c216a00fffbb0875/53918/img01.png 360w,\n/static/7bf08e99d0ab6c04c216a00fffbb0875/8c7b4/img01.png 578w\"\n            sizes=\"(max-width: 578px) 100vw, 578px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7bf08e99d0ab6c04c216a00fffbb0875/8c7b4/img01.png\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>설치되기 앞서 먼저 npm 또는 yarn 그리고 pnpm 중 어느 패키지 메니저를 사용할지 물어본다.<br>\n자신이 원하는 것을 정하면 각종 Nest.Js를 구동하기 위한 파일들이 설치된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 419px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAUlEQVQ4y3VTWXajQAzkLl7ZDL2xQ7PZxo6dxZnJm/tfpOa1CImd2B+FpEaIUkltrX2J7qNB9Vyj2b1i9/QH2+M72W54Q398R14f0B8u2J8/0B/e4fMMC4dj5clfsFa+hGoyiDKHyjrExRZR0RNMHOUdZNogLnqCSBssXXG3GBVcegK+KJAUe/o4ynsEqoTKO2R6wEbksDcR5jbHbBV+MXtU1Fq7AmlSQWbtJ8OxoExbxOUWKmvBIo0gSeEwifmafRUz9mdhK+QC/55SFO2JdDLatftXNLsXdIcL2sHo+hfN8YSyP0D3zwhV9VhDeyMRiJhac8OEDp0gpjYN1n5E526YwmMZsbc38eOWzUdmivX2DJW2EEmNQBbEYGppaXyH09nCYXeLTWeWeXhhQqwMJqZTwsKVmDuC7OiP8YSZbX56PWVX3LBZfDIx/tzhCEOJWCkIrsCYhJJqhFCIpEJRRFh53zWse9SNDDzS2MgSaaaxa1sUhYbWHVrdQJcaTaXJ77YdRKJJW9OZ9VODyV/7ihICVSGIatpVnjRgcQNflNjICmFUU2zyxgGq3wynKZN+kxRXQ7m2BJffSGaNWgnMbUYvZjZHzhM09YB2eKOrqPszbYLZz6o/U1x2J0I3XOgCLGz2PWUmFN3XUJU0ZXMFPZZSAu0hSyk2uPHD0ZqOprX5D3f3wRi3wB7rAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c4ab0db863a9c60b15838ec15772c17e/7c297/img02.webp 180w,\n/static/c4ab0db863a9c60b15838ec15772c17e/33ecc/img02.webp 360w,\n/static/c4ab0db863a9c60b15838ec15772c17e/82ebf/img02.webp 419w\"\n              sizes=\"(max-width: 419px) 100vw, 419px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c4ab0db863a9c60b15838ec15772c17e/e9ea2/img02.png 180w,\n/static/c4ab0db863a9c60b15838ec15772c17e/53918/img02.png 360w,\n/static/c4ab0db863a9c60b15838ec15772c17e/96e9b/img02.png 419w\"\n            sizes=\"(max-width: 419px) 100vw, 419px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c4ab0db863a9c60b15838ec15772c17e/96e9b/img02.png\"\n            alt=\"img02\"\n            title=\"img02\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>설치가 다 되면 테스트를 해본다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 662px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA60lEQVQY01XDy26CQBiAUR6mLrAqCM6FnxkYbqICpmmtvoAxXfT9t1/XPcmJQnflvDw4L1f05y/J9CKdXySXJ+nlSTL/oJYn36dA5y1xZtmkwlucsYpzVuv/o2KoKU81KnisdOTao2yN+B5tA3GyxzlFKAyusJgg6L7E9CXF0bF3Be8Hze6gSVJFJIujvQVk9LTjF66dqIcr43InDB9sjGWaKh5Hx60vGeeK5t7gLhV+rmi7kswatkqT7BXR0A6oXsi9YNyRvGhQ0iH1CS0960xT1ULvLEEspS84NCUqCHklmFrIxbI1hkQb/gDgQIjfOaRKCAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fa4ed8d88ca20c07ab5e2f1a8ea37061/7c297/img03.webp 180w,\n/static/fa4ed8d88ca20c07ab5e2f1a8ea37061/33ecc/img03.webp 360w,\n/static/fa4ed8d88ca20c07ab5e2f1a8ea37061/82a5e/img03.webp 662w\"\n              sizes=\"(max-width: 662px) 100vw, 662px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fa4ed8d88ca20c07ab5e2f1a8ea37061/e9ea2/img03.png 180w,\n/static/fa4ed8d88ca20c07ab5e2f1a8ea37061/53918/img03.png 360w,\n/static/fa4ed8d88ca20c07ab5e2f1a8ea37061/46b67/img03.png 662w\"\n            sizes=\"(max-width: 662px) 100vw, 662px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fa4ed8d88ca20c07ab5e2f1a8ea37061/46b67/img03.png\"\n            alt=\"img03\"\n            title=\"img03\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>이렇게 서버가 올라간 것을 확인할 수 있고, 브라우저에서 접근하면 아래와 같이 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.444444444444445%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZUlEQVQI1z2KQQrDMBAD8/+H9QO9FlJKKI7t1drrB0xw2uQgpJG0pP2LcsOLExp0DUJBt6ArznxpdvMT9uOhQU1G2jKvVTyeO8vnveFqyJzmQbW4WdbOPNW8Y1V/t/tz7SVlPBcO18iXH9JIT9YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/38e36a20831e7a977870fb24a1399a35/7c297/img04.webp 180w,\n/static/38e36a20831e7a977870fb24a1399a35/33ecc/img04.webp 360w,\n/static/38e36a20831e7a977870fb24a1399a35/df77d/img04.webp 720w,\n/static/38e36a20831e7a977870fb24a1399a35/5c666/img04.webp 1080w,\n/static/38e36a20831e7a977870fb24a1399a35/ea084/img04.webp 1144w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/38e36a20831e7a977870fb24a1399a35/e9ea2/img04.png 180w,\n/static/38e36a20831e7a977870fb24a1399a35/53918/img04.png 360w,\n/static/38e36a20831e7a977870fb24a1399a35/242a6/img04.png 720w,\n/static/38e36a20831e7a977870fb24a1399a35/b4ad3/img04.png 1080w,\n/static/38e36a20831e7a977870fb24a1399a35/b1620/img04.png 1144w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/38e36a20831e7a977870fb24a1399a35/242a6/img04.png\"\n            alt=\"img04\"\n            title=\"img04\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>만약 Stric모드 활성화를 하려면 <strong>—strict</strong>옵션을 주면된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> yarn nest new NextJsExam --strict</code></pre></div>\n<br>\n<h3 id=\"github-clone-설치\" style=\"position:relative;\"><a href=\"#github-clone-%EC%84%A4%EC%B9%98\" aria-label=\"github clone 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Github clone 설치</h3>\n<p>git 명령어 중 clone을 통해서 생성하는 법이 있다.<br>\n아래의 명령어를 참고하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ git clone https://github.com/nestjs/typescript-starter.git project\n$ cd project\n$ npm install\n$ npm run start</code></pre></div>\n<p>저기서 <strong>project</strong>는 자신의 디렉토리를 지정해주면 된다.</p>\n<br>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>Nest.Js의 경우 Typescript를 기본으로 사용한다.<br>\n더 자세한 설명이 필요한 경우 <a href=\"https://docs.nestjs.com\">공식 페이지</a>를 참고하자.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#nestjs-%EC%84%A4%EC%B9%98\">Nest.Js 설치</a></p>\n<ul>\n<li><a href=\"#npm-yarn-%EC%84%A4%EC%B9%98\">Npm (Yarn) 설치</a></li>\n<li><a href=\"#github-clone-%EC%84%A4%EC%B9%98\">Github clone 설치</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n</li>\n</ul>\n</div>","excerpt":"Nest.Js 프로젝트 만들어보기 이번에는 Nest.Js 프로젝트 시작하는 포스팅을 준비했다. 워낙 기초적인 내용이고, 별로 설명할 것도 없으며 공식 홈페이지에 상세히 나와있지만… 내가 또 프로젝트 셋업할 때 잊을까봐 남겨두는 포스팅이다. 진행은 MacOS에서 했다. Nest.Js 설치 크게 두 가지 방법이 있다. 하나는 그냥 npm이나 yarn 등으로 cli를 받은 다음 설치하는 법과 Github 클론 방식이 있다. Npm (Yarn) 설치 Npm이나 Yarn이 설치되어 있다면 너무 간단하다. 프로젝트를 시작할 디렉토리에서 아래의 명령어를 입력해준다. 나는 개인적으로 글로벌 설치를 안좋아해서 단일 프로젝트 방식으로 설치했다. 이렇게 하면 프로젝트 디렉토리 내에 node_modules, package.json, yarn.lock 파일과 디렉토리가 생긴다. 여기서 아래와 같이 Next.Js를 설치해주면 된다. 만약 자신이 특정 디렉토리에서 Nest.Js를 시작하길 원한다면 프로젝트 …","frontmatter":{"date":"2023.02.12","title":"Nest.Js 프로젝트 생성하기","categories":"nest_js","emoji":"📜"},"fields":{"slug":"/nest_js/230212_start_nestjs/"}},"next":{"id":"eb5a0c14-bca6-532f-a448-ef59fa31abec","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQoz5VSTUsCURT1X7TqY9O+VbRQIdpWizZCqxb1A4JWBS3cFAgtIspNiyCCoEVBRWJJQhqWFbop6GNg+nJSEccZ5+PNeyfm6ehIRnbgvHfhvXvu4d7rAQBGKacbjDFOd/wXbXicwIEliND2I+2F7cKu2Hl3//VwkVwe8nwIBV8AheFJFPwBkCeh1bFFWxL5TazarVTBTFJzaB/y4gqkXh+kHi9y3V4Ux2c47UK0okDd3IW2dwwzcw8jcQ395BzGVQba4RnIo4DK8gas14+mIJUrYFUNRjyFr4FRSP0jyHUNwkikQWUFcnAV+mmCF5YXQjBvstAjcZRng1y0srQOWizVe2jVbBupO6jhbZSm5iD1+ZEfmgARRDC1Cu0oBjOdhXF5C+0gCj2W5I5sUfLwDD16Aevtsy5Ia/0gLyLU8A6UtS0Ux6ZhJNMtze8EjaG4J2WJ76Bluf26UNaYtGPEWbkfa8M/EdKs5iT+gw3BX3eNtbrvBN9Ty+sRGu0ozQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7685b7a900370c34be4e657df3f862d/7c297/thumbnail_nestjs.webp 180w,\n/static/b7685b7a900370c34be4e657df3f862d/33ecc/thumbnail_nestjs.webp 360w,\n/static/b7685b7a900370c34be4e657df3f862d/84c6d/thumbnail_nestjs.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7685b7a900370c34be4e657df3f862d/e9ea2/thumbnail_nestjs.png 180w,\n/static/b7685b7a900370c34be4e657df3f862d/53918/thumbnail_nestjs.png 360w,\n/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"jwt를-원래-쓰고-있었지만\" style=\"position:relative;\"><a href=\"#jwt%EB%A5%BC-%EC%9B%90%EB%9E%98-%EC%93%B0%EA%B3%A0-%EC%9E%88%EC%97%88%EC%A7%80%EB%A7%8C\" aria-label=\"jwt를 원래 쓰고 있었지만 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JWT를 원래 쓰고 있었지만…</h1>\n<p>전에도 썼었고, 지금도 쓰고 있는 JWT<br>\nJWT에 대한 개념적인 것은 넘어가고, Nest.js에서 JWT를 쓰는 방법에 대해서 포스팅 해보려 한다.</p>\n<p>사실 JWT를 그냥 쓰면 안되고, 몇 가지 기본적인 정책이나 알아야 할 점이 있지만,<br>\n이번 포스팅에서는 Nest.js에서 <strong>JWT를 생성</strong>하는 것에 포커스를 두려 한다.</p>\n<p>JWT에 대해서는 아주 예전에 포스팅을 했었다.<br>\nJWT의 이론적인 부분이 궁금한 분은 <a href=\"https://elfinlas.github.io/basic_know/180812_what_is_jwt/\">JWT 포스팅</a>을 참고해주시길…</p>\n<p>이와 관련한 코드는 <a href=\"https://github.com/elfinlas/NestJsJwt\">Github</a>에 등록하였다.<br>\n일단 메인 브런치인데 향후 Part별로 브런치를 나누거나, 커밋으로 할 예정이다.<br>\n이와 관련한 것은 향후 다시 업데이트 예정이다.</p>\n<h2 id=\"nestjs에서-jwt-사용하기\" style=\"position:relative;\"><a href=\"#nestjs%EC%97%90%EC%84%9C-jwt-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"nestjs에서 jwt 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nest.js에서 JWT 사용하기</h2>\n<p>본격적으로 설명에 앞서 위에 언급한 것처럼…<br>\n이번 포스팅에서는 Nest.js에서 JWT를 생성하는 것에 포커스를 둔 코드다.<br>\n그래서 약간 코드가 엉성할 수 있다.</p>\n<p>하지만 어떻게 사용해서 적용하는지를 볼 수 있는 예제성 코드다.<br>\n이 부분은 감안해서 봐주시길 바란다.</p>\n<p>구성은 controller에서 Url 호출하면 JWT 생성 서비스를 호출해서 반환하는 형태로 되어 있다.<br>\n<a href=\"https://github.com/elfinlas/NestJsJwt\">Github</a>에서 클론을 받아서 사용해도 되고,<br>\n각 코드를 보면서 참고해도 된다.</p>\n<h3 id=\"패키지-설치\" style=\"position:relative;\"><a href=\"#%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98\" aria-label=\"패키지 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>패키지 설치</h3>\n<p>먼저 아래와 같은 패키지를 설치해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> yarn add @nestjs/jwt</code></pre></div>\n<p>이 패키지는 Nest.js에서 제공하는 패키지이며, JWT 조작을 하는데 도음을 주는 유틸리티 패키지다.<br>\n사실 JWT 전략이나 좀 더 편리하게 쓰기 위해서는 <strong>passport-jwt</strong>를 설치해야 하는데 이는 <strong>Part2</strong>에서 다룰 예정이다.</p>\n<p>일단 예제를 돕기 위해 <strong>auth</strong>라는 도메인으로 빼고 모듈로 나눴다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVQoz32SDY+cIBiE/f//se3tur3qCYJ8LCDC08Daa3LbLslEHSej78w7AISYMM4TQiSkAxMObCj9vsGnQog73ntqrbw6QxOk/WCRCr1t2Fj5ITI3dSBtRpjET3UwC8U0Td3wFYbmeh1vXC4ji9QsYkVpjVIaIVeM9cSU+kdTLtxjeolueLmOfPv+xvQh+DUv/W9nsfZnqTbcvYl3fHhcn/GXH0p5nUk7pVaa7hnlM9N6agaofLjCYhJSCOSqqKfgf3gUGdk2g3UOpTes849SmuFVZd4WxzjekNoQUj7He0bjW+OrNrzPC9MiGd8n5mXtfDecbGE2Cd3K0IY9Z/JR2PNB/oLOHQXn70il0ZtFtA0xtvO9FO13VnvHGoOQkhgjZzBPeX6OHOJjzeyXkdvrPSWcs6x9VSSbMWcR5d+otWdorOtGfwwb/xuxcArQlqSJEwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dd77549e484d9b6fd6d1ecb34eeeb93d/7c297/img01.webp 180w,\n/static/dd77549e484d9b6fd6d1ecb34eeeb93d/33ecc/img01.webp 360w,\n/static/dd77549e484d9b6fd6d1ecb34eeeb93d/df77d/img01.webp 720w,\n/static/dd77549e484d9b6fd6d1ecb34eeeb93d/c30c1/img01.webp 740w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dd77549e484d9b6fd6d1ecb34eeeb93d/e9ea2/img01.png 180w,\n/static/dd77549e484d9b6fd6d1ecb34eeeb93d/53918/img01.png 360w,\n/static/dd77549e484d9b6fd6d1ecb34eeeb93d/242a6/img01.png 720w,\n/static/dd77549e484d9b6fd6d1ecb34eeeb93d/b38af/img01.png 740w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dd77549e484d9b6fd6d1ecb34eeeb93d/242a6/img01.png\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<h3 id=\"jwtmodule-등록\" style=\"position:relative;\"><a href=\"#jwtmodule-%EB%93%B1%EB%A1%9D\" aria-label=\"jwtmodule 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JwtModule 등록</h3>\n<p>일단 <strong>module</strong>에 아래와 같이 <strong>JwtModule</strong>을 추가해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//auth.module.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Module <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> JwtModule <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/jwt'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CreateJwtController <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./controllers/create.jwt.controller'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CREATE_JWT_OUTBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./port/out/create.jwt.outbound.port'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CreateJwtService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./services/jwt/create.jwt.service'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  imports<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    JwtModule<span class=\"token punctuation\">.</span><span class=\"token function\">registerAsync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function-variable function\">useFactory</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        secret<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">JWT_KEY</span><span class=\"token punctuation\">,</span>\n        signOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> expiresIn<span class=\"token operator\">:</span> <span class=\"token string\">'60s'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>CreateJwtController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> provide<span class=\"token operator\">:</span> <span class=\"token constant\">CREATE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">,</span> useClass<span class=\"token operator\">:</span> CreateJwtService <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>저기서 <strong>imports</strong> 부분에서 <strong>secret</strong>은 Jwt 서명키를 넣는 부분이다.<br>\n나는 설정 파일을 빼서 처리했다.</p>\n<p>왜 저렇게 했는지 궁금한 분은 아래 포스팅을 참고하자.<br>\n<a href=\"https://elfinlas.github.io/nest_js/230213_nestjs_module_config_load/\">Nest.Js에서 @Module의 속성에서 process.env 사용하기</a></p>\n<p><strong>JwtModule</strong> 모듈을 통해 Jwt를 생성하고, 검증하는 기능을 쉽게 사용할 수 있다.<br>\n일단 모듈을 등록했다면 Jwt를 생성해보도록 하자.</p>\n<br>\n<h3 id=\"jwt-생성-서비스\" style=\"position:relative;\"><a href=\"#jwt-%EC%83%9D%EC%84%B1-%EC%84%9C%EB%B9%84%EC%8A%A4\" aria-label=\"jwt 생성 서비스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Jwt 생성 서비스</h3>\n<p>생성 서비스 로직은 아주 간단하다.<br>\n왜냐하면…그냥 생성만 하는 샘플이기 때문이다. -_-;;</p>\n<p>여기에서 비즈니스 요구사항이 붙기 시작하면 그때부터는 약간씩 무거워진다.<br>\n무튼 이번 포스팅은 Jwt 생성에 포커스가 되어 있기에 다른 요건은 무시하고 생성에만 집중한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//create.jwt.service.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> JwtService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/jwt'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CreateJwtOutboundPort<span class=\"token punctuation\">,</span> CreateJwtInputDto<span class=\"token punctuation\">,</span> CreateJwtOutputDto <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../port/out/create.jwt.outbound.port'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CreateJwtService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">CreateJwtOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span>JwtService<span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> jwtService<span class=\"token operator\">:</span> JwtService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">excute</span><span class=\"token punctuation\">(</span>params<span class=\"token operator\">:</span> CreateJwtInputDto<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> CreateJwtOutputDto <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> payload <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> user<span class=\"token operator\">:</span> <span class=\"token string\">'bcow'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> jwt<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jwtService<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 보면 정말 아주 간단하게 Jwt를 생성할 수 있음을 확인할 수 있다.<br>\n아마 <strong>Part02</strong>로 가면 점점 코드가 늘어나게 될 것이다.</p>\n<br>\n<h3 id=\"jwt-생성-확인용-컨트롤러\" style=\"position:relative;\"><a href=\"#jwt-%EC%83%9D%EC%84%B1-%ED%99%95%EC%9D%B8%EC%9A%A9-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC\" aria-label=\"jwt 생성 확인용 컨트롤러 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Jwt 생성 확인용 컨트롤러</h3>\n<p>이제는 생성된 jwt를 확인해봐야 하는데 간단하게 컨트롤러를 하나 만들자.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//create.jwt.controller.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Controller<span class=\"token punctuation\">,</span> Get<span class=\"token punctuation\">,</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">CREATE_JWT_OUTBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../port/out/create.jwt.outbound.port'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CreateJwtService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../services/jwt/create.jwt.service'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'auth'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CreateJwtController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">CREATE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> createJwtService<span class=\"token operator\">:</span> CreateJwtService<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'jwt'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">makeJwt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>createJwtService<span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>코드가 뭔가 성의없어 보일 수 있지만…<br>\n예제 코드다.</p>\n<p>나도 다테일하게 짜고 싶지만…<br>\n시간 부족으로 인해…<br>\n자세하게 짜는 것은 <strong>Part02</strong> 포스팅에서 다시 다뤄보겠다.</p>\n<p>무튼 이렇게 작성하고 구동해보면…</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.777777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZ0lEQVQI1zWM2w0DIQwEr6+AOZ5J/zXYhi7mBEk+RlrtjvaSUMipE0PhFTq3VGLIJGkkqaRYuaUhsdDKm5I7o32ov5zvcdzzkwfXnJONmaPmrLVO3rhPVA13R1X5u252vM3uv7sd/wE/fmz5ZZZicgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/848baedd666995975def0d05ee064e90/7c297/img02.webp 180w,\n/static/848baedd666995975def0d05ee064e90/33ecc/img02.webp 360w,\n/static/848baedd666995975def0d05ee064e90/df77d/img02.webp 720w,\n/static/848baedd666995975def0d05ee064e90/5c666/img02.webp 1080w,\n/static/848baedd666995975def0d05ee064e90/deed9/img02.webp 1256w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/848baedd666995975def0d05ee064e90/e9ea2/img02.png 180w,\n/static/848baedd666995975def0d05ee064e90/53918/img02.png 360w,\n/static/848baedd666995975def0d05ee064e90/242a6/img02.png 720w,\n/static/848baedd666995975def0d05ee064e90/b4ad3/img02.png 1080w,\n/static/848baedd666995975def0d05ee064e90/30373/img02.png 1256w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/848baedd666995975def0d05ee064e90/242a6/img02.png\"\n            alt=\"img02\"\n            title=\"img02\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>잘 생성되는 것을 확인할 수 있다.<br>\n<a href=\"https://jwt.io\">Jwt.io</a>에서도 확인이 가능하다.<br>\n만든 jwt를 넣어보면 아래와 같이 유효한 Jwt가 생성되었음을 확인할 수 있다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRklEQVQoz4WS226dMBBF+f8frFIdqRIiVUM4AeP7bVaFKQqltN1miQfbM3s2dP0wME4TuRaKVDbJiU21VoZhoO97YoyklMg572dFfqNL80p+KupiqItGFgMfBqYVVECyUKWilEJbi4+BEAKllNboSheHRHhE/CPiXiL+JaK+BabeMw2J6HfPkjLYgNjAobOzY5Luwwijgh9KGFd4W4VXJzwL2Arl14XsA1U7xMc9jsuoR4NO+HO19OQzxa2zMYZYUtu/G3Vji6Fr1eXyJc6d2yNIhLJAGqXl2tbFZRv5bPeOY6/EStFCViCFW+0jny7dHWjvWlnWlecyU0qklkxOqf0+V/7rUPaKvC6GL++a74tpKGPQxrRsD6y1nwX/qVp5Xy1fZ89j8fTKMWuDvSu4BflXd6ewjXW86Q3PqB2zcXjncCe89/wEtRBfxmGi69UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/14c1614204ab5bc44099b7112be1df09/7c297/img03.webp 180w,\n/static/14c1614204ab5bc44099b7112be1df09/33ecc/img03.webp 360w,\n/static/14c1614204ab5bc44099b7112be1df09/df77d/img03.webp 720w,\n/static/14c1614204ab5bc44099b7112be1df09/5c666/img03.webp 1080w,\n/static/14c1614204ab5bc44099b7112be1df09/ebc99/img03.webp 1219w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/14c1614204ab5bc44099b7112be1df09/e9ea2/img03.png 180w,\n/static/14c1614204ab5bc44099b7112be1df09/53918/img03.png 360w,\n/static/14c1614204ab5bc44099b7112be1df09/242a6/img03.png 720w,\n/static/14c1614204ab5bc44099b7112be1df09/b4ad3/img03.png 1080w,\n/static/14c1614204ab5bc44099b7112be1df09/a7903/img03.png 1219w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/14c1614204ab5bc44099b7112be1df09/242a6/img03.png\"\n            alt=\"img03\"\n            title=\"img03\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>이번 Part01에서는 Jwt 생성까지만 다뤄봤다.<br>\n다음 포스팅에서는 이제 Passport-Jwt 활용 및 어떤 식으로 사용하는지에 대해 포스팅해볼 예정이다.</p>\n<p>사실 이번주에 끝내려 했는데 현재 일정이 너무 타이트 해서 일단 맛보기 용으로 먼저 포스팅했다.<br>\n시간이 될 때 얼른 마저 끝내봐야겠다.</p>\n<p>참고 사이트는 아래와 같다.</p>\n<p><a href=\"https://docs.nestjs.com/security/authentication#jwt-functionality\">공식 문서</a></p>\n<br>\n<h3 id=\"ps\" style=\"position:relative;\"><a href=\"#ps\" aria-label=\"ps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PS</h3>\n<p>원래 레이어드 아키텍쳐를 쓰려 했지만…<br>\n<a href=\"https://elfinlas.github.io/til/230114_wanted_preon_back02/\">백엔드 프리온보딩</a>에서 배운 <strong>Ports and Adapter 아키텍쳐</strong>로 한번 짜봐야겠다 싶어서 써봤다.</p>\n<p>현재 개발중인 코드에서도 적용 중이긴 한데…\n약간 코드가 미흡할 수 있다.</p>\n<p>코드는 <a href=\"https://github.com/elfinlas/NestJsJwt\">Github</a>를 참고하시면 된다.</p>\n<p>이 부분은 혹시 고수가 있다면 댓글로 알려주시면 감사하겠다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#nestjs%EC%97%90%EC%84%9C-jwt-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">Nest.js에서 JWT 사용하기</a></p>\n<ul>\n<li><a href=\"#%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98\">패키지 설치</a></li>\n<li><a href=\"#jwtmodule-%EB%93%B1%EB%A1%9D\">JwtModule 등록</a></li>\n<li><a href=\"#jwt-%EC%83%9D%EC%84%B1-%EC%84%9C%EB%B9%84%EC%8A%A4\">Jwt 생성 서비스</a></li>\n<li><a href=\"#jwt-%EC%83%9D%EC%84%B1-%ED%99%95%EC%9D%B8%EC%9A%A9-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC\">Jwt 생성 확인용 컨트롤러</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n<ul>\n<li><a href=\"#ps\">PS</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2023.02.08","title":"Nest.Js에서 JWT 사용하기 (Part01 JWT 생성해보기)","categories":"nest_js","emoji":"📜"},"fields":{"slug":"/nest_js/230208_nesjs_jwt_part1/"}},"prev":{"id":"752886b0-32a0-527a-ada5-034a7033896f","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQoz5VSTUsCURT1X7TqY9O+VbRQIdpWizZCqxb1A4JWBS3cFAgtIspNiyCCoEVBRWJJQhqWFbop6GNg+nJSEccZ5+PNeyfm6ehIRnbgvHfhvXvu4d7rAQBGKacbjDFOd/wXbXicwIEliND2I+2F7cKu2Hl3//VwkVwe8nwIBV8AheFJFPwBkCeh1bFFWxL5TazarVTBTFJzaB/y4gqkXh+kHi9y3V4Ux2c47UK0okDd3IW2dwwzcw8jcQ395BzGVQba4RnIo4DK8gas14+mIJUrYFUNRjyFr4FRSP0jyHUNwkikQWUFcnAV+mmCF5YXQjBvstAjcZRng1y0srQOWizVe2jVbBupO6jhbZSm5iD1+ZEfmgARRDC1Cu0oBjOdhXF5C+0gCj2W5I5sUfLwDD16Aevtsy5Ia/0gLyLU8A6UtS0Ux6ZhJNMtze8EjaG4J2WJ76Bluf26UNaYtGPEWbkfa8M/EdKs5iT+gw3BX3eNtbrvBN9Ty+sRGu0ozQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7685b7a900370c34be4e657df3f862d/7c297/thumbnail_nestjs.webp 180w,\n/static/b7685b7a900370c34be4e657df3f862d/33ecc/thumbnail_nestjs.webp 360w,\n/static/b7685b7a900370c34be4e657df3f862d/84c6d/thumbnail_nestjs.webp 700w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7685b7a900370c34be4e657df3f862d/e9ea2/thumbnail_nestjs.png 180w,\n/static/b7685b7a900370c34be4e657df3f862d/53918/thumbnail_nestjs.png 360w,\n/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png 700w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7685b7a900370c34be4e657df3f862d/a27c6/thumbnail_nestjs.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"블로그용-작은-프로젝트를-만들다가\" style=\"position:relative;\"><a href=\"#%EB%B8%94%EB%A1%9C%EA%B7%B8%EC%9A%A9-%EC%9E%91%EC%9D%80-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EB%A5%BC-%EB%A7%8C%EB%93%A4%EB%8B%A4%EA%B0%80\" aria-label=\"블로그용 작은 프로젝트를 만들다가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>블로그용 작은 프로젝트를 만들다가…</h1>\n<p>이번에 <strong>Nest.Js</strong>에서 <strong>Jwt</strong>쓰기 주제로 포스팅을 준비중이다.<br>\n근데 처음부터 다시 설치해서 하려니까 몇 가지 막히는 부분이 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//auth.module.ts</span>\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    imports<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    JwtModule<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      secret<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">JWT_KEY</span><span class=\"token punctuation\">,</span>\n      signOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> expiresIn<span class=\"token operator\">:</span> <span class=\"token string\">'60s'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이런 코드가 있다.<br>\n근데 @Module 안에서 process.env로 설정파일에 접근하려 했다.</p>\n<p>근데 아래와 같이 에러가 발생했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2UlEQVQY0zWO6W6DMBCEeZpeSVtuaIOxDTFgczQlXOr7v8dUu1V/jGa0Gn07nhI1rpVD1d6gzMQulIMqKhilUEkJVdbQ4k/lRUNcKoRxgbfwE6f3DA8vIR5PEZ7OMbwglWjHHe2w4mpnNP2CbtzRDBsauo8HZ9MvMD117qjtzK7NhLwwCFOJ59eEoV6QCBg7w00HjLujGzfO3bDCjhuG2w8/a9zCzyhTv+6+IbRDlCnEuYafCPhxAY/otIxA/zD3dcBOO4syiWH9yk6w+EMjyiSCtMTZz3kh6Rfpo4884pD84gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/24c9340c13f5d6f39177875192ad9bf3/7c297/img01.webp 180w,\n/static/24c9340c13f5d6f39177875192ad9bf3/33ecc/img01.webp 360w,\n/static/24c9340c13f5d6f39177875192ad9bf3/df77d/img01.webp 720w,\n/static/24c9340c13f5d6f39177875192ad9bf3/493ca/img01.webp 952w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/24c9340c13f5d6f39177875192ad9bf3/e9ea2/img01.png 180w,\n/static/24c9340c13f5d6f39177875192ad9bf3/53918/img01.png 360w,\n/static/24c9340c13f5d6f39177875192ad9bf3/242a6/img01.png 720w,\n/static/24c9340c13f5d6f39177875192ad9bf3/be2fd/img01.png 952w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/24c9340c13f5d6f39177875192ad9bf3/242a6/img01.png\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이유가 뭘까 잠깐 고민했는데…<br>\n기존 프로젝트는 이미 다 되어 있는 것이라서 내가 빼 먹은 설정과 패키지가 있었다.</p>\n<h2 id=\"nextjs에서-config\" style=\"position:relative;\"><a href=\"#nextjs%EC%97%90%EC%84%9C-config\" aria-label=\"nextjs에서 config permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Next.js에서 Config</h2>\n<p>이유는 간단했다.<br>\n먼저 <strong>Config</strong>관련 패키지를 빼먹었었다.</p>\n<p>먼저 아래의 명령어로 패키지를 설치해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> yarn add @nestjs/config</code></pre></div>\n<p>그리고 모듈의 최상단인 <strong>app.module</strong>을 연다.<br>\n아래와 같이 모듈 파일을 수정해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Module <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ConfigModule <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/config'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AuthModule <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./domain/auth/auth.module'</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  imports<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>ConfigModule<span class=\"token punctuation\">.</span><span class=\"token function\">forRoot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> AuthModule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>imports</strong> 부분에서 저렇게 처리하면 된다.</p>\n<p>만약 구동 환경마다 설정파일을 좀 다르게 하고 싶다면 아래와 같이 처리가 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">ConfigModule<span class=\"token punctuation\">.</span><span class=\"token function\">forRoot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    envFilePath<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"prod\"</span> <span class=\"token operator\">?</span> <span class=\"token string\">\".production.env\"</span> <span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"stage-dev\"</span> <span class=\"token operator\">?</span> <span class=\"token string\">\".stagedev.env\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\".dev.env\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>NODE_ENV는 실행 인자에서 전달해주는 것으로 처리했다.<br>\n이렇게 하면 각 구동 인자에 따라 설정 파일을 다르게 넣을 수 있다.</p>\n<p>그리고 아까 예제를 다시 보면…<br>\n약간 코드를 바꿔야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//auth.module.ts</span>\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    imports<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    JwtModule<span class=\"token punctuation\">.</span><span class=\"token function\">registerAsync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function-variable function\">useFactory</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        secret<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">JWT_KEY</span><span class=\"token punctuation\">,</span>\n        signOptions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> expiresIn<span class=\"token operator\">:</span> <span class=\"token string\">'60s'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>registerAsync</strong> 이걸 써줘야 정상적으로 값을 불러올 수 있다.<br>\n저 비동기 등록을 쓰는 이유는 아직 config에서 env를 가져와서 등록하기 위함이다.</p>\n<p>만약 일반적으로 <strong>JwtModule.register</strong>를 사용하면 에러가 발생한다.<br>\n그래서 비동기 등록을 사용해야 한다.</p>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>아주 간단한 문제였는데 덕분에 하나 배웠다.<br>\n항상 기존 틀을 이용해서 그대로 진행하니 이런 부분에서 문제가 생기는 것 같다.</p>\n<p>틀에서 벗어나 본질을 이해해야 하는데 이 부분이 부족했던 것 같다…</p>\n<br>\n<p><a href=\"https://stackoverflow.com/questions/63285055/nestjs-how-to-use-env-variables-in-main-app-module-file-for-database-connecti\">참고 Stackoverflow</a><br>\n<a href=\"https://docs.nestjs.com/techniques/configuration\">공식 Next.js confing 문서</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#nextjs%EC%97%90%EC%84%9C-config\">Next.js에서 Config</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></li>\n</ul>\n</div>","frontmatter":{"date":"2023.02.13","title":"Nest.Js에서 @Module의 속성에서 process.env 사용하기","categories":"nest_js","emoji":"📜"},"fields":{"slug":"/nest_js/230213_nestjs_module_config_load/"}},"site":{"siteMetadata":{"siteUrl":"https://elfinlas.github.io","comments":{"utterances":{"repo":"elfinlas/blog_utterances"}},"projects":[{"title":"마와셀(웹) - 와인 가격 비교","description":"와인 가격 비교 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223393940649","github":"","web":"https://appmyc.info","googlePlay":"","appStore":""}},{"title":"마와셀(엡) - 와인과 셀러 관리, 시음노트","description":"보유한 와인의 관리, 시음노트 작성, 보유 와인 셀러의 관리 어플리케이션","techStack":["Dart","Flutter","hive","provider"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223531933037","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.myc","appStore":"https://itunes.apple.com/kr/app/apple-store/6474965246"}},{"title":"흑우집합소(웹) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223059966682","github":"","web":"https://bcow.world/","googlePlay":"","appStore":""}},{"title":"흑우집합소(앱) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Dart","Flutter","drift","provider"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223232966579","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.bcow_world","appStore":"https://itunes.apple.com/kr/app/apple-store/6470312130"}}]}}},"pageContext":{"slug":"/nest_js/230212_start_nestjs/","nextSlug":"/nest_js/230208_nesjs_jwt_part1/","prevSlug":"/nest_js/230213_nestjs_module_config_load/"}},"staticQueryHashes":["1186322783","1321405810","3649515864"]}
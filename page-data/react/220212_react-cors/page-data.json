{"componentChunkName":"component---src-templates-post-jsx","path":"/react/220212_react-cors/","result":{"data":{"site":{"siteMetadata":{"title":"MHLab blog","author":"MHLab"}},"markdownRemark":{"id":"332048a9-f736-569b-b327-6d5f7e8f9b8c","excerpt":"React에서 Cors 문제가... 최근 내 개인 프로젝트를 위해서 React와 node, next.js, typescript, tailwindcss 가 필요했다. 개발을 한창 내려놨던 터라 다시 새로운 것을 하려니 귀찮아졌다. 하지만 기존의 jQuery…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1231c0073a9bc0704f04fff13d13ffe0/5a190/thumbnail_react.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.423312883435585%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyklEQVR42nWQyQrCQAxA+zedZGa62FZblKJWcAGXgktVEIqe/AAFPXjyIoK/bIYitIOFd0hC3iQTA4VVQdrIJXLBKaCUS245BBJFpYRR1gDQ6nTDLG+tDiip4nDXA5MRjIF6tFZWvhNuj4PHJ7m93N7QG83j8zXc5MEi86fLZroXjQBQ1Mhc0szk/u5fnk6cWFHsT9Jod6JiMFv741S4Xnm+tjbZbRpIoFApfQRMAAYUI82sbm7oB+NSCdQqbIX8obX9l4uD13Rr8hcL7lIfd1tPwAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"thumbnail\"\n        title=\"\"\n        src=\"/static/1231c0073a9bc0704f04fff13d13ffe0/a6d36/thumbnail_react.png\"\n        srcset=\"/static/1231c0073a9bc0704f04fff13d13ffe0/222b7/thumbnail_react.png 163w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/ff46a/thumbnail_react.png 325w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/a6d36/thumbnail_react.png 650w,\n/static/1231c0073a9bc0704f04fff13d13ffe0/5a190/thumbnail_react.png 800w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1 id=\"react에서-cors-문제가\" style=\"position:relative;\"><a href=\"#react%EC%97%90%EC%84%9C-cors-%EB%AC%B8%EC%A0%9C%EA%B0%80\" aria-label=\"react에서 cors 문제가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React에서 Cors 문제가...</h1>\n<p>최근 내 개인 프로젝트를 위해서 React와 node, next.js, typescript, tailwindcss 가 필요했다.<br>\n개발을 한창 내려놨던 터라 다시 새로운 것을 하려니 귀찮아졌다.</p>\n<p>하지만 기존의 jQuery로 진행한 프로젝트를 모바일용으로 개발하는 것과 서버 기능 분담 등은 불가능 했다.<br>\n그래서 <a href=\"http://nomadcoders.co\">노마드코더</a> 에서 강의를 들으며, 외국 성님들의 유튭 강의를 들으며 공부를 시작했다.</p>\n<p>강의는 다 들었고, 샘플 프로젝트로 한번 개발을 시작해봤다.<br>\n그런데 fetch를 사용해서 JSON을 가져오는 부분에서 <strong>Cors</strong> 문제가 발생했다.<br>\n에러 내용은 다음과 같았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[Error] Origin http://localhost:3000 is not allowed by Access-Control-Allow-Origin.\n[Error] Fetch API cannot load https://xxx.com due to access control checks.\n[Error] Failed to load resource: Origin http://localhost:3000 is not allowed by Access-Control-Allow-Origin. (common.do, line 0)\n[Error] Unhandled Promise Rejection: TypeError: Load failed\n\t(익명 함수) (bundle.js:202)\n\tasyncFunctionResume\n\t(익명 함수)\n\tpromiseReactionJobWithoutPromise\n\tpromiseReactionJob</code></pre></div>\n<p>저 위에 xxx.com은 내가 임의로 설정한 사이트다.\n(정보 조회 사이트 공개가 불가해서 임의로 설정했다.)</p>\n<p>이걸 해결하는 법은 총 2개가 있다.</p>\n<ol>\n<li>xxx.com 의 서버 사이드에서 처리해주기.</li>\n<li>React의 package에서 proxy 처리 해주기.</li>\n</ol>\n<p>1번 방법의 경우 나에겐 선택할 수 없는 옵션이었다.\n그래서 2번을 선택했다.</p>\n<p>처리 방법은 간단했다.</p>\n<br>\n<h3 id=\"적용법\" style=\"position:relative;\"><a href=\"#%EC%A0%81%EC%9A%A9%EB%B2%95\" aria-label=\"적용법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>적용법</h3>\n<ol>\n<li>자신의 프로젝트의 <strong>package.json</strong>에 <strong>proxy</strong> 항목을 추가한다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{\n  \"name\": \"my-app\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"dependencies\": {\n    \"@testing-library/jest-dom\": \"^5.16.2\",\n  ....\n  },\n  \"proxy\":\"https://xxx.com\",\n}</code></pre></div>\n<p>proxy가 들어가는 자리는 아무데나 상관 없다. (상위 값에 가능 (dependencies 이런데는 불가))</p>\n<br>\n<ol start=\"2\">\n<li>호출하는 부분에서 전체 url이 아닌 도메인을 제외한 형태로 호출한다.</li>\n</ol>\n<p>예를 들어 풀 도메인이 다음과 같다면 두 번째 줄 처럼 처리하는 이야기다.</p>\n<blockquote>\n<p><a href=\"https://www.xxx.com/test/data?no=10\">https://www.xxx.com/test/data?no=10</a>\n/test/data?no=10</p>\n</blockquote>\n<p>그래서 호출하는 형태는 아래와 같이 될 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">...\nconst getLottoData = async() => {\n    const json = await(await fetch(\"/test/data?no=10\")).json();\n...\n}</code></pre></div>\n<p>근데 급 궁금해지는 것은...만약 2개 이상의 cors 사이트를 처리해야 한다면 어떻게 해야 하나?<br>\n이 부분은 직접 처리해야 할 때 다시 다뤄볼 예정이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#react%EC%97%90%EC%84%9C-cors-%EB%AC%B8%EC%A0%9C%EA%B0%80\">React에서 Cors 문제가...</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%EC%A0%81%EC%9A%A9%EB%B2%95\">적용법</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"React에서 Cors 문제 해결하기 (With proxy)","description":null,"date":"February 12, 2022","tags":["ReactJS","CORS"],"series":"ReactJS","previewImage":"react_logo.png","isPrivate":null,"writer":null}},"previous":{"fields":{"slug":"/tools/220209_vscode-emmet/"},"frontmatter":{"title":"VSCode에서 에밋(Emmet)이 동작하지 않는 경우","isPrivate":null}},"next":{"fields":{"slug":"/til/220214_til/"},"frontmatter":{"title":"22년 2월 14일 개발일지 (With TIL)","isPrivate":null}}},"pageContext":{"id":"332048a9-f736-569b-b327-6d5f7e8f9b8c","previousPostId":"90ddbc85-2d32-5e52-9183-86791a9a44a7","nextPostId":"991d7157-e5eb-5d0f-8c0a-4a06f027e3c3"}},"staticQueryHashes":[],"slicesMap":{}}
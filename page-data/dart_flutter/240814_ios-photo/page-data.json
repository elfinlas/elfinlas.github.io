{"componentChunkName":"component---src-templates-post-template-index-tsx","path":"/dart_flutter/240814_ios-photo/","result":{"data":{"cur":{"id":"ce312e01-a738-51e9-a24c-84c8d6ff002a","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 667px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVQoz3WRQU6DUBCGWXkGD+U9vIFbb+DSG7gycekFXBitwQRcUEgTIEoFQQtF2hLmfQbo00LrJJP3Mu+bP/PmN0QpdOirUmqUwi4nstszZI22GJSCkzcd0DQN/0W2anBz2XJykDWiSrhwa6YVfOcLJpMnoijq0nEcgiAgDEOKRc7JlcPR6TV3L69IvWL+HhPHMWmakmVZL7hWcP7wya37BZuKt2iO53nYtt2dpmliWRbrsuTsccnx5ZSb+xmomjTL8H2fJEkoigIR6b8cfix5niV7exlHWwk2f4yMmG6HQ1MOC+m33rUhM+7pJmxFtXP7DusG9TuVFj/E/QBlrxtrR+aZjQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2cf2ed8b48f804d8174ffc3a202929cc/7c297/thumbnail_flutter.webp 180w,\n/static/2cf2ed8b48f804d8174ffc3a202929cc/33ecc/thumbnail_flutter.webp 360w,\n/static/2cf2ed8b48f804d8174ffc3a202929cc/03032/thumbnail_flutter.webp 667w\"\n              sizes=\"(max-width: 667px) 100vw, 667px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2cf2ed8b48f804d8174ffc3a202929cc/e9ea2/thumbnail_flutter.png 180w,\n/static/2cf2ed8b48f804d8174ffc3a202929cc/53918/thumbnail_flutter.png 360w,\n/static/2cf2ed8b48f804d8174ffc3a202929cc/e31cc/thumbnail_flutter.png 667w\"\n            sizes=\"(max-width: 667px) 100vw, 667px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2cf2ed8b48f804d8174ffc3a202929cc/e31cc/thumbnail_flutter.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"이미지를-다루다가\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A5%BC-%EB%8B%A4%EB%A3%A8%EB%8B%A4%EA%B0%80\" aria-label=\"이미지를 다루다가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이미지를 다루다가…</h2>\n<p>전에 마와셀 1.0 버전대 개발을 하다 겪은 일이다.<br>\n마와셀에는 와인 사진 및 셀러, 시음 노트에 이미지를 첨부하는 기능이 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 173.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAjABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAEDBQQG/8QAGAEBAAMBAAAAAAAAAAAAAAAAAAECBAP/2gAMAwEAAhADEAAAAU6Vde3A2yKKeqVJCPN1jXthm//EABwQAAIDAQADAAAAAAAAAAAAAAIDAAEUEAQSQf/aAAgBAQABBQLCUxFMJQzFd6V8Oiu/RkqfeOadOtrJ4RWSf//EABsRAAIBBQAAAAAAAAAAAAAAAAACARAREhMx/9oACAEDAQE/AcnNjF6RA3T/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAhEAABAgYCAwAAAAAAAAAAAAAAAQIREiExMpEQICIzUf/aAAgBAQAGPwLJDJpmhWJddcUfKe5ddXpOt/pm7Z5LGp//xAAdEAEAAgIDAQEAAAAAAAAAAAABABEhMRBR8YGR/9oACAEBAAE/IfPY9Z8Z4rAlxfRfAxsuZ14aDi2hbM7P7MQgQEHRAq6ISqK+Wf/aAAwDAQACAAMAAAAQ+A3N89//xAAaEQEBAAIDAAAAAAAAAAAAAAABABAhETFh/9oACAEDAQE/EBtl6QjAcGrvv//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QX//EAB8QAQEBAAEDBQAAAAAAAAAAAAERADEhQYFRYXGhwf/aAAgBAQABPxDOKJ84yaR0e6zAEavliMWJTCE4hC1vP5lxPNOQEKgCvf33M0L2WGvo+tM6TFCrBAA5iSoeWBLwrWQ3/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e0225387fa85b97a96c0e42829ec14dd/7c297/img01.webp 180w,\n/static/e0225387fa85b97a96c0e42829ec14dd/33ecc/img01.webp 360w,\n/static/e0225387fa85b97a96c0e42829ec14dd/df77d/img01.webp 720w,\n/static/e0225387fa85b97a96c0e42829ec14dd/5c666/img01.webp 1080w,\n/static/e0225387fa85b97a96c0e42829ec14dd/b47fd/img01.webp 1170w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e0225387fa85b97a96c0e42829ec14dd/98e5d/img01.jpg 180w,\n/static/e0225387fa85b97a96c0e42829ec14dd/543cd/img01.jpg 360w,\n/static/e0225387fa85b97a96c0e42829ec14dd/20801/img01.jpg 720w,\n/static/e0225387fa85b97a96c0e42829ec14dd/b37e7/img01.jpg 1080w,\n/static/e0225387fa85b97a96c0e42829ec14dd/faa76/img01.jpg 1170w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e0225387fa85b97a96c0e42829ec14dd/20801/img01.jpg\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>안드로이드에서는 잘 되어서 문제없이 넘어갔다가,<br>\niOS도 실제 디바이스에서 테스트를 진행하면서 문제가 없음을 확인했었다.</p>\n<p>하지만 iPad용 스크린샷이 필요해서 시뮬레이터에서 구동하다가 문제가 생겼다.</p>\n<br>\n<h2 id=\"이미지를-못-가져옴\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A5%BC-%EB%AA%BB-%EA%B0%80%EC%A0%B8%EC%98%B4\" aria-label=\"이미지를 못 가져옴 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이미지를 못 가져옴</h2>\n<p>시뮬레이터를 끈 다음 빌드 후 다시 접근하는데 이미지가 없어서 앱 크래시가 발생했다.<br>\n물론 2.0에서는 이미지가 없을 때 기본 이미지 표시로 바꾸긴 했다.</p>\n<p>마와셀의 이미지는 파일명만 가져와서 저장을 하게 된다.<br>\n경로의 경우 조립해서 사용하는 방식을 사용했다.</p>\n<p>로직에는 문제가 없었고,<br>\n뭔가 이상함을 느낀 나는 몇 가지 로그를 남기며 테스트를 했다.<br>\n그 결과 시뮬레이터의 이미지 경로가 계속 변경함을 찾을 수 있었다.</p>\n<ul>\n<li>첫 번째 테스트 빌드 하였을 때 경로</li>\n</ul>\n<blockquote>\n<p>/Users/testMan/Library/Developer/CoreSimulator/Devices/73169529-CF2Z-20FT-U1A1-O23DBE772DCA/data/Containers/Data/Application/2DQ07F26-AB29-968D-00FA-DOQE96A35B27/Documents/tmp_img/2233-FF00-img001.png</p>\n</blockquote>\n<ul>\n<li>두 번째 테스트 빌드 하였을 때 경로</li>\n</ul>\n<blockquote>\n<p>/Users/testMan/Library/Developer/CoreSimulator/Devices/73169529-CF2Z-20FT-U1A1-O23DBE772DCA/data/Containers/Data/Application/576G7D01-Z3K0-D2K1-6FFQ-J6YF3ME8A02B/Documents/tmp_img/O1DV-W991-img001.png</p>\n</blockquote>\n<br>\n<h2 id=\"ios는-별도-구현이-필요\" style=\"position:relative;\"><a href=\"#ios%EB%8A%94-%EB%B3%84%EB%8F%84-%EA%B5%AC%ED%98%84%EC%9D%B4-%ED%95%84%EC%9A%94\" aria-label=\"ios는 별도 구현이 필요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>iOS는 별도 구현이 필요</h2>\n<p>위 로그를 보면 알겠지만, 어플리케이션 ID가 계속 변함을 알 수 있다.</p>\n<p>저 앱 ID의 경우 <strong>path_provider</strong>의 <strong>getApplicationDocumentsDirectory</strong>를 통해서 가져오게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"dart\"><pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DirectoryManager</span> <span class=\"token punctuation\">{</span>\n  late <span class=\"token keyword\">final</span> <span class=\"token class-name\">Directory</span> appDir<span class=\"token punctuation\">;</span>\n  late <span class=\"token keyword\">final</span> <span class=\"token class-name\">Directory</span> tmpDir<span class=\"token punctuation\">;</span>\n\n  <span class=\"token class-name\">DirectoryManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">{</span>\n    appDir <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getApplicationDocumentsDirectory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    tmpDir <span class=\"token operator\">=</span> <span class=\"token class-name\">Directory</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">'</span><span class=\"token interpolation\"><span class=\"token punctuation\">${</span><span class=\"token expression\">appDir<span class=\"token punctuation\">.</span>path</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">/tmpRes'</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">await</span> <span class=\"token function\">_createDirectories</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>난 디렉토리랑 파일을 다루는 별도의 클래스를 두고,<br>\n<strong>get_it</strong>을 통해서 Injection 해서 사용한다.</p>\n<p>해당 문제를 수정하려면 결국 경로를 플랫폼마다 조정해서 써야 한다.<br>\n아래의 코드를 참고하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"dart\"><pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token class-name\">String</span> imgPath<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">///Android</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Platform</span><span class=\"token punctuation\">.</span>isAndroid<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        imgPath <span class=\"token operator\">=</span> <span class=\"token function\">_getAttachImageFullPath</span><span class=\"token punctuation\">(</span>attachImageEnum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">///iOS</span>\n      <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Platform</span><span class=\"token punctuation\">.</span>isIOS<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        imgPath <span class=\"token operator\">=</span>\n            <span class=\"token string-literal\"><span class=\"token string\">\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">${</span><span class=\"token expression\">dirManager<span class=\"token punctuation\">.</span>appDir<span class=\"token punctuation\">.</span>path</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token punctuation\">${</span><span class=\"token expression\">attachImageEnum<span class=\"token punctuation\">.</span><span class=\"token function\">getAttachPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\">// 웹이나 다른 플랫폼의 경우 임시 디렉토리 사용</span>\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        imgPath <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">getTemporaryDirectory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      logger<span class=\"token punctuation\">.</span><span class=\"token function\">d</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">'[cloneFile] Error: </span><span class=\"token interpolation\"><span class=\"token punctuation\">$</span><span class=\"token expression\">e</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/// 다른 함수</span>\n<span class=\"token class-name\">String</span> <span class=\"token function\">_getAttachImageCategoryFullPath</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">AttachImageEnum</span> imgEnum<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">final</span> directoryManager <span class=\"token operator\">=</span> getIt<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DirectoryManager</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>imgEnum <span class=\"token operator\">==</span> <span class=\"token class-name\">AttachImageEnum</span><span class=\"token punctuation\">.</span>wine<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> directoryManager<span class=\"token punctuation\">.</span>wine<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> directoryManager<span class=\"token punctuation\">.</span>tmpDir<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>내가 사용하는 코드를 잘라서 주요 로직은 잘라낸 예제 코드다.</p>\n<p>핵심은 iOS의 경우 <strong>getApplicationDocumentsDirectory</strong>이거를 직접 가져와서<br>\n뒤에 사용자 경로를 붙이면 되고, 그 외 플랫폼은 그냥 고정된 값을 사용해도 된다.</p>\n<br>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>이걸 처음엔 GPT한테 물어봤는데 내가 프롬프트를 이상하게 줘서 스택에서 찾게 되었다.</p>\n<p><a href=\"https://stackoverflow.com/questions/67859341/flutter-ios-when-apps-update-recompile-stored-image-is-missing\">Flutter-iOS when apps update / recompile stored image is missing</a></p>\n<p>Flutter는 이런 플랫폼 간 몇 가지 설정을 해줘야 하는 부분이 있다.<br>\n문제가 생길 땐 Claude나 GPT에게 물어보자.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A5%BC-%EB%8B%A4%EB%A3%A8%EB%8B%A4%EA%B0%80\">이미지를 다루다가…</a></li>\n<li><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A5%BC-%EB%AA%BB-%EA%B0%80%EC%A0%B8%EC%98%B4\">이미지를 못 가져옴</a></li>\n<li><a href=\"#ios%EB%8A%94-%EB%B3%84%EB%8F%84-%EA%B5%AC%ED%98%84%EC%9D%B4-%ED%95%84%EC%9A%94\">iOS는 별도 구현이 필요</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></li>\n</ul>\n</div>","excerpt":"이미지를 다루다가… 전에 마와셀 1.0 버전대 개발을 하다 겪은 일이다. 마와셀에는 와인 사진 및 셀러, 시음 노트에 이미지를 첨부하는 기능이 있다.  안드로이드에서는 잘 되어서 문제없이 넘어갔다가, iOS도 실제 디바이스에서 테스트를 진행하면서 문제가 없음을 확인했었다. 하지만 iPad용 스크린샷이 필요해서 시뮬레이터에서 구동하다가 문제가 생겼다. 이미지를 못 가져옴 시뮬레이터를 끈 다음 빌드 후 다시 접근하는데 이미지가 없어서 앱 크래시가 발생했다. 물론 2.0에서는 이미지가 없을 때 기본 이미지 표시로 바꾸긴 했다. 마와셀의 이미지는 파일명만 가져와서 저장을 하게 된다. 경로의 경우 조립해서 사용하는 방식을 사용했다. 로직에는 문제가 없었고, 뭔가 이상함을 느낀 나는 몇 가지 로그를 남기며 테스트를 했다. 그 결과 시뮬레이터의 이미지 경로가 계속 변경함을 찾을 수 있었다. 첫 번째 테스트 빌드 하였을 때 경로 /Users/testMan/Library/Developer/Core…","frontmatter":{"date":"2024.08.14","title":"Flutter에서 이미지를 다룰 때 iOS의 경로 문제 (Stored image is missing)","categories":"dart_flutter","emoji":"🫠"},"fields":{"slug":"/dart_flutter/240814_ios-photo/"}},"next":{"id":"78623a85-76cc-5897-a039-f08f0f2f114d","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 667px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVQoz3WRQU6DUBCGWXkGD+U9vIFbb+DSG7gycekFXBitwQRcUEgTIEoFQQtF2hLmfQbo00LrJJP3Mu+bP/PmN0QpdOirUmqUwi4nstszZI22GJSCkzcd0DQN/0W2anBz2XJykDWiSrhwa6YVfOcLJpMnoijq0nEcgiAgDEOKRc7JlcPR6TV3L69IvWL+HhPHMWmakmVZL7hWcP7wya37BZuKt2iO53nYtt2dpmliWRbrsuTsccnx5ZSb+xmomjTL8H2fJEkoigIR6b8cfix5niV7exlHWwk2f4yMmG6HQ1MOC+m33rUhM+7pJmxFtXP7DusG9TuVFj/E/QBlrxtrR+aZjQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2cf2ed8b48f804d8174ffc3a202929cc/7c297/thumbnail_flutter.webp 180w,\n/static/2cf2ed8b48f804d8174ffc3a202929cc/33ecc/thumbnail_flutter.webp 360w,\n/static/2cf2ed8b48f804d8174ffc3a202929cc/03032/thumbnail_flutter.webp 667w\"\n              sizes=\"(max-width: 667px) 100vw, 667px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2cf2ed8b48f804d8174ffc3a202929cc/e9ea2/thumbnail_flutter.png 180w,\n/static/2cf2ed8b48f804d8174ffc3a202929cc/53918/thumbnail_flutter.png 360w,\n/static/2cf2ed8b48f804d8174ffc3a202929cc/e31cc/thumbnail_flutter.png 667w\"\n            sizes=\"(max-width: 667px) 100vw, 667px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2cf2ed8b48f804d8174ffc3a202929cc/e31cc/thumbnail_flutter.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"예전에는-잘-사용하던-willpopscope\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%A0%84%EC%97%90%EB%8A%94-%EC%9E%98-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8D%98-willpopscope\" aria-label=\"예전에는 잘 사용하던 willpopscope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예전에는 잘 사용하던 WillPopScope</h2>\n<p>플러터(Flutter)를 개발하다 보면, 보통 iOS, Android 두 플랫폼을 대상으로 개발을 한다.</p>\n<p>iOS는 뒤로가기 라는게 없고, 바로 홈으로 돌아가지만,<br>\n안드로이드의 경우 물리(또는 소프트 버튼)을 통해서 뒤로 가기를 할 수 있다.</p>\n<p>이런 조작을 보통 네비게이션 조작으로 보는데 WillPopScope의 경우 네비게이션 조작을 돕는 기능이라 할 수 있다.</p>\n<p>보통 맨 최 상위 위젯에 아래와 같이 보통 작성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"dart\"><pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"token keyword\">return</span> <span class=\"token class-name\">WillPopScope</span><span class=\"token punctuation\">(</span>\n      onWillPop<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">_onBackKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        child<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Scaffold</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>근데 저 코드를 사용하면 아래와 같은 경고가 뜬다.</p>\n<blockquote>\n<p>‘WillPopScope.new’ is deprecated and shouldn’t be used. Use PopScope instead. This feature was deprecated after v3.12.0-1.0.pre.</p>\n</blockquote>\n<p>3.12.0-1 부터 Deprecated 되니 대안으로 <strong>PopScope</strong>를 사용하라고 한다.</p>\n<br>\n<h2 id=\"왜-사라짐\" style=\"position:relative;\"><a href=\"#%EC%99%9C-%EC%82%AC%EB%9D%BC%EC%A7%90\" aria-label=\"왜 사라짐 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>왜 사라짐?</h2>\n<p>이건 안드로이드가 올라가면서 안드로이드 14 (API 34)부터 <strong>Predictive Back Feature</strong>라는게 도입되고,<br>\n이에 따라 기존에 플러터에서 사용하던 WillPopScope의 경우 호환되지 않아 Deprecated 된다고 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// Copyright 2014 The Flutter Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.</code></pre></div>\n<p>주석만 봐도 14년에 만들어서 잘 사용하던 건데 아무래도 재개발 하는게 더 싸게 먹힌 것 같다.</p>\n<br>\n<h3 id=\"predictive-back-feature\" style=\"position:relative;\"><a href=\"#predictive-back-feature\" aria-label=\"predictive back feature permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Predictive Back Feature?</h3>\n<p>간단히 설명하자면 뒤로 가기 제스쳐를 할 때 뒤에 있던(또는 현재 화면 이전에 있던) 화면을 미리 보여주는 기능이다.<br>\n그냥 iOS에서 스와이프 하면 보이는 기능이랑 유사한 거라 보면 된다.</p>\n<p>궁금한 분은 <a href=\"https://youtu.be/Elpqr5xpLxQ?si=YyALmbrkHhffwlIK\">구글의 공식 유튜브</a>를 참고하자.</p>\n<br>\n<h2 id=\"popscope\" style=\"position:relative;\"><a href=\"#popscope\" aria-label=\"popscope permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PopScope</h2>\n<p>얘는 24년에 나온 따끈따끈한 API다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// Copyright 2014 The Flutter Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.</code></pre></div>\n<p>PopScope도 당연히 위젯인데 대략 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"dart\"><pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PopScope</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">StatefulWidget</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/// Creates a widget that registers a callback to veto attempts by the user to</span>\n  <span class=\"token comment\">/// dismiss the enclosing [ModalRoute].</span>\n  <span class=\"token keyword\">const</span> <span class=\"token class-name\">PopScope</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">,</span>\n    required <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>canPop <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onPopInvoked<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>child의 경우 당연히 필요한 위젯이고, <strong>canPop</strong>과 <strong>onPopInvoked</strong> 두 가지가 있는데 어렵지 않다.</p>\n<br>\n<h3 id=\"canpop\" style=\"position:relative;\"><a href=\"#canpop\" aria-label=\"canpop permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>canPop</h3>\n<p>말 그대로 뒤로 넘어갈 수 있는지 여부를 나타내는 파라메타다.<br>\n기본 값은 <strong>true</strong>로 되어 있지만, 사용자가 특정 이벤트에 뒤로 가기를 막아야 할 경우 false를 주면 된다.</p>\n<p>보통 로딩 같은 곳에서 많이 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"dart\"><pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"token keyword\">return</span> <span class=\"token class-name\">PopScope</span><span class=\"token punctuation\">(</span>\n      canPop<span class=\"token punctuation\">:</span> <span class=\"token operator\">!</span>loadingProvider<span class=\"token punctuation\">.</span>isLoading<span class=\"token punctuation\">,</span>\n      onPopInvoked<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>bool isPop<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">///</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      child<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Stack</span><span class=\"token punctuation\">(</span>\n        children<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>동적으로 로딩 중일 때는 뒤로 가기를 막고,<br>\n로딩이 끝나면 이동하게끔 해줄 수 있다.</p>\n<br>\n<h3 id=\"onpopinvoked\" style=\"position:relative;\"><a href=\"#onpopinvoked\" aria-label=\"onpopinvoked permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>onPopInvoked</h3>\n<p>이 메서드는 뒤로 가기가 동작했을 때 호출되는 콜백 메서드다.<br>\n참고로 canPop에 값이 false던 true던 무조건 호출된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"dart\"><pre class=\"language-dart\"><code class=\"language-dart\">onPopInvoked<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>bool isPop<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">///</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>저 isPop의 전달 값이 뒤로 가기 동작에 대한 결과를 가진다.<br>\ntrue면 성공, false면 실패로 된다.</p>\n<br>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>뭐 복잡할 줄 알았는데 간단하다.<br>\n사실 내가 풀어서 쓴 것 보다 공식 문서를 보면 더 쉽다. -_-;;</p>\n<ul>\n<li><a href=\"https://docs.flutter.dev/release/breaking-changes/android-predictive-back#migration-guide\">WillPopScope to PopScope 마이그레이션</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%98%88%EC%A0%84%EC%97%90%EB%8A%94-%EC%9E%98-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8D%98-willpopscope\">예전에는 잘 사용하던 WillPopScope</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%99%9C-%EC%82%AC%EB%9D%BC%EC%A7%90\">왜 사라짐?</a></p>\n<ul>\n<li><a href=\"#predictive-back-feature\">Predictive Back Feature?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#popscope\">PopScope</a></p>\n<ul>\n<li><a href=\"#canpop\">canPop</a></li>\n<li><a href=\"#onpopinvoked\">onPopInvoked</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2024.08.14","title":"WillPopScope 사용 시 Deprecated 가 뜨는 경고","categories":"dart_flutter","emoji":"💥"},"fields":{"slug":"/dart_flutter/240814_willpopscope-deprecated/"}},"prev":{"id":"9653a903-51c0-579f-b1c8-4e5f1a8e22d4","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACVElEQVQoz12R/U8ScRzH719pzXKhyJOtIhduF0/m96DamvMH12qrH5qzUOBOGzRtWM21HtjSZjnzB8XCmpOslaZxd5x4irIacBwClg8BB6j5gGw1IaO1vX96b6/Pe3t9ICFKClGS14QfvuEsacKLdXiuIQS5/m/EGCHG8OJGmm+gdE+7vfTFrbAaKjMQUhPVTyw5fVzXx2iLLeDwxEyDwVI9IcL2MBFKSDD8iN5d3EjXPRiY+HxtJ6zcXFBzDAIJUbLMSNQ8nmNXfirb6Q/e+OhcrOLWlMBIijBSguF8A1WkmwXtI/b3xnX2zE5YyTEIxyCpIIBEGFmiJ06aKTqUEmOk1DQ1TP9weGJ8g1OIuop0s6fMY51Dt1d92kxEwQVA3I8kgyCVCyRCyVIDIWt1j3+JHzdRN23MW89KP7F0oIEub3a29T1c8NZko/LtRZAOabcXkZ1vSJrdh/d9kJWtbiFKKCxu0PGV10TVP3numb60G5FvhKpSrGagG57/pOq6L3t0R5bwV+f5P7AIJQRGJ0/vPnh9+vxd29hk/XZYtbWgTjAIFwBpFhgbpJ0dlWeR8jd98Nq/y3krh3SzVRbH4Ci2HqrORApWUkHwK6ZtbpTiI8qXz+D6qyfmJ1SbESTJAEiAkkW6mQrzuPWVZdV3bjcqTwVBHksyYCOMBFzqtpaKy3XH7D2w9Z6s9sLRoV44u6ThAgCSYLi51xqcr81G5WtsdWJ/LZ80CxJ+8PoFPDmsSASAvQd+N3i6IIxyXdmN7llJMIUf/MdnlzV5ydllTeZ74fpvzaCO5tNBsMEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/95bf3555554f492f0636500f50d6e883/7c297/thumbnail_jsts.webp 180w,\n/static/95bf3555554f492f0636500f50d6e883/33ecc/thumbnail_jsts.webp 360w,\n/static/95bf3555554f492f0636500f50d6e883/df77d/thumbnail_jsts.webp 720w,\n/static/95bf3555554f492f0636500f50d6e883/5c666/thumbnail_jsts.webp 1080w,\n/static/95bf3555554f492f0636500f50d6e883/95f20/thumbnail_jsts.webp 1440w,\n/static/95bf3555554f492f0636500f50d6e883/64296/thumbnail_jsts.webp 1600w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/95bf3555554f492f0636500f50d6e883/e9ea2/thumbnail_jsts.png 180w,\n/static/95bf3555554f492f0636500f50d6e883/53918/thumbnail_jsts.png 360w,\n/static/95bf3555554f492f0636500f50d6e883/242a6/thumbnail_jsts.png 720w,\n/static/95bf3555554f492f0636500f50d6e883/b4ad3/thumbnail_jsts.png 1080w,\n/static/95bf3555554f492f0636500f50d6e883/89066/thumbnail_jsts.png 1440w,\n/static/95bf3555554f492f0636500f50d6e883/42cbc/thumbnail_jsts.png 1600w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/95bf3555554f492f0636500f50d6e883/242a6/thumbnail_jsts.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"dart에서-자주-쓴-optional\" style=\"position:relative;\"><a href=\"#dart%EC%97%90%EC%84%9C-%EC%9E%90%EC%A3%BC-%EC%93%B4-optional\" aria-label=\"dart에서 자주 쓴 optional permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dart에서 자주 쓴 Optional</h2>\n<p>간만에 글을 남긴다.<br>\n최근 마와셀 앱 업데이트 후 와인 정보를 위해 웹쪽을 다시 개발하고 있다.</p>\n<p>코로나 걸려서 잠시 쉬다가, 침대에서 빈둥거리기도 시간이 아까워서 누워있다가,<br>\n옵시디언에 정리해둔 내용을 올려둔다.</p>\n<p>웹(Typescript)을 개발하다가 앱(Dart)로 넘어갔을 때 Typescript와 매우 흡사해서 바로 사용하는데 큰 문제는 없었다.<br>\n그 중 Dart의 유용한 기능 중 하나가 옵셔널(Optional)이었다.</p>\n<p>Dart의 경우 버전이 올라가면서 Null-Safe한 특성이 추가되었는데,<br>\n아래와 같이 사용된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"dart\"><pre class=\"language-dart\"><code class=\"language-dart\"><span class=\"token class-name\">WineModel</span> <span class=\"token function\">getWineData</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token operator\">?</span> wineItemId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그렇다.<br>\n이 기능은 Typescript에도 존재하는 기능이다.</p>\n<p>Javascript를 사용할 때는 뭐 그냥 null이던 undefined던 타입 체킹을 안하고,<br>\n무식하게(?) 그냥 쓰기에 볼 일이 없지만, Typescript를 사용한다면 타입 명시가 중요하다.</p>\n<p>근데 사용하다 보면 특정 값의 속성이 있어도, 없어도 무관한 값이 있다.<br>\n그 경우 옵셔널(Optional)을 사용하게 된다.</p>\n<br>\n<h3 id=\"옵셔널-속성-optional-property\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%94%EB%84%90-%EC%86%8D%EC%84%B1-optional-property\" aria-label=\"옵셔널 속성 optional property permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵셔널 속성 (Optional Property)</h3>\n<p>나같은 경우 타입을 지정할 때 인터페이스를 사용한다.<br>\n그 안의 속성에 옵셔널을 지정할 때 위에서 보인 Dart와 동일하게 <b>?</b>를 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">WineryInfo</span> <span class=\"token punctuation\">{</span>\n  wineryName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  description<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  country<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  address<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 선언된 타입을 사용한다면 아래와 같이 사용된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> mollydookerWineryInfo<span class=\"token operator\">:</span> WineryInfo <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  wineryName<span class=\"token operator\">:</span> <span class=\"token string\">'Mollydooker'</span><span class=\"token punctuation\">,</span>\n  description<span class=\"token operator\">:</span> <span class=\"token string\">'The best of australia winery.'</span><span class=\"token punctuation\">,</span>\n  country<span class=\"token operator\">:</span> <span class=\"token string\">'Australia'</span><span class=\"token punctuation\">,</span>\n  address<span class=\"token operator\">:</span> <span class=\"token string\">'McLaren Vale'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>몰리두커라고 내가 좋아하는 와이너리가 있는데 이렇게 표현할 수 있다.<br>\n근데 만약 Address 정보가 불명인 와이너리 정보가 있다고 가정해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> krugWineryInfo<span class=\"token operator\">:</span> WineryInfo <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  wineryName<span class=\"token operator\">:</span> <span class=\"token string\">'krug'</span><span class=\"token punctuation\">,</span>\n  description<span class=\"token operator\">:</span>\n    <span class=\"token string\">'The House of Krug was founded in Reims by Joseph Krug, a visionary non-conformist with an uncompromising philosophy. His dream was to go beyond the notion of vintage and craft the very best Champagne he could offer, every single year, regardless of climate variations'</span><span class=\"token punctuation\">,</span>\n  country<span class=\"token operator\">:</span> <span class=\"token string\">'France'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>샴페인의 끝판왕인 크룩 와이너리 정보다.<br>\n크룩 와이너리의 경우 주소(address) 속성이 없다.<br>\n하지만 address의 경우 옵셔널(Optional) 값이기에 없어도 무방하다.</p>\n<br>\n<h3 id=\"옵셔널-매개변수-optional-parameter\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%94%EB%84%90-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-optional-parameter\" aria-label=\"옵셔널 매개변수 optional parameter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵셔널 매개변수 (Optional Parameter)</h3>\n<p>함수나 메서드에 전달되는 매개변수(Parameter)에도 옵셔널을 사용할 수 있다.<br>\n이 경우 값이 없을 때 <strong>undefined</strong>로 처리된다.</p>\n<p>약간 억지스러운 예제이긴 한데.. -_-;;<br>\n와인 정보를 가져오는 함수가 있다고 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> getWineInfo <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>wineName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> wineDes<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> WineInfo <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> wineData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getWineData</span><span class=\"token punctuation\">(</span>wineName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> wineData<span class=\"token punctuation\">,</span> description<span class=\"token operator\">:</span> wineDes <span class=\"token operator\">||</span> <span class=\"token string\">'-'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>저기서 보면 <strong>wineDes</strong>라는 파라메터가 옵셔널하여 주는 값에 따라 반환 값이 변한다.<br>\n만약 wineDes 값이 없다면 하이픈(-) 표시로 대체해서 적용된다.</p>\n<br>\n<h3 id=\"옵셔널-체이닝-optional-chaining\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%94%EB%84%90-%EC%B2%B4%EC%9D%B4%EB%8B%9D-optional-chaining\" aria-label=\"옵셔널 체이닝 optional chaining permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵셔널 체이닝 (Optional Chaining)</h3>\n<p>이 문법은 Typescript 3.7 부터 도입되었다.<br>\n해당 객체의 속성 또는 함수(또는 메서드)가 없는 경우 <strong>undefined</strong>를 반환하는 방법을 제공한다.</p>\n<p>아래의 예제 코드를 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> someWineData <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  itemId<span class=\"token operator\">:</span> <span class=\"token string\">'france_wine_0000001'</span><span class=\"token punctuation\">,</span>\n  wineName<span class=\"token operator\">:</span> <span class=\"token string\">\"Blanc d'Assemblage Brut Nature Champagne\"</span><span class=\"token punctuation\">,</span>\n  wineType<span class=\"token operator\">:</span> <span class=\"token string\">'Champagne'</span><span class=\"token punctuation\">,</span>\n  wineryInfo<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    wineryName<span class=\"token operator\">:</span> <span class=\"token string\">'Chavost'</span><span class=\"token punctuation\">,</span>\n    wineryDes<span class=\"token operator\">:</span>\n      <span class=\"token string\">'Our Champagnes are singular and atypical wines, their own identity comes from a mastered vinification, and the absolute absence of added sulphites.'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> wineName <span class=\"token operator\">=</span> someWineData<span class=\"token punctuation\">.</span>wineName<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> wineryAddress <span class=\"token operator\">=</span> someWineData<span class=\"token punctuation\">.</span>wineryInfo<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">;</span></code></pre></div>\n<p>여기서 <strong>wineName</strong>속성의 경우 값이 있어서 Blanc d’Assemblage Brut Nature Champagne 라는 값이 정상적으로 출력된다.</p>\n<p>하지만 <strong>wineryAddress</strong>속성의 경우 wineryInfo안에 address 값은 존재하지 않기에 undefined가 반환된다.</p>\n<p>옵셔널 체이닝은 다음과 같은 상황에서 유용하다.</p>\n<ul>\n<li>중첩된 객체의 속성에 접근할 때 해당 속성이 존재하는지 알 수 없는 경우</li>\n<li>함수(메서드)가 존재하지 않을 수 있는 객체에서 메서드를 호출할 때</li>\n</ul>\n<br>\n<h3 id=\"널-병합-연산자--nullish-coalescing-operator\" style=\"position:relative;\"><a href=\"#%EB%84%90-%EB%B3%91%ED%95%A9-%EC%97%B0%EC%82%B0%EC%9E%90--nullish-coalescing-operator\" aria-label=\"널 병합 연산자  nullish coalescing operator permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>널 병합 연산자 (??) (Nullish Coalescing Operator)</h3>\n<p>?를 하나만 사용하면 삼항연산자인데 하나 더 붙이면 널 병합 연산자가 된다.<br>\ndart에서 아주 잘 쓰고 있는 문법 중 하나인데 아래와 같이 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getWineInfo</span><span class=\"token punctuation\">(</span>wineModel<span class=\"token operator\">:</span> WineModel<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> WineInfo <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    wineName<span class=\"token operator\">:</span> wineModel<span class=\"token punctuation\">.</span>wineName<span class=\"token punctuation\">,</span>\n    wineDes<span class=\"token operator\">:</span> wineModel<span class=\"token operator\">?.</span>wineDes <span class=\"token operator\">??</span> <span class=\"token string\">'some wine.'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>저 함수를 보면 WineInfo라는 객체를 반환한다.<br>\n근데 <strong>wineDes</strong>속성의 경우 모델 값이 없다면 기본 값을 대신 넣어준다.</p>\n<br>\n<h3 id=\"옵셔널-반환-타입-optional-return-type\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%94%EB%84%90-%EB%B0%98%ED%99%98-%ED%83%80%EC%9E%85-optional-return-type\" aria-label=\"옵셔널 반환 타입 optional return type permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵셔널 반환 타입 (Optional Return Type)</h3>\n<p>데이터베이스에서 값을 조회할 때 해당 값이 없을 수도 있다.<br>\nReact 예제를 가져올까 했는데 딱 떠오르는게 없고 해서 백엔드 쪽으로…<br>\n(이것도 약간 어거지 코드다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyWineFindWineNameRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MyWineFindWineNameOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">InjectModel</span></span><span class=\"token punctuation\">(</span>MyWine<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> myWineEntity<span class=\"token operator\">:</span> Model<span class=\"token operator\">&lt;</span>MyWine<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>params<span class=\"token operator\">:</span> MyWineFindWineNameInputDto<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>MyWineEntity <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>wineNameKr <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myWineEntity<span class=\"token punctuation\">.</span><span class=\"token function\">findOne</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> wineNameKr<span class=\"token operator\">:</span> params<span class=\"token punctuation\">.</span>wineNameKr <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myWineEntity<span class=\"token punctuation\">.</span><span class=\"token function\">findOne</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> wineNameEn<span class=\"token operator\">:</span> params<span class=\"token punctuation\">.</span>wineNameEn <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/// 기타 작업 후</span>\n<span class=\"token comment\">///...</span>\n\n<span class=\"token keyword\">const</span> wines <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myWineFindWineNameRepository<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> wineNameEn <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>wines<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Found wines:'</span><span class=\"token punctuation\">,</span> wines<span class=\"token punctuation\">.</span>wineNameEn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Not found wine'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>약간 어거지 코드이긴 한데..<br>\n와인 이름을 검색해서 특정 조건에서 값을 찾을 수 없다면, 반환 타입에 undefined를 포함시킬 수 있다.</p>\n<p>사실 이렇게 안히고, Repository에서는 저렇게 반환하고,<br>\nInbound 서비스 단에서 와인 데이터 유무를 확인하여 처리할 수 있다.</p>\n<h2 id=\"요약\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%95%BD\" aria-label=\"요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요약</h2>\n<p>옵셔널을 요약하면 다음과 같다.</p>\n<ul>\n<li>?를 사용해 옵션 속성 또는 매개변수를 선언할 수 있다.</li>\n<li>옵셔널 체이닝(?.)으로 안전하게 객체의 속성에 접근할 수 있다.</li>\n<li>?? 연산자를 사용해 null 또는 undefined인 경우 기본값을 설정할 수 있다.</li>\n<li>옵셔널 속성이나 매개변수를 사용할 때 기본값 설정, 조건문, 옵셔널 체이닝 등을 활용해 안전하게 처리해야 한다.</li>\n</ul>\n<p>옵시디언에 썼던 자료에 살 붙이고 하니 글이 늘었다.<br>\n게다가 코로나 약 기운이 돌아서 나중에 다시 검수해야 할듯…</p>","frontmatter":{"date":"2024.08.27","title":"Typescript에서 옵셔널(Optional) 사용하기","categories":"js_ts","emoji":"📦"},"fields":{"slug":"/js_ts/240827_optional/"}},"site":{"siteMetadata":{"siteUrl":"https://elfinlas.github.io","comments":{"utterances":{"repo":"elfinlas/blog_utterances"}},"projects":[{"title":"마와셀(웹) - 와인 가격 비교","description":"와인 가격 비교 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223393940649","github":"","web":"https://appmyc.info","googlePlay":"","appStore":""}},{"title":"마와셀(엡) - 와인과 셀러 관리, 시음노트","description":"보유한 와인의 관리, 시음노트 작성, 보유 와인 셀러의 관리 어플리케이션","techStack":["Dart","Flutter","hive","provider"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223531933037","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.myc","appStore":"https://itunes.apple.com/kr/app/apple-store/6474965246"}},{"title":"흑우집합소(웹) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223059966682","github":"","web":"https://bcow.world/","googlePlay":"","appStore":""}},{"title":"흑우집합소(앱) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Dart","Flutter","drift","provider"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223232966579","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.bcow_world","appStore":"https://itunes.apple.com/kr/app/apple-store/6470312130"}}]}}},"pageContext":{"slug":"/dart_flutter/240814_ios-photo/","nextSlug":"/dart_flutter/240814_willpopscope-deprecated/","prevSlug":"/js_ts/240827_optional/"}},"staticQueryHashes":["1186322783","1321405810","3649515864"]}
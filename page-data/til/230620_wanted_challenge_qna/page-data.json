{"componentChunkName":"component---src-templates-post-jsx","path":"/til/230620_wanted_challenge_qna/","result":{"data":{"site":{"siteMetadata":{"title":"MHLab blog","author":"MHLab"}},"markdownRemark":{"id":"ed7e74dc-192d-5401-b402-cf4bf3fc8229","excerpt":"이번 포스팅은... 저번 프리온보딩은 제대로 참여를 못했다. 주말이 껴 있는 부분도 있었고, 개인적인 사유로 좀 많이 바빴다. 이번 7월 챌린지는 예전에…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b64a0e98a67addc240abf85339689e6c/76cea/thumbnail.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.668711656441715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC6klEQVR42nWSWU9TURSF+QH64IjGISJiHOqAOCDBKTGooEwOdcBioS3QgVuoLUU0IqAIQZxiIlEUIcADsTIoilFBjYljnKBqVSCAiRoT0WiiCHyeWwHxwYd1d/Y9a6+z917Ho8duph/dAr02M98yzLw6buLhST3XT+s4XxTLqWIVObUqSh8Y3bxfKZIbg+tleAyIicOfqRKYJO46JFTt29l2LZItteFEV4SSVLGB/dVRVN6T6N5jgd1W2GP9j6AQ602z0JtuE0Q7H05aeX/Oyo9DO+nJFjE9iS92I51mPa8NMbgE6jZHclkZAalJ7o4HBOXOSEumRR/LpU0RnFkbxFVlJNmLAzi8bBn2BfPRKhSEeHkR7O3FKu9JzBg1gjVTJuM/bizvjFpRbxET9gn+tCVCRirZywNRjB6Jz/Bh+HqOImyqN/PGeDJ+6BA0cxTYFvqxcsI4Qn0m4ztyBBFeE0mY7kOXvPfBHXbJHe61cTDQn6xFfmim+ZC5eAHSXAVlYcEUCtRFKblvNlCj13E7MYGXuQd4lLUPV1EhLWINg8f26JGTnQY+HcmltfgsTcfyacw7SJujgqcFJ7iRl0P90Xwe3Wzgdn09zU4nDbduUVNdTWllFUVrV0F6Cl19jnt0u0feRcMFB/ZdaTx73khVzUWcrtdUV1VxoaSEWoeDa0Ls+KnTVF6+wrnycs6UlRFvTcGxPtQ94V9BtykWrpcUk5WRgd5kxGSxoFGridNq2bpxIxtCQli3dAnBs2Zi8JtL5tIAjL6zORC4iLcJ6j5T+gXFR35Pd6I3I/nPpyBoOYVBK6gLX8PVsNXcU4bTEhvF10Sdu0DmsjcF9tkhK+1PLtY2YEpnsgFXvJoOYX+nxcg3m8R3cdsXETsS4/gkzjtMcXy2GGgWT+udSUdzQgztBi1tAnL+UYr/V9CpjaZRq6JJxJe6HTyOicIVp+aJiK1CpEmj4r0Qd+qiRa7hheA5BU/myv/exMcMuPwbGWZzgk9qwKMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"thumbnail\"\n        title=\"\"\n        src=\"/static/b64a0e98a67addc240abf85339689e6c/a6d36/thumbnail.png\"\n        srcset=\"/static/b64a0e98a67addc240abf85339689e6c/222b7/thumbnail.png 163w,\n/static/b64a0e98a67addc240abf85339689e6c/ff46a/thumbnail.png 325w,\n/static/b64a0e98a67addc240abf85339689e6c/a6d36/thumbnail.png 650w,\n/static/b64a0e98a67addc240abf85339689e6c/76cea/thumbnail.png 799w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1 id=\"이번-포스팅은\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%B2%88-%ED%8F%AC%EC%8A%A4%ED%8C%85%EC%9D%80\" aria-label=\"이번 포스팅은 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이번 포스팅은...</h1>\n<p>저번 프리온보딩은 제대로 참여를 못했다.<br>\n주말이 껴 있는 부분도 있었고, 개인적인 사유로 좀 많이 바빴다.</p>\n<p>이번 7월 챌린지는 예전에 1월인가 프리온보딩을 진행했던 강사님이 다시 진행하신다고 하셨다.<br>\n디스코드를 안나가고 있었는데 다행이었다(?)</p>\n<p><strong>사전과제가 있었는데 이를 정리해서 개인 블로그에 포스팅하고 링크 제출이 있었다.</strong><br>\n매번 이론은 잘 안보고 기능 구현만 했는데...<br>\n이번에 사전 과제를 하면서 한번 정리를 해봐야겠다.</p>\n<p>근데 어렵게 설명하는건 좋아하지 않아서 나름 쉽게 풀고 예시를 들어 설명할 예정이다.</p>\n<h2 id=\"1-csrclient-side-rendering이란-무엇이며-그것의-장단점에-대하여-설명해주세요\" style=\"position:relative;\"><a href=\"#1-csrclient-side-rendering%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B4%EB%A9%B0-%EA%B7%B8%EA%B2%83%EC%9D%98-%EC%9E%A5%EB%8B%A8%EC%A0%90%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-%EC%84%A4%EB%AA%85%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94\" aria-label=\"1 csrclient side rendering이란 무엇이며 그것의 장단점에 대하여 설명해주세요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. CSR(Client-side Rendering)이란 무엇이며, 그것의 장단점에 대하여 설명해주세요.</h2>\n<h3 id=\"csrclient-side-rendering이란-무엇인가\" style=\"position:relative;\"><a href=\"#csrclient-side-rendering%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\" aria-label=\"csrclient side rendering이란 무엇인가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSR(Client-side Rendering)이란 무엇인가?</h3>\n<p>영어에서 표현한바와 같이 <strong>랜더링 작업을 클라이언트(브라우저단)에서 해주는 것</strong>을 의미한다.<br>\n다른 블로그나 문서를 보면 뭔가 어렵고 복잡하게 설명을 하는데 난 이 부분을 쉽게 설명해보겠다.</p>\n<p>웹 브라우저에서 뭔가를 보여주려면 세 가지 요소가 필요하다.</p>\n<p>페이지를 구성하는 <strong>HTML</strong>,<br>\n페이지를 이쁘게 꾸미기 위한 <strong>CSS</strong>,<br>\n그리고 사용자와 상호 작용을 위한 <strong>JS</strong></p>\n<p>이렇게 세 가지 요소가 필요하다.<br>\n이게 있어야 웹 브라우저에서 뭔가를 표현하거나, 사용자와 상호 작용을 할 수 있다.</p>\n<p>일단 웹 페이지는 저 세 가지 요소가 삼위일체(트포?) 마냥 잘 조합되어야 사용자가 비로소 사용할 수 있게 된다.<br>\n조합을 해주는 주체가 서버이면 <strong>SSR</strong>이고, 클라이언트(사용자측)이라면 <strong>CSR</strong>이다.</p>\n<p><strong>CSR</strong>은 저 요소들 중 <strong>HTML</strong>은 최소한의 태그만 포함한 가벼운 형태(body가 비어있는)로 서버에게 받아온다.<br>\n그리고 <strong>JS</strong>를 받아오고, 그 JS를 가지고 리엑트나 뷰를 통해서 HTML을 랜더링 해준다.</p>\n<p>게임으로 설명해보면...<br>\n스타크래프트의 저그 드론이라 생각하면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 190px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a8515d7af5e7f8c06f918d2918a829c6/a2d4f/img02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.50306748466258%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACh0lEQVR42mP4jwr+/fv39w8IAFn/CQEGNJ3/YHr+/f375/dvoCl///4lrPkfWNH1S5d2bNly9OiJL1++QIxDNvcfqnMY4HJA8u+/fw3l5dGOxqEWciXxwcvmz96wduPB/fsI2AzR/Pjh42AHm1ovoz53nnAtvgx7WVlWBjlenlAry8LUrEjfkFVLliM7B6oZ4rELR3YlmOn0FwR0uGuXuuok2CgtzJHwt9Gwl1BXY+HQFeHpb218/eo1XD1c8x8guay/IcxQJ87JttCKc3W5+aYls5pTHHO85K3FxePcPX1tzRP93fo62n79+gWxnwFuzJmTp0LNTWyFxdpL6uZW6O7qtju8ZMK0CTPLwyzrijPOX7524+atK1euNdXUTersgbgcrPkPyNqD25c7CTC4ymgWRyVVRAVMLAi9ODfu6IblDVU1STHRa1av6e7sevr0CVDlvTt3P3z4ANMMcfOkHg9puVQttSgZgTQf57qyst7mmlkTJlSUVORk58yeOcvDxf3gwYNwl4I0Q6L30f1H3vpqzYFCq4JY6iP8t+8/cvXyle6OnrqaWlUZmfDwcKCa9qZWPxevPXv2IAIM4uadm7duWr747O6yjhCu6b1Tnz170lBdu3zJktevX0+bOuXhw4cgpy1YnJOYnpac+ujRI2iAQbz+5NHj33/+v3h8I9hU4dyZ83fv3m2sa4gMDT+4H+HOly9fHty/f/rkKQjNsETy/8+f30BGS1npuZMngQxgfPS0d/u7+rY1tG7ZtBniu6dPHl2/ehWeThjQssSDu3dePHsOEfz29dvkvkmL5i9aNH/hquUrPn38hJy80HMVZk749fvX06dPnz97/vXrV7Rsh0UzSQAA+mUi2ToT38QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"thumbnail\"\n        title=\"\"\n        src=\"/static/a8515d7af5e7f8c06f918d2918a829c6/a2d4f/img02.png\"\n        srcset=\"/static/a8515d7af5e7f8c06f918d2918a829c6/222b7/img02.png 163w,\n/static/a8515d7af5e7f8c06f918d2918a829c6/a2d4f/img02.png 190w\"\n        sizes=\"(max-width: 190px) 100vw, 190px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이 드론은 스토리상 저그 건물의 유전정보를 모두 가지고 있다고 한다.<br>\n그래서 오버로드의 명령에 따라 필요한 건물로 변태를 한다.</p>\n<p>CSR도 얘랑 비슷하다.<br>\n맨 처음 서버에서 저 드론을 하나 받았다고 생각해보자.<br>\n그럼 저 드론은 아래와 같이 다양한 형태로 변태가 가능하다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 540px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/79f4d3a54ae1486da21884908a809428/09d21/img01.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.84662576687117%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHMcKaJA//EABoQAQABBQAAAAAAAAAAAAAAAAABEBESITH/2gAIAQEAAQUCpLjO7b//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAbEAACAgMBAAAAAAAAAAAAAAABEQBBECExUf/aAAgBAQABPyGhgA9mP1VwcEIXLU//2gAMAwEAAgADAAAAEOMf/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Qp//EABYRAAMAAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPxBDlP/EABoQAAMAAwEAAAAAAAAAAAAAAAABESFBgTH/2gAIAQEAAT8QSWDE0OLd4aAcGyeJT4IoVFRbiH//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"thumbnail\"\n        title=\"\"\n        src=\"/static/79f4d3a54ae1486da21884908a809428/09d21/img01.jpg\"\n        srcset=\"/static/79f4d3a54ae1486da21884908a809428/d2f63/img01.jpg 163w,\n/static/79f4d3a54ae1486da21884908a809428/c989d/img01.jpg 325w,\n/static/79f4d3a54ae1486da21884908a809428/09d21/img01.jpg 540w\"\n        sizes=\"(max-width: 540px) 100vw, 540px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>그렇다...<br>\n서버로부터 드론(<strong>HTML</strong>과 <strong>JS</strong>를 내포(內包)한 것)을 내려받고,<br>\n드론은 내포된 <strong>JS</strong>를 통해 <strong>HTML</strong>을 랜더링한다.</p>\n<p>이 정도 설명하면 <strong>CSR</strong>는 이해가 되었을 것이다.</p>\n<p>번외로...<br>\n**SSR(Server-Side Rendering)**은 프로토스의 프로브가 소환하는 건물이라 보면 된다.</p>\n<p>스토리상...<br>\n프로토스 건물은 아이어에서 이미 완성된 건물을 포탈을 통해 이동시키는거다.</p>\n<p>즉 프로브(클라이언트)가 서버측(아이어)에게 요청을 하면,<br>\n서버측에서 랜더링을 다한 <strong>HTML</strong>과 <strong>JS</strong>를 클라이언트에게 주는 것이다.</p>\n<p>급조한 거라서 설명이 뭔가 매끄럽지 못한데 -_-;;<br>\n대충 이 정도면 감을 잡았으리라 생각한다.</p>\n<br>\n<h3 id=\"csrclient-side-rendering의-장단점\" style=\"position:relative;\"><a href=\"#csrclient-side-rendering%EC%9D%98-%EC%9E%A5%EB%8B%A8%EC%A0%90\" aria-label=\"csrclient side rendering의 장단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSR(Client-side Rendering)의 장단점</h3>\n<p>CRS의 장단점은 아래와 같다.</p>\n<h4 id=\"장점\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%A0%90\" aria-label=\"장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장점</h4>\n<ol>\n<li>다른 페이지로 이동하거나 추가 페이지 로드 시간이 빠르다.\n<ul>\n<li>이미 서버로부터 모든 자원(JS,CSS)을 내려받았기 때문에 추가적인 자원을 로드하는데 시간이 필요하지 않다.</li>\n</ul>\n</li>\n<li>UI를 전체적으로 다시 로드할 필요가 없다.\n<ul>\n<li>변경되는 부분만 업데이트가 가능하다.</li>\n</ul>\n</li>\n</ol>\n<h4 id=\"단점\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90\" aria-label=\"단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단점</h4>\n<ol>\n<li>HTML 파일만 받고, 클라이언트에서 랜더링을 하기에 SEO(search engine optimization)에 불리하다.\n<ul>\n<li>크롤링 봇은 HTML 파일을 보고 판단하는데 내용이 비어있다.</li>\n</ul>\n</li>\n<li>첫 로드 시 모든 로직을 담은 파일(JS)를 받기에 첫 진입 속도가 느리다.\n<ul>\n<li>이와 연계되는게 클라이언트의 하드웨어 및 소프트웨어에 의존도가 높아져서, 사용자마다 페이지 로드 시간이 다를 수 있다.</li>\n</ul>\n</li>\n<li>JS가 동작하지 않는 브라우저 환경에서의 문제\n<ul>\n<li>물론 JS가 돌아가지 않는 브라우저가 어디있겠냐지만, 보안이나 어떤 문제로 인해 동작할 수 없는 환경이 있을 수 있다.</li>\n</ul>\n</li>\n</ol>\n<br>\n<h2 id=\"2-spasingle-page-application로-구성된-웹-앱에서-ssrserver-side-rendering이-필요한-이유에-대하여-설명해주세요\" style=\"position:relative;\"><a href=\"#2-spasingle-page-application%EB%A1%9C-%EA%B5%AC%EC%84%B1%EB%90%9C-%EC%9B%B9-%EC%95%B1%EC%97%90%EC%84%9C-ssrserver-side-rendering%EC%9D%B4-%ED%95%84%EC%9A%94%ED%95%9C-%EC%9D%B4%EC%9C%A0%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-%EC%84%A4%EB%AA%85%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94\" aria-label=\"2 spasingle page application로 구성된 웹 앱에서 ssrserver side rendering이 필요한 이유에 대하여 설명해주세요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. SPA(Single Page Application)로 구성된 웹 앱에서 SSR(Server-side Rendering)이 필요한 이유에 대하여 설명해주세요.</h2>\n<p>SPA는 가만 보기에 CRS와 유사하다.<br>\n어찌보면 SPA의 구현 방식중 CRS나 SSR이 있다고 생각하면 편하다.</p>\n<p>근데 SPA에서 SSR이 필요한 이유는 CRS의 단점을 극복하기 위함이라 보면 된다.<br>\n자주 언급되는 SEO의 경우 CRS에서 극복이 어느정도 가능하지만, 손쉽게 처리하기 어렵다.</p>\n<p>브라우저의 호환성도 이슈가 될 수 있다.<br>\nSPA의 경우 클라이언트의 브라우저에 100% 의존하기에 몇몇 자바스크립트 문법의 경우 브라우저마다 다르게 동작한다.<br>\nSSR을 사용할 경우 서버에서 초기 페이지에 대해 렌더링을 해주기에 이 문제를 어느정도 완화시킬 수 있다.</p>\n<p>마지막으로 보안 문제가 있을 수 있다.<br>\n클라이언트에서 서버에게 Ajax나 Axios 등 요청으로 권한 검사를 해줄 수 있다.<br>\n하지만 권한이 있는 사용자만 접근해야 하는 페이지가 있거나, 권한이 있어야 볼 수 있는 항목을 처리해야 할 경우 문제가 생길 수 있다.<br>\n보안 처리를 클라이언트에게 맡기는 경우 상당한 리스크가 생긴다.</p>\n<p>SSR을 사용할 경우 서버 측에서 초기 렌더링 시 보안 로직을 수행하여 결과를 다르게 줄 수 있는 장점이 있다.</p>\n<br>\n<h2 id=\"3-nextjs-프로젝트에서-yarn-startor-npm-run-start-스크립트를-실행했을-때-실행되는-코드를-nextjs-github-레포지토리에서-찾은-뒤-해당-파일에-대한-간단한-설명을-첨부해주세요\" style=\"position:relative;\"><a href=\"#3-nextjs-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%97%90%EC%84%9C-yarn-startor-npm-run-start-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%96%88%EC%9D%84-%EB%95%8C-%EC%8B%A4%ED%96%89%EB%90%98%EB%8A%94-%EC%BD%94%EB%93%9C%EB%A5%BC-nextjs-github-%EB%A0%88%ED%8F%AC%EC%A7%80%ED%86%A0%EB%A6%AC%EC%97%90%EC%84%9C-%EC%B0%BE%EC%9D%80-%EB%92%A4-%ED%95%B4%EB%8B%B9-%ED%8C%8C%EC%9D%BC%EC%97%90-%EB%8C%80%ED%95%9C-%EA%B0%84%EB%8B%A8%ED%95%9C-%EC%84%A4%EB%AA%85%EC%9D%84-%EC%B2%A8%EB%B6%80%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94\" aria-label=\"3 nextjs 프로젝트에서 yarn startor npm run start 스크립트를 실행했을 때 실행되는 코드를 nextjs github 레포지토리에서 찾은 뒤 해당 파일에 대한 간단한 설명을 첨부해주세요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Next.js 프로젝트에서 yarn start(or npm run start) 스크립트를 실행했을 때 실행되는 코드를 Next.js Github 레포지토리에서 찾은 뒤, 해당 파일에 대한 간단한 설명을 첨부해주세요.</h2>\n<p>먼저 이 질문을 이해하기 앞서, Next.JS가 아닌 npm이나 Node의 진입점이 궁금했다.<br>\n정확히 이야기하면, **yarn start(or npm run start)**이 명령어를 줬을 때 실행하는 최초 시작점이랄까?</p>\n<p>Spring의 경우 Main함수가 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Slf4j</span>\n<span class=\"token annotation punctuation\">@SpringBootApplication</span>\n<span class=\"token annotation punctuation\">@EnableAspectJAutoProxy</span>\n<span class=\"token annotation punctuation\">@EnableScheduling</span>\n<span class=\"token annotation punctuation\">@ServletComponentScan</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OnlydreamApplication</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">CommandLineRunner</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ApplicationRunner</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">ApiContextInitializer</span><span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\">SpringApplication</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OnlydreamApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\n\t<span class=\"token annotation punctuation\">@Override</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token annotation punctuation\">@Override</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ApplicationArguments</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>옛날에 스프링으로 개발했던 흑우집합소 코드인데... 아련하다 ㅎㅎ<br>\n무튼 이런 시작점이 어딘지 잘 몰랐다.</p>\n<p><strong>Nest.Js</strong>의 경우에는 <strong>main.ts</strong>등으로 아래와 같이 <strong>bootstrap</strong>함수를 호출하는 것으로 시작한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> NestFactory<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>AppModule<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">await</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">9911</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>하지만 <strong>Next.Js</strong>의 경우 이 명령어를 줬을 때 실행하는 **Main함수(또는 메서드)**를 찾을 수 없었다.</p>\n<p>구글링 한 결과...<br>\n<strong>node_modules/next/dist/cli/next-start.js</strong> 저 파일을 확인해보라 했다.</p>\n<p>이제부터 긴 설명에 앞서...</p>\n<p>만약 본인의 컴퓨터에 있는 Next.Js 프로젝트가 아닌 깃허브에서 보고 싶다면,<br>\nGithub의 <a href=\"https://github.com/vercel/next.js/tree/canary/packages/next/src\">next.js/packages/next/src</a>를 참고하며 보도록 하자.<br>\n결국 개인 프로젝트 폴더의 node_modules/next/dist/ 와 next.js/packages/next/src 는 같은 결과물을 바라본다.<br>\n물론 버전에 따라 틀릴 수 있겠지만...</p>\n<p>그리고 정답을 먼저 공개하자면...<br>\n<a href=\"https://github.com/vercel/next.js/blob/canary/packages/next/src/server/base-server.ts\">base-server.ts</a>가 모든 것을 쥐고 있다. (로컬일 경우 base-server.js)<br>\n이 부분은 아래 설명을 추적하다보면 이해가 될 것이다.</p>\n<p>그럼 위에 나온대로 <strong>next-start.js</strong>파일부터 하나씩 내려가보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/cli/next-start.js</span>\n\n#<span class=\"token operator\">!</span><span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>env node\n<span class=\"token string\">'use strict'</span>\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span>exports<span class=\"token punctuation\">,</span> <span class=\"token string\">'__esModule'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nexports<span class=\"token punctuation\">.</span>nextStart <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">var</span> _indexJs <span class=\"token operator\">=</span> <span class=\"token function\">_interopRequireDefault</span><span class=\"token punctuation\">(</span>\n  <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'next/dist/compiled/arg/index.js'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> _startServer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../server/lib/start-server'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> _utils <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../server/lib/utils'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> Log <span class=\"token operator\">=</span> <span class=\"token function\">_interopRequireWildcard</span><span class=\"token punctuation\">(</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../build/output/log'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> _isError <span class=\"token operator\">=</span> <span class=\"token function\">_interopRequireDefault</span><span class=\"token punctuation\">(</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../lib/is-error'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> _getProjectDir <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../lib/get-project-dir'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">_interopRequireDefault</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">obj</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> obj <span class=\"token operator\">&amp;&amp;</span> obj<span class=\"token punctuation\">.</span>__esModule\n    <span class=\"token operator\">?</span> obj\n    <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> obj<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//기타 엄청난 코드들...</span></code></pre></div>\n<br>\n<p>잠깐 열었다가 닫고 싶어진 코드였다 -_-;;<br>\n그래도 학습을 위해선 봐야지...<br>\n조금 스크롤을 내리면 <strong>const nextStart = (argv)=>{}</strong> 익명함수가 보인다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/cli/next-start.js</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">nextStart</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">argv</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> validArgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Types</span>\n    <span class=\"token string-property property\">\"--help\"</span><span class=\"token operator\">:</span> Boolean<span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"--port\"</span><span class=\"token operator\">:</span> Number<span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"--hostname\"</span><span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"--keepAliveTimeout\"</span><span class=\"token operator\">:</span> Number<span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Aliases</span>\n    <span class=\"token string-property property\">\"-h\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"--help\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"-p\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"--port\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"-H\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"--hostname\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _startServer<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">startServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    dir<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">hostname</span><span class=\"token operator\">:</span> host<span class=\"token punctuation\">,</span>\n    port<span class=\"token punctuation\">,</span>\n    keepAliveTimeout<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token parameter\">app</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> appUrl <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>app<span class=\"token punctuation\">.</span>hostname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>app<span class=\"token punctuation\">.</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n    Log<span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">started server on </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>host<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>app<span class=\"token punctuation\">.</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, url: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>appUrl<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">await</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n    process<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>Cli 전달인자들에 대한 것들이 있고 마지막 쯔음 <strong>startServer</strong>서버를 실행하는 함수를 전달받는 함수가 있다.<br>\n**(0, _startServer).**이 형태는 처음 보는 형태였다.</p>\n<p>저게 어떻게 함수를 호출하는지...<br>\n기본기가 부족한 나로써는 이해가 되지 않지만...<br>\n일단 더 추적해봤다.</p>\n<p>저 전달인자인 <strong>_startServer</strong>를 추적해보니...<br>\n<strong>node_modules/next/dist/server/start-server.d.ts</strong> 저 파일로 연결이 되었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//node_modules/next/dist/server/start-server.d.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">type</span> <span class=\"token punctuation\">{</span> NextServerOptions<span class=\"token punctuation\">,</span> NextServer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../next\"</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">StartServerOptions</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">NextServerOptions</span> <span class=\"token punctuation\">{</span>\n  allowRetry<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n  keepAliveTimeout<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">declare</span> <span class=\"token keyword\">function</span> <span class=\"token function\">startServer</span><span class=\"token punctuation\">(</span>\n  opts<span class=\"token operator\">:</span> StartServerOptions\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>NextServer<span class=\"token operator\">></span>\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>이것만 보니 뭔가 구현체?<br>\n서버를 띄우거나 하는 것이 없었고,<br>\n대신 파일 아래를 보니 <strong>start-server.js</strong>파일이 존재했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/server/lib/start-server.js</span>\n\n<span class=\"token string\">\"use strict\"</span>\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span>exports<span class=\"token punctuation\">,</span> <span class=\"token string\">\"__esModule\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nexports<span class=\"token punctuation\">.</span>startServer <span class=\"token operator\">=</span> startServer\n<span class=\"token keyword\">var</span> _log <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../build/output/log\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> _http <span class=\"token operator\">=</span> <span class=\"token function\">_interopRequireDefault</span><span class=\"token punctuation\">(</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> _next <span class=\"token operator\">=</span> <span class=\"token function\">_interopRequireDefault</span><span class=\"token punctuation\">(</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../next\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">_interopRequireDefault</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">obj</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> obj <span class=\"token operator\">&amp;&amp;</span> obj<span class=\"token punctuation\">.</span>__esModule\n    <span class=\"token operator\">?</span> obj\n    <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> obj<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">startServer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">opts</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> requestHandler\n  <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> _http<span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">requestHandler</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>이 코드의 <strong>startServer</strong>함수가 서버를 띄우는 것임을 확인했다.<br>\n그리고 <strong>server</strong>변수를 보면 _http를 통해서 서버를 띄운다.</p>\n<p>그리고 저 _http는 node 서버임을 확인할 수 있다.<br>\n난 Next.JS가 어떤 서버를 가지고 있나 싶었는데...<br>\n실질적으로 <strong>Next.Js</strong>는 Node 서버를 내포하고 있음을 확인할 수 있었다.</p>\n<p>그리고 <strong>startServer</strong>에서 조금 더 내려가서 서버가 구동되면 동작하는 코드가 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/server/lib/start-server.js</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"listening\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> addr <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> hostname <span class=\"token operator\">=</span>\n    <span class=\"token operator\">!</span>opts<span class=\"token punctuation\">.</span>hostname <span class=\"token operator\">||</span> opts<span class=\"token punctuation\">.</span>hostname <span class=\"token operator\">===</span> <span class=\"token string\">\"0.0.0.0\"</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"localhost\"</span> <span class=\"token operator\">:</span> opts<span class=\"token punctuation\">.</span>hostname\n  <span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _next<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">default</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>opts<span class=\"token punctuation\">,</span>\n    hostname<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">customServer</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">httpServer</span><span class=\"token operator\">:</span> server<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">port</span><span class=\"token operator\">:</span> addr <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">typeof</span> addr <span class=\"token operator\">===</span> <span class=\"token string\">\"object\"</span> <span class=\"token operator\">?</span> addr<span class=\"token punctuation\">.</span>port <span class=\"token operator\">:</span> port<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  requestHandler <span class=\"token operator\">=</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  upgradeHandler <span class=\"token operator\">=</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">getUpgradeHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">,</span> opts<span class=\"token punctuation\">.</span>hostname<span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>저기 보면 또 이상한 **(0, _next)**문법을 사용하는데...<br>\n나중에 알아봐야겠다.</p>\n<p>무튼 저기 보면 <strong>_next</strong>를 전달인자로 잡는데 이걸 추적하면,<br>\n<strong>node_modules/next/dist/server/next.d.ts</strong> 이 파일로 이동한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//node_modules/next/dist/server/next.d.ts</span>\n\n<span class=\"token comment\">//...</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">declare</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">NextServer</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> serverPromise<span class=\"token operator\">?</span>\n  <span class=\"token keyword\">private</span> server<span class=\"token operator\">?</span>\n  <span class=\"token keyword\">private</span> reqHandlerPromise<span class=\"token operator\">?</span>\n  <span class=\"token keyword\">private</span> preparedAssetPrefix<span class=\"token operator\">?</span>\n  options<span class=\"token operator\">:</span> NextServerOptions\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>options<span class=\"token operator\">:</span> NextServerOptions<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">hostname</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">port</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token function\">getRequestHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> RequestHandler\n  <span class=\"token function\">getUpgradeHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>\n    req<span class=\"token operator\">:</span> IncomingMessage<span class=\"token punctuation\">,</span>\n    socket<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span>\n    head<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n  <span class=\"token function\">setAssetPrefix</span><span class=\"token punctuation\">(</span>assetPrefix<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span>\n  <span class=\"token function\">logError</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> Parameters<span class=\"token operator\">&lt;</span>Server<span class=\"token punctuation\">[</span><span class=\"token string\">\"logError\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> Parameters<span class=\"token operator\">&lt;</span>Server<span class=\"token punctuation\">[</span><span class=\"token string\">\"render\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n  <span class=\"token function\">renderToHTML</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> Parameters<span class=\"token operator\">&lt;</span>Server<span class=\"token punctuation\">[</span><span class=\"token string\">\"renderToHTML\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span>\n  <span class=\"token function\">renderError</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> Parameters<span class=\"token operator\">&lt;</span>Server<span class=\"token punctuation\">[</span><span class=\"token string\">\"renderError\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n  <span class=\"token function\">renderErrorToHTML</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> Parameters<span class=\"token operator\">&lt;</span>Server<span class=\"token punctuation\">[</span><span class=\"token string\">\"renderErrorToHTML\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span>\n  <span class=\"token function\">render404</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> Parameters<span class=\"token operator\">&lt;</span>Server<span class=\"token punctuation\">[</span><span class=\"token string\">\"render404\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n  <span class=\"token function\">serveStatic</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> Parameters<span class=\"token operator\">&lt;</span>Server<span class=\"token punctuation\">[</span><span class=\"token string\">\"serveStatic\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n  <span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n  <span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span>\n  <span class=\"token keyword\">private</span> createServer\n  <span class=\"token keyword\">private</span> loadConfig\n  <span class=\"token keyword\">private</span> getServer\n  <span class=\"token keyword\">private</span> getServerRequestHandler\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>위의 <strong>start-server.d.ts</strong>처럼 이 파일도 ts와 같은 경로에 <strong>next.js</strong>파일이 있다.<br>\n이는 내 프로젝트에서 배포 시 ts => js로 변경을 해서 그렇지 않을까 싶다.<br>\n결국 배포할 때는 ts가 js로 변하기 때문에?</p>\n<p>저기에 있는 함수 중 <strong>render</strong>시리즈를 보면 다음과 같이 구현되어 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/server/next.js</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">async</span> <span class=\"token function\">renderToHTML</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">renderToHTML</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">async</span> <span class=\"token function\">renderError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">renderError</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">async</span> <span class=\"token function\">renderErrorToHTML</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">renderErrorToHTML</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">async</span> <span class=\"token function\">render404</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">render404</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>리턴이 **const server = await this.getServer();**의 객체에 있는 함수를 호출한다.<br>\n<strong>getServer</strong>함수는 바로 아래에 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">async</span> <span class=\"token function\">getServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>serverPromise<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>getServerImpl<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>serverPromise <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">conf</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>server <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">,</span>\n                    conf\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>preparedAssetPrefix<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>server<span class=\"token punctuation\">.</span><span class=\"token function\">setAssetPrefix</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>preparedAssetPrefix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>server<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>serverPromise<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>결국 자신의 함수 중 <strong>createServer</strong>함수를 호출한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/server/next.js</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> DevServer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./dev/next-dev-server\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DevServer</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">const</span> ServerImplementation <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getServerImpl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ServerImplementation</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>여기서 보면 dev 모드일 경우와 일반(아마 운영과 같이 dev를 사용하지 않는)모드로 나눠서 서버를 반환한다.<br>\n물론 결국 둘다 하나의 클래스에서 파생되었겠지만...<br>\n그럼 먼저 개발 모드를 보자.</p>\n<br>\n<h3 id=\"dev\" style=\"position:relative;\"><a href=\"#dev\" aria-label=\"dev permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dev</h3>\n<p>개발 서버 측으로 와보면 이제 실제 Next.js의 서버 구현체를 지나 각 페이지의 구현 및 라우팅, 기타 컴포넌트를 다루는 것들 등...<br>\n다양한 메서드로 알차게(?) 채워져 있다.<br>\n뒤늦게 안 사실이지만 상속된 메서드를 구현하는 것이었다.<br>\nJava나 Dart와 같은 언어처럼 상속 시 <strong>@Override</strong> 어노테이션이 없어서 구분이 안되었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//</span>\n<span class=\"token comment\">//node_modules/next/dist/server/dev/next-dev-server.d.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Options</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ServerOptions</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/**\n   * Tells of Next.js is running from the `next dev` command\n   */</span>\n  isNextDevCommand<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DevServer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Server</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">///....</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getAppPathsManifest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getCustomRoutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> CustomRoutes\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getPreviewProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> __ApiPreviewProps\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getPagesManifest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getAppPathsManifest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> MiddlewareRoutingItem <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getEdgeFunctions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> RoutingItem<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getServerComponentManifest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getServerCSSManifest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">hasMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">boolean</span><span class=\"token operator\">></span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">ensureMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">ensureEdgeFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    page<span class=\"token punctuation\">,</span>\n    appPaths<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    page<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    appPaths<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n  <span class=\"token function\">generateRoutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    headers<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Route<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    rewrites<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      beforeFiles<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Route<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n      afterFiles<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Route<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n      fallback<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Route<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n    redirects<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Route<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    catchAllRoute<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Route\n    catchAllMiddleware<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Route<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    pageChecker<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>PageChecker\n    useFileSystemPublicRoutes<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n    dynamicRoutes<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>DynamicRoutes <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span>\n    nextConfig<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../config-shared\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>NextConfig\n    fsRoutes<span class=\"token operator\">:</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Route<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">generatePublicRoutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">never</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">getDynamicRoutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">never</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">protected</span> <span class=\"token function\">findPageComponents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    pathname<span class=\"token punctuation\">,</span>\n    query<span class=\"token punctuation\">,</span>\n    params<span class=\"token punctuation\">,</span>\n    isAppPath<span class=\"token punctuation\">,</span>\n    appPaths<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    pathname<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    query<span class=\"token operator\">:</span> ParsedUrlQuery\n    params<span class=\"token operator\">:</span> Params\n    isAppPath<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n    appPaths<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindComponentsResult <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>코드는 너무 길어서 다 확인할 수 없지만...<br>\n<strong>run</strong>함수는 아마 Next API쪽을 다루는게 아닌가 싶다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/server/dev/next-dev-server.js</span>\n\n <span class=\"token keyword\">async</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> parsedUrl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>devReady<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setupWebSocketHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> req<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> basePath  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>nextConfig<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> originalPathname <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>basePath <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _pathHasPrefix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">pathHasPrefix</span><span class=\"token punctuation\">(</span>parsedUrl<span class=\"token punctuation\">.</span>pathname <span class=\"token operator\">||</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> basePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// strip basePath before handling dev bundles</span>\n            <span class=\"token comment\">// If replace ends up replacing the full url it'll be `undefined`, meaning we have to default it to `/`</span>\n            originalPathname <span class=\"token operator\">=</span> parsedUrl<span class=\"token punctuation\">.</span>pathname<span class=\"token punctuation\">;</span>\n            parsedUrl<span class=\"token punctuation\">.</span>pathname <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _removePathPrefix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">removePathPrefix</span><span class=\"token punctuation\">(</span>parsedUrl<span class=\"token punctuation\">.</span>pathname <span class=\"token operator\">||</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> basePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> pathname  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> parsedUrl<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/_next\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _fileExists<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fileExists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>publicDir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"_next\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>_constants<span class=\"token punctuation\">.</span><span class=\"token constant\">PUBLIC_DIR_MIDDLEWARE_CONFLICT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> finished <span class=\"token operator\">=</span><span class=\"token boolean\">false</span>  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hotReloader<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>originalRequest<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">.</span>originalResponse<span class=\"token punctuation\">,</span> parsedUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>finished<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>originalPathname<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// restore the path before continuing so that custom-routes can accurately determine</span>\n            <span class=\"token comment\">// if they should match against the basePath or not</span>\n            parsedUrl<span class=\"token punctuation\">.</span>pathname <span class=\"token operator\">=</span> originalPathname<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> parsedUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">const</span> err <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _isError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperError</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">logErrorWithOriginalStack</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderError</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> pathname<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token literal-property property\">__NEXT_PAGE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _isError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">default</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> err<span class=\"token punctuation\">.</span>page <span class=\"token operator\">||</span> pathname <span class=\"token operator\">||</span> <span class=\"token string\">\"\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>internalErr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>internalErr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                res<span class=\"token punctuation\">.</span><span class=\"token function\">body</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Internal Server Error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>뭐 여기까지만 보고 이거 다 이해하려하면 너무 어려우니,<br>\n대충 어디서 돌아가는지만 파악하면 될 듯 싶다.<br>\n그리고 넘어가기 전 이 <strong>DevServer의 상속 구조</strong>를 기억하고 가자.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//var _nextServer = _interopRequireWildcard(require(\"../next-server\"));</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">DevServer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">_nextServer<span class=\"token punctuation\">.</span>default</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>저 _nextServer는 운영 서버 클래스를 나타낸다.<br>\n링크를 타고 가보면 <strong>node_modules/next/dist/server/next-server.d.ts</strong>를 나타냄을 알 수 있다.</p>\n<br>\n<h3 id=\"운영\" style=\"position:relative;\"><a href=\"#%EC%9A%B4%EC%98%81\" aria-label=\"운영 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>운영</h3>\n<p>아까 보던 곳에서 운영은 다음과 같이 호출하게 되어 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/server/next.js</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getServerImpl</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ServerImpl <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span>\n    ServerImpl <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./next-server\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>default\n  <span class=\"token keyword\">return</span> ServerImpl\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>근데 개발 섭도 결국 운영에서 파생되어 진거고, 이 운영섭은 어떤걸 상속받았을까?</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">NextNodeServer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseServer</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>저 <strong>BaseServer</strong>가 실제 Next.Js의 <strong>서버 중추 역할</strong>을 하는 것을 알 수 있다.<br>\n우리가 Next.js에서 <strong>yarn dev</strong> 또는 <strong>yarn start</strong>를 수행하면 위의 과정을 거친 후 서버가 구동이 되고,<br>\n구동된 서버 위에서 route를 호출할 경우 이런 저런 호출을 타고 결국 아래의 함수를 호출한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//node_modules/next/dist/server/base-server.js</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token function\">renderToResponse</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> res <span class=\"token punctuation\">,</span> query <span class=\"token punctuation\">,</span> pathname  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> page <span class=\"token operator\">=</span> pathname<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> bubbleNoFallback <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>query<span class=\"token punctuation\">.</span>_nextBubbleNoFallback<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">delete</span> query<span class=\"token punctuation\">.</span>_nextBubbleNoFallback<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// Ensure a request to the URL /accounts/[id] will be treated as a dynamic</span>\n            <span class=\"token comment\">// route correctly and not loaded immediately without parsing params.</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _utils1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isDynamicRoute</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderPageComponent</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> bubbleNoFallback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">!==</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dynamicRoutes<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> dynamicRoute <span class=\"token keyword\">of</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dynamicRoutes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> dynamicRoute<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>params<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    page <span class=\"token operator\">=</span> dynamicRoute<span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderPageComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                        <span class=\"token operator\">...</span>ctx<span class=\"token punctuation\">,</span>\n                        <span class=\"token literal-property property\">pathname</span><span class=\"token operator\">:</span> page<span class=\"token punctuation\">,</span>\n                        <span class=\"token literal-property property\">renderOpts</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token operator\">...</span>ctx<span class=\"token punctuation\">.</span>renderOpts<span class=\"token punctuation\">,</span>\n                            params\n                        <span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> bubbleNoFallback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">!==</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token comment\">// currently edge functions aren't receiving the x-matched-path</span>\n            <span class=\"token comment\">// header so we need to fallback to matching the current page</span>\n            <span class=\"token comment\">// when we weren't able to match via dynamic route to handle</span>\n            <span class=\"token comment\">// the rewrite case</span>\n            <span class=\"token comment\">// @ts-expect-error extended in child class web-server</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>serverOptions<span class=\"token punctuation\">.</span>webServerConfig<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// @ts-expect-error extended in child class web-server</span>\n                ctx<span class=\"token punctuation\">.</span>pathname <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>serverOptions<span class=\"token punctuation\">.</span>webServerConfig<span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderPageComponent</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> bubbleNoFallback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">!==</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> err <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _isError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperError</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">_utils<span class=\"token punctuation\">.</span>MissingStaticPage</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invariant: failed to load static page\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                    page<span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> ctx<span class=\"token punctuation\">.</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">matchedPath</span><span class=\"token operator\">:</span> ctx<span class=\"token punctuation\">.</span>req<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">\"x-matched-path\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">initUrl</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _requestMeta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRequestMeta</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span>req<span class=\"token punctuation\">,</span> <span class=\"token string\">\"__NEXT_INIT_URL\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">didRewrite</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _requestMeta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRequestMeta</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span>req<span class=\"token punctuation\">,</span> <span class=\"token string\">\"_nextDidRewrite\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">rewroteUrl</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _requestMeta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRequestMeta</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span>req<span class=\"token punctuation\">,</span> <span class=\"token string\">\"_nextRewroteUrl\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">throw</span> err<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">NoFallbackError</span> <span class=\"token operator\">&amp;&amp;</span> bubbleNoFallback<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">throw</span> err<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">_utils<span class=\"token punctuation\">.</span>DecodeError</span> <span class=\"token operator\">||</span> err <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">_utils<span class=\"token punctuation\">.</span>NormalizeError</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">400</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderErrorToResponse</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// if pages/500 is present we still need to trigger</span>\n            <span class=\"token comment\">// /_error `getInitialProps` to allow reporting error</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasPage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/500\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                ctx<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>__nextCustomErrorRender <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderErrorToResponse</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">delete</span> ctx<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>__nextCustomErrorRender<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">const</span> isWrappedError <span class=\"token operator\">=</span> err <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">WrappedBuildError</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isWrappedError<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>minimalMode <span class=\"token operator\">&amp;&amp;</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NEXT_RUNTIME</span> <span class=\"token operator\">!==</span> <span class=\"token string\">\"edge\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderOpts<span class=\"token punctuation\">.</span>dev<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _isError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">default</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> err<span class=\"token punctuation\">.</span>page <span class=\"token operator\">=</span> page<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">throw</span> err<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">logError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> _isError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperError</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderErrorToResponse</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> isWrappedError <span class=\"token operator\">?</span> err<span class=\"token punctuation\">.</span>innerError <span class=\"token operator\">:</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>router<span class=\"token punctuation\">.</span>catchAllMiddleware<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>ctx<span class=\"token punctuation\">.</span>req<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">\"x-nextjs-data\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">||</span> res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">===</span> <span class=\"token number\">200</span> <span class=\"token operator\">||</span> res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">===</span> <span class=\"token number\">404</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x-nextjs-matched-path\"</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>query<span class=\"token punctuation\">.</span>__nextLocale <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>query<span class=\"token punctuation\">.</span>__nextLocale<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pathname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"content-type\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">body</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">404</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderErrorToResponse</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그리고 결국 우리가 실제로 작성하게 되는 <strong>_document.tsx</strong>나 <strong>_app.tsx</strong>를 랜더링 하며,<br>\n각 컴포넌트들을 순차적으로 렌더링 하게 된다.</p>\n<br>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>3번 문항의 경우 하나씩 추적하느라 설명이 너무 복잡하고 길었다.<br>\n개인적으로 이렇게 딥하게 파는걸 좋아하진 않지만...<br>\n동작을 이해하기 위해서는 필요한 과정이라 생각한다.</p>\n<p>물론 서비스 구현에 목적이 있고, 다양한 아이템에 대해 아이디어를 녹여서,<br>\n결과를 빨리 봐야 하는 사람들에겐 이게 무슨 의미냐 싶겠지만...</p>\n<p>어떤식으로든 결국 이 구조를 한번쯤은 까봐야 하는 순간이 올 것이다.<br>\n이런 딥한걸 싫어하는 나같은 사람을 위해 최소한의 설명으로 풀어내봤다.</p>\n<p>과제도 과제였지만, 덕분에 돌아가는 방식을 조금이나마 알게 되어 유익한 시간이었다.<br>\n이제 다시 뚜껑을 덮고 서비스를 구현해봐야겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%9D%B4%EB%B2%88-%ED%8F%AC%EC%8A%A4%ED%8C%85%EC%9D%80\">이번 포스팅은...</a></p>\n<ul>\n<li>\n<p><a href=\"#1-csrclient-side-rendering%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B4%EB%A9%B0-%EA%B7%B8%EA%B2%83%EC%9D%98-%EC%9E%A5%EB%8B%A8%EC%A0%90%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-%EC%84%A4%EB%AA%85%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94\">1. CSR(Client-side Rendering)이란 무엇이며, 그것의 장단점에 대하여 설명해주세요.</a></p>\n<ul>\n<li><a href=\"#csrclient-side-rendering%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\">CSR(Client-side Rendering)이란 무엇인가?</a></li>\n<li><a href=\"#csrclient-side-rendering%EC%9D%98-%EC%9E%A5%EB%8B%A8%EC%A0%90\">CSR(Client-side Rendering)의 장단점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-spasingle-page-application%EB%A1%9C-%EA%B5%AC%EC%84%B1%EB%90%9C-%EC%9B%B9-%EC%95%B1%EC%97%90%EC%84%9C-ssrserver-side-rendering%EC%9D%B4-%ED%95%84%EC%9A%94%ED%95%9C-%EC%9D%B4%EC%9C%A0%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-%EC%84%A4%EB%AA%85%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94\">2. SPA(Single Page Application)로 구성된 웹 앱에서 SSR(Server-side Rendering)이 필요한 이유에 대하여 설명해주세요.</a></p>\n</li>\n<li>\n<p><a href=\"#3-nextjs-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%97%90%EC%84%9C-yarn-startor-npm-run-start-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%96%88%EC%9D%84-%EB%95%8C-%EC%8B%A4%ED%96%89%EB%90%98%EB%8A%94-%EC%BD%94%EB%93%9C%EB%A5%BC-nextjs-github-%EB%A0%88%ED%8F%AC%EC%A7%80%ED%86%A0%EB%A6%AC%EC%97%90%EC%84%9C-%EC%B0%BE%EC%9D%80-%EB%92%A4-%ED%95%B4%EB%8B%B9-%ED%8C%8C%EC%9D%BC%EC%97%90-%EB%8C%80%ED%95%9C-%EA%B0%84%EB%8B%A8%ED%95%9C-%EC%84%A4%EB%AA%85%EC%9D%84-%EC%B2%A8%EB%B6%80%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94\">3. Next.js 프로젝트에서 yarn start(or npm run start) 스크립트를 실행했을 때 실행되는 코드를 Next.js Github 레포지토리에서 찾은 뒤, 해당 파일에 대한 간단한 설명을 첨부해주세요.</a></p>\n<ul>\n<li><a href=\"#dev\">Dev</a></li>\n<li><a href=\"#%EC%9A%B4%EC%98%81\">운영</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"23년 7월 원티드 프리온보딩 프론트엔드 챌린지 사전과제","description":null,"date":"June 27, 2023","tags":["TIL"],"series":"TIL","previewImage":"writing.png","isPrivate":null,"writer":null}},"previous":{"fields":{"slug":"/dart_flutter/230627_appbar-center/"},"frontmatter":{"title":"(Flutter) AppBar 사용 시 중앙정렬 문제 (Android)","isPrivate":null}},"next":{"fields":{"slug":"/aws/230629_change-aws-domain/"},"frontmatter":{"title":"AWS Route53에서 구입한 도메인 다른 계정으로 이동하기","isPrivate":null}}},"pageContext":{"id":"ed7e74dc-192d-5401-b402-cf4bf3fc8229","previousPostId":"be1c85fd-c677-5dcf-8155-91cd3024ee0c","nextPostId":"efcf0332-8359-5230-b28d-0d8948d8229f"}},"staticQueryHashes":[],"slicesMap":{}}
{"componentChunkName":"component---src-templates-post-template-index-tsx","path":"/til/230214_til/","result":{"data":{"cur":{"id":"433d1180-7b35-5de3-b36b-383ad8fb814f","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABMElEQVQoz42S0Y6CMBBFW6Cl0GmhxYorrJpAsolP+v8fdzetrqtmxX24GToZztxOhzHGcC+vCEOzwqA9drTCJ3XYmRX2NuDQrJN647A2LYzSeP6fPSciQBTir8KknGegvESTqwRXolwGRmdK/haFEDBNE7bDAOf9Q+26btCWehkYryfy4nbWWmMcxwQmopTjjF+aVRauomVgnFWeZQ85znnSc21XEnxtl4FxLnFOPyApZXJpjEFd18jumnmp0Wn7D4dXYLziPM84Ho84n844n06pwc2hJHS6eePQBpTi8srRTV4UYJwl5fLx9Z3UCNQuA3tlMbuPtIss42grwtZ22BiHnlz6vpw9Dm2PWqpl4A1cWXyFEVRWqLmAzmQSpShSLHnxfrH5NZJQmNzm5YK/0jegveteJRG0qAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/39caabbd44b8d6bf6560fecef746ecb3/7c297/thumbnail_til.webp 180w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/33ecc/thumbnail_til.webp 360w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/df77d/thumbnail_til.webp 720w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/dd3ab/thumbnail_til.webp 895w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/39caabbd44b8d6bf6560fecef746ecb3/e9ea2/thumbnail_til.png 180w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/53918/thumbnail_til.png 360w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/242a6/thumbnail_til.png 720w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/b002d/thumbnail_til.png 895w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/39caabbd44b8d6bf6560fecef746ecb3/242a6/thumbnail_til.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"23년-2월-13일-til\" style=\"position:relative;\"><a href=\"#23%EB%85%84-2%EC%9B%94-13%EC%9D%BC-til\" aria-label=\"23년 2월 13일 til permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>23년 2월 13일 TIL</h1>\n<p>금일 흑우집합소를 개발하며 배운 내용 및 겪은 과정을 정리하여 올려본다.<br>\n오늘은 깔끔한 코드 작성에 대해 고민한 부분을 정리하여 올려본다.</p>\n<p>어제 작업하던 JWT 부분에 대해 매듭을 지려고 했다.<br>\n일부분은 <strong>Ports And Adapters Architecture</strong> 방식으로 작성해보려고 노력중이다.</p>\n<p>근데 확실히 레이어드 아키텍쳐보다 더 나은 것 같다.<br>\n이유는 크게 세 가지다.</p>\n<ol>\n<li>하나의 코드 파일의 가독성 증가</li>\n<li>레이어드 보다 더 세분화 가능</li>\n<li>깔끔한 파일 관리</li>\n</ol>\n<p>개인적 사견이 많이 녹여 있어서 다른 사람은 공감 못할 수 있다.<br>\n레이어드 아키텍쳐로도 충분히 구현 가능하지만, 이 아키텍쳐로 인해 명확하게 각 역할이 나눠지는 것을 채감했다.</p>\n<p>이것은 차후에 다루고…<br>\n오늘 했던 고민은 아래와 같다.</p>\n<br>\n<h2 id=\"고민-포인트\" style=\"position:relative;\"><a href=\"#%EA%B3%A0%EB%AF%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8\" aria-label=\"고민 포인트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>고민 포인트</h2>\n<p>먼저 내가 jwt를 검증하는 Inbound 영역의 서비스 로직이 있다.<br>\n코드는 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VerifyJwtService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">VerifyJwtOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> jwtService<span class=\"token operator\">:</span> JwtService<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">DECODE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> decodJwtOutboundPort<span class=\"token operator\">:</span> DecodeJwtOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_ACCOUNT_EMAIL_JOIN_TYPE_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findAccountEmailJoinTypeOutboundPort<span class=\"token operator\">:</span> FindAccountEmainJoinTypeOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">LOGOUT_ACCOUNT_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> logoutAccountInboundPort<span class=\"token operator\">:</span> LogoutAccountInboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">CREATE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> createJwtOutboundPort<span class=\"token operator\">:</span> CreateJwtOutboundPort<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">excute</span><span class=\"token punctuation\">(</span>params<span class=\"token operator\">:</span> VerifyJwtInputDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      params<span class=\"token punctuation\">.</span>tokenType <span class=\"token operator\">===</span> <span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span>\n        <span class=\"token operator\">?</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">verifyAccessJwt</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>jwt<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">verifyRefreshJwt</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>jwt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> e<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token function\">verifyAccessJwt</span><span class=\"token punctuation\">(</span>jwt<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jwtService<span class=\"token punctuation\">.</span><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        secret<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">JWT_ACCESS_SECRET_KEY</span><span class=\"token punctuation\">,</span>\n        audience<span class=\"token operator\">:</span> <span class=\"token function\">getJwtAudience</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        issuer<span class=\"token operator\">:</span> <span class=\"token function\">getJwtIssuer</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">as</span> JwtVerifyOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> validResult <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">tokenExceptionHandler</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> jwt<span class=\"token punctuation\">,</span> <span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>validResult <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> validResult<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">//고민 포인트 01</span>\n      <span class=\"token comment\">//액세스 토큰에서 만료가 되면 리프래시 토큰을 검증한다.</span>\n      <span class=\"token comment\">//큰 문제 없다면 AccessToken을 다시 전달한다.</span>\n      <span class=\"token comment\">//이 부분에는 거의 10~20줄 짜리 코드 로직이 들어갔었다.</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * 리프레시 토큰 검증  고민포인트 02\n   * @param jwt\n   */</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token function\">verifyRefreshJwt</span><span class=\"token punctuation\">(</span>jwt<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jwtService<span class=\"token punctuation\">.</span><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        secret<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">JWT_REFRESH_SECRET_KEY</span><span class=\"token punctuation\">,</span>\n        audience<span class=\"token operator\">:</span> <span class=\"token function\">getJwtAudience</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        issuer<span class=\"token operator\">:</span> <span class=\"token function\">getJwtIssuer</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">REFRESH_TOKEN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">as</span> JwtVerifyOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">//고민 포인트 03</span>\n      <span class=\"token comment\">//리프레시 만료시에 대한 처리 로직</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">/**\n   * 토큰 예외 공통 처리 핸들러\n   * @param e\n   * @param jwt\n   * @param tokenType\n   * @returns\n   */</span>\n  <span class=\"token keyword\">private</span> <span class=\"token function\">tokenExceptionHandler</span><span class=\"token punctuation\">(</span>e<span class=\"token operator\">:</span> Error<span class=\"token punctuation\">,</span> jwt<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> tokenType<span class=\"token operator\">:</span> JwtType<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token operator\">|</span> AuthException <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//토큰 만료 시</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">TokenExpiredError</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[tokenExceptionHandler] : TokenExpiredError'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// return true;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">(</span>AuthJwtErrorCode<span class=\"token punctuation\">.</span><span class=\"token function\">jwtExpired</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">,</span> tokenType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// payload가 잘 못 되었을 때 (base64 decode가 안되는 경우 등)</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">SyntaxError</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[tokenExceptionHandler] : Syntax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// throw new AuthException(AuthJwtErrorCode.jwtInvalid(jwt, tokenType));</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">(</span>AuthJwtErrorCode<span class=\"token punctuation\">.</span><span class=\"token function\">jwtInvalid</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">,</span> tokenType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// JwtWebTokenError should be later than TokenExpiredError</span>\n    <span class=\"token comment\">//보통 토큰의 시크릿 코드가 변경되었는데 구형 키 값을 사용하여 만들어진 JWT를 사용할 경우 발생</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">JsonWebTokenError</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[tokenExceptionHandler] : JsonWebTokenError'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// throw new AuthException(AuthJwtErrorCode.invalidTokenOrInvalidSignature(jwt));</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">(</span>AuthJwtErrorCode<span class=\"token punctuation\">.</span><span class=\"token function\">invalidTokenOrInvalidSignature</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">,</span> tokenType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">//그 외 기타 에러</span>\n    <span class=\"token comment\">//기타 에러</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">(</span>AuthJwtErrorCode<span class=\"token punctuation\">.</span><span class=\"token function\">jwtEtcError</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">,</span> tokenType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>딱 봐도 코드의 문제가 보인다. (고민 포인트는 아래서 집어볼 예정)<br>\n일단 가장 큰 문제는 코드의 복잡도가 높다는 것이다.</p>\n<p>내가 최근 연습하고 있는 방법은 <strong>하나의 서비스는 하나의 기능만 담당한다</strong> 이다.<br>\n이게 생각보다 어렵다.</p>\n<p>명확하게 나눠지는건 쉽게 자를 수 있지만 위처럼 Jwt를 구현할 때 Access와 Refresh를 같이 쓴다.<br>\n이 경우 아래와 같이 생각할 수 있다.</p>\n<br>\n<ol>\n<li>먼저 한 메서드를 통해 JWT와 타입을 받고 내부 프라이빗 메서드에서 나눠서 처리하는 방법</li>\n<li>검증 자체 목적에 집중하는 서비스 로직과 Access와 Refresh 각각을 담당하는 서비스로 나눠서 처리하는 방법</li>\n<li>검증이라는 목적에 집중하여 Access와 Refresh 검증만 하고 그 외 예외 발생 시 호출 영역으로 전가시키기</li>\n</ol>\n<br>\n<p>맨 처음 내가 구현한 방법은 1번 방식이었고…<br>\n결국 위 코드처럼 복잡도가 매우 많이 상승하게 되었다.</p>\n<p>그럼 2번으로 할 것인가…<br>\n이 부분도 잘 생각해야 하는게 나누고 자르는게 좋지만 너무 나눌 경우 그것 자체로 인해 기능이 너무 산재되어 결국 코드 팔로우가 힘들 것이다.</p>\n<p>그래서 3번의 방법을 선택하게 되었다.<br>\n이렇게 하면서 각 고민 포인트를 고민하고 해결하였다.</p>\n<br>\n<h3 id=\"고민-포인트-01\" style=\"position:relative;\"><a href=\"#%EA%B3%A0%EB%AF%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8-01\" aria-label=\"고민 포인트 01 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>고민 포인트 01</h3>\n<p>Access JWT를 검증하고 catch 하는 부분에서 예외에 대하여 직접 처리하려 했더니 catct 부분이 복잡해졌다.<br>\n이로 인해 Refresh JWT 부분의 catch도 같은 문제가 생기게 되었다.</p>\n<p>이 부분은 위에서 언급한 3번 방법으로 해결하게 되었다.</p>\n<p>JWT를 검증하는 로직에서 <strong>AuthException</strong> 이라는 예외를 직접 핸들링하고,<br>\n이 부분에서 내가 의도한 예외(Access의 Expired 같은)는 따로 정상 처리를 하고,<br>\n그 외의 예외는 호출 지점으로 올려서 Controller 단의 <strong>ExceptionHandler</strong>로 흐르게끔 처리했다.</p>\n<p>그래서 이 부분은 해결할 수 있었다.</p>\n<br>\n<h3 id=\"고민-포인트-02\" style=\"position:relative;\"><a href=\"#%EA%B3%A0%EB%AF%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8-02\" aria-label=\"고민 포인트 02 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>고민 포인트 02</h3>\n<p>검증 로직에서 Access 와 Refresh를 각각 나눠서 별도의 파일로 관리할 것인가를 고민했었다.<br>\n근데 이것도 위에서 언급한 바와 같이 정답이 아니었다.</p>\n<p>혹시 별도의 JWT가 추가되면 계속 코드 파일이 늘어나기 때문이다.<br>\n그래서 이 부분은 1번 포인트와 같이 검증 목적에 집중하기로 했다.</p>\n<p>결국 신경 쓸 부분은 Refresh가 만료된 시점에 사용자 로그아웃 처리였다.<br>\n이 부분은 검증 로직에서 신경 쓸 것이 아닌 호출 지점에서 처리할 문제였다.</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AccessJwtStrategy</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">PassportStrategy</span><span class=\"token punctuation\">(</span>Strategy<span class=\"token punctuation\">,</span> <span class=\"token string\">'jwt'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">VERIFY_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> verifyjwtOutboundPort<span class=\"token operator\">:</span> VerifyJwtOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">DECODE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> decodJwtOutboundPort<span class=\"token operator\">:</span> DecodeJwtOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">CREATE_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> createJwtOutboundPort<span class=\"token operator\">:</span> CreateJwtOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_ACCOUNT_EMAIL_JOIN_TYPE_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findAccountEmailJoinTypeOutboundPort<span class=\"token operator\">:</span> FindAccountEmainJoinTypeOutboundPort<span class=\"token punctuation\">,</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">LOGOUT_ACCOUNT_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> logoutAccountInboundPort<span class=\"token operator\">:</span> LogoutAccountInboundPort<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> payload<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> jwt <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'testAuth'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>jwt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">(</span>AuthJwtErrorCode<span class=\"token punctuation\">.</span><span class=\"token function\">jwtNotFound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>verifyjwtOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        jwt<span class=\"token punctuation\">,</span>\n        tokenType<span class=\"token operator\">:</span> <span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//Access Jwt 만료된 경우</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>errorCode <span class=\"token operator\">===</span> <span class=\"token constant\">ERROR_CODE_JWT_EXPIRED</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> validResult<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">validRefreshJwt</span><span class=\"token punctuation\">(</span>account<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token comment\">//이후 로직 처리</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> e<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> payload<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위 코드는 <strong>Strategy</strong> 파일이다.<br>\nNest.js에서 사용하는 전략 파일의 일종이고, 이건 Access Jwt의 처리를 담당하는 Strategy다.</p>\n<p>이 부분에서 토큰 검증 이후 만료된 토큰에 대한 처리, 갱신 가능하면 갱신 처리, 각종 Jwt의 예외처리를 담당했다.<br>\n위 코드는 샘플용이라 정확하지 않지만…</p>\n<p>내가 지금 확인해보니 이 Strategy는 import와 몇 주석을 빼면 100줄도 안되는 코드로 변했다.<br>\n기존에 verify에 몰아서 짤 때는 약 300줄이 넘어갔다 -_-;;</p>\n<p>그래서 <strong>목적에 집중한 코드</strong> 덕분에 한결 나아진 코드를 작성할 수 있었다.</p>\n<br>\n<h3 id=\"고민-포인트-03\" style=\"position:relative;\"><a href=\"#%EA%B3%A0%EB%AF%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8-03\" aria-label=\"고민 포인트 03 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>고민 포인트 03</h3>\n<p>이 부분도 01, 02와 연계되어 있는데, 결국 Refresh가 만료되었을 때에 대한 처리 빼곤 Access와 동일했다.<br>\n그래서 별도 분리를 하지 않고, verify에서 예외를 호출단으로 넘기고 처리는 호출점에서 담당하는 방식으로 해결했다.</p>\n<br>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>오늘도 코드를 작성하면서 좀 더 깔끔하고, 유지보수가 쉬운 코드로 작성하는 연습을 하면서 하니…<br>\n사실 시간은 좀 배로 걸리는 것 같다.</p>\n<p>실행 목적에 집중하여 막 짜면 결과는 사실 금방 나온다.<br>\n그리고 이렇게 블로그로 남길거 생각 안하면 더 빠르고…</p>\n<p>근데 이렇게 하여 완성하고 나면 결국 그 뒤가 문제다.<br>\n지금 내가 만든 <strong>MyMe.Link</strong>가 그렇다.</p>\n<p>정말 코드가 판타스틱하다.<br>\n사실 유지보수 해야 하는데 정말 큰 일이 된거 같아서 큰일이다…<br>\n차라리 다시 짜는게 나을 것 같기도 할 정도니 말이다.</p>\n<p>이번 흑우집합소는 그런 전철을 안밟게 하려고 하는데 이게 맞는건지도 사실 잘 모르겠다.<br>\n정답은 없기에…</p>\n<p>일단 이게 최선의 방법인 것 같고 하면서 더 나은 코드를 짜는 방법을 찾는게 목적이 되었다.</p>\n<p>중간에 개발업 내려놨다 왔지만 나름 5년차 백엔드 개발자다.<br>\n물론 약 3년 휴식 + 전에 약간 섞인 물경력이 문제긴 하지만…</p>\n<p>나름 쌓여있는 경험치 덕분에 혼자서도 이렇게 잘(?) 해낼 수 있던 것 같다.</p>\n<p>이제는 다른 사람과 함께 일해보고 싶다.<br>\n근데 일단 매듭은 짓고 다시…</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EA%B3%A0%EB%AF%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8\">고민 포인트</a></p>\n<ul>\n<li><a href=\"#%EA%B3%A0%EB%AF%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8-01\">고민 포인트 01</a></li>\n<li><a href=\"#%EA%B3%A0%EB%AF%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8-02\">고민 포인트 02</a></li>\n<li><a href=\"#%EA%B3%A0%EB%AF%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8-03\">고민 포인트 03</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n</li>\n</ul>\n</div>","excerpt":"23년 2월 13일 TIL 금일 흑우집합소를 개발하며 배운 내용 및 겪은 과정을 정리하여 올려본다. 오늘은 깔끔한 코드 작성에 대해 고민한 부분을 정리하여 올려본다. 어제 작업하던 JWT 부분에 대해 매듭을 지려고 했다. 일부분은 Ports And Adapters Architecture 방식으로 작성해보려고 노력중이다. 근데 확실히 레이어드 아키텍쳐보다 더 나은 것 같다. 이유는 크게 세 가지다. 하나의 코드 파일의 가독성 증가 레이어드 보다 더 세분화 가능 깔끔한 파일 관리 개인적 사견이 많이 녹여 있어서 다른 사람은 공감 못할 수 있다. 레이어드 아키텍쳐로도 충분히 구현 가능하지만, 이 아키텍쳐로 인해 명확하게 각 역할이 나눠지는 것을 채감했다. 이것은 차후에 다루고… 오늘 했던 고민은 아래와 같다. 고민 포인트 먼저 내가 jwt를 검증하는 Inbound 영역의 서비스 로직이 있다. 코드는 아래와 같다. 딱 봐도 코드의 문제가 보인다. (고민 포인트는 아래서 집어볼 예정) 일단…","frontmatter":{"date":"2023.02.14","title":"23년 2월 14일 TIL & 개발노트 (깔끔한 코드에 대한 고민)","categories":"til","emoji":"📜"},"fields":{"slug":"/til/230214_til/"}},"next":{"id":"a2ac70d7-53cf-5f20-8d93-d95c2e73b834","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABMElEQVQoz42S0Y6CMBBFW6Cl0GmhxYorrJpAsolP+v8fdzetrqtmxX24GToZztxOhzHGcC+vCEOzwqA9drTCJ3XYmRX2NuDQrJN647A2LYzSeP6fPSciQBTir8KknGegvESTqwRXolwGRmdK/haFEDBNE7bDAOf9Q+26btCWehkYryfy4nbWWmMcxwQmopTjjF+aVRauomVgnFWeZQ85znnSc21XEnxtl4FxLnFOPyApZXJpjEFd18jumnmp0Wn7D4dXYLziPM84Ho84n844n06pwc2hJHS6eePQBpTi8srRTV4UYJwl5fLx9Z3UCNQuA3tlMbuPtIss42grwtZ22BiHnlz6vpw9Dm2PWqpl4A1cWXyFEVRWqLmAzmQSpShSLHnxfrH5NZJQmNzm5YK/0jegveteJRG0qAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/39caabbd44b8d6bf6560fecef746ecb3/7c297/thumbnail_til.webp 180w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/33ecc/thumbnail_til.webp 360w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/df77d/thumbnail_til.webp 720w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/dd3ab/thumbnail_til.webp 895w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/39caabbd44b8d6bf6560fecef746ecb3/e9ea2/thumbnail_til.png 180w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/53918/thumbnail_til.png 360w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/242a6/thumbnail_til.png 720w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/b002d/thumbnail_til.png 895w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/39caabbd44b8d6bf6560fecef746ecb3/242a6/thumbnail_til.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"23년-2월-13일-til--개발노트-흑우집합소\" style=\"position:relative;\"><a href=\"#23%EB%85%84-2%EC%9B%94-13%EC%9D%BC-til--%EA%B0%9C%EB%B0%9C%EB%85%B8%ED%8A%B8-%ED%9D%91%EC%9A%B0%EC%A7%91%ED%95%A9%EC%86%8C\" aria-label=\"23년 2월 13일 til  개발노트 흑우집합소 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>23년 2월 13일 TIL &#x26; 개발노트 (흑우집합소)</h1>\n<p>금일 흑우집합소를 개발하며 배운 내용 및 겪은 과정을 정리하여 올려본다.</p>\n<p>오늘은 JWT 인증 부분을 처리하였다.</p>\n<h2 id=\"nestjs에서-jwt-사용시-error-커스텀-처리\" style=\"position:relative;\"><a href=\"#nestjs%EC%97%90%EC%84%9C-jwt-%EC%82%AC%EC%9A%A9%EC%8B%9C-error-%EC%BB%A4%EC%8A%A4%ED%85%80-%EC%B2%98%EB%A6%AC\" aria-label=\"nestjs에서 jwt 사용시 error 커스텀 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nest.js에서 JWT 사용시 Error 커스텀 처리</h2>\n<ul>\n<li>Passport-JWT를 그대로 사용하려 했는데 Access Jwt의 토큰 만료시에도 401을 띄운다.</li>\n<li>나는 Access Token에 대해서는 토큰 만료 시 서버 내에서 저장된 리프레시 토큰을 확인하고 그에 따른 추가 작업을 하기 원했다.</li>\n<li>물론 try catch로 처리할 수 있지만 이렇게 하면 <strong>AuthExceptionHandler</strong>처리 부분이 너무 지저분해진다.</li>\n<li>그래서 좀 찾아본 결과 <strong>passport-custom</strong>이란 것으로 <strong>Strategy</strong>부터 커스텀 처리를 할 수 있는 것을 찾았다.(이건 따로 포스팅 예정)</li>\n<li>패키지를 설치하고 적용해봤다.</li>\n<li>일일히 JWT에 대한 에러를 핸들링 해야 하는 부분이 있지만 직접 핸들링을 할 수 있어서 더 좋은 것 같다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Inject<span class=\"token punctuation\">,</span> Injectable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> PassportStrategy <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/passport'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Request <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'express'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Strategy <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'passport-custom'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AuthException <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../exceptions/auth.exception'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AuthJwtErrorCode <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../exceptions/auth.jwt.error.code'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> VerifyJwtOutboundPort<span class=\"token punctuation\">,</span> <span class=\"token constant\">VERIFY_JWT_OUTBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../ports/out/jwt/verify.jwt.outbound.port'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JWT_TYPE</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../types/jwt.enums'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AccessJwtStrategy</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">PassportStrategy</span><span class=\"token punctuation\">(</span>Strategy<span class=\"token punctuation\">,</span> <span class=\"token string\">'jwt'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">VERIFY_JWT_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> verifyjwtOutboundPort<span class=\"token operator\">:</span> VerifyJwtOutboundPort<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> payload<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> jwt <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'TestJwtKey'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>jwt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthException</span><span class=\"token punctuation\">(</span>AuthJwtErrorCode<span class=\"token punctuation\">.</span><span class=\"token function\">jwtNotFound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>verifyjwtOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> jwt<span class=\"token punctuation\">,</span> tokenType<span class=\"token operator\">:</span> <span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> payload<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>덕분에 기존에 있던 JwtStrategy에서 직접 처리를 할 수 있게 되었다.<br>\n전에 <strong>passport-jwt</strong>사용할 때는 생성자에도 주렁주렁 매달아서 보냈었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            jwtFromRequest<span class=\"token operator\">:</span> ExtractJwt<span class=\"token punctuation\">.</span><span class=\"token function\">fromExtractors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> req<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TestJwtKey\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            secretOrKey<span class=\"token operator\">:</span> key<span class=\"token punctuation\">,</span>\n            issuer<span class=\"token operator\">:</span> <span class=\"token function\">getJwtIssuer</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            audience<span class=\"token operator\">:</span> <span class=\"token function\">getJwtAudience</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            ignoreExpiration<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n            passReqToCallback<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">as</span> StrategyOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>이제는 <strong>Strategy</strong>영역이 좀 깔끔해 진 것 같다.</p>\n<p>그리고 Nest.js에서 제공하는 <strong>JwtService</strong>의 경우 <strong>verify</strong>메서드로 검증을 할 수 있는데,<br>\n이때는 생성했던 JWT의 속성을 다 가지고 와야 한다.<br>\n속성은 <strong>issuer</strong> <strong>audience</strong> 등을 의미한다.</p>\n<p>쉽게 생성할 때와 맞춰주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jwtService<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span> data<span class=\"token operator\">:</span> payload <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    secret<span class=\"token operator\">:</span> secretKey<span class=\"token punctuation\">,</span>\n    expiresIn<span class=\"token operator\">:</span> expiredTime<span class=\"token punctuation\">,</span>\n    audience<span class=\"token operator\">:</span> <span class=\"token function\">getJwtAudience</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    issuer<span class=\"token operator\">:</span> <span class=\"token function\">getJwtIssuer</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>jwtType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이렇게 생성할 때 <strong>issuer</strong> <strong>audience</strong>를 전달했다면 검증할 때도 같이 넣어줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>jwtService<span class=\"token punctuation\">.</span><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span>jwt<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  secret<span class=\"token punctuation\">,</span>\n  audience<span class=\"token operator\">:</span> <span class=\"token function\">getJwtAudience</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  issuer<span class=\"token operator\">:</span> <span class=\"token function\">getJwtIssuer</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JWT_TYPE</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ACCESS_TOKEN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">as</span> JwtVerifyOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이런 식으로 처리했다.<br>\n저 <strong>JwtVerifyOptions</strong> 타입을 타고 들어가면 아래와 같은 것을 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token generic-function\"><span class=\"token function\">verify</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> object <span class=\"token operator\">=</span> <span class=\"token builtin\">any</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>token<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> options<span class=\"token operator\">?</span><span class=\"token operator\">:</span> JwtVerifyOptions<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">JwtVerifyOptions</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">jwt</span><span class=\"token punctuation\">.</span>VerifyOptions <span class=\"token punctuation\">{</span>\n    secret<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> Buffer<span class=\"token punctuation\">;</span>\n    publicKey<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> Buffer<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">VerifyOptions</span> <span class=\"token punctuation\">{</span>\n    algorithms<span class=\"token operator\">?</span><span class=\"token operator\">:</span> Algorithm<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    audience<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> RegExp <span class=\"token operator\">|</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> RegExp<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    clockTimestamp<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    clockTolerance<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/** return an object with the decoded `{ payload, header, signature }` instead of only the usual content of the payload. */</span>\n    complete<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    issuer<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    ignoreExpiration<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    ignoreNotBefore<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    jwtid<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/**\n     * If you want to check `nonce` claim, provide a string value here.\n     * It is used on Open ID for the ID Tokens. ([Open ID implementation notes](https://openid.net/specs/openid-connect-core-1_0.html#NonceNotes))\n     */</span>\n    nonce<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    subject<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    maxAge<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<h2 id=\"궁금점\" style=\"position:relative;\"><a href=\"#%EA%B6%81%EA%B8%88%EC%A0%90\" aria-label=\"궁금점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>궁금점</h2>\n<p>기존에 <strong>AuthGuard</strong>부분에서 좀 더 조작하면 할 수 있을 것 같았는데 너무 시간을 빼먹어서 진행하지 않았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ExecutionContext<span class=\"token punctuation\">,</span> Injectable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AuthGuard <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/passport'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AccessJwtAuthGuard</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AuthGuard</span><span class=\"token punctuation\">(</span><span class=\"token string\">'accessJwt'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token generic-function\"><span class=\"token function\">handleRequest</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>TUser <span class=\"token operator\">=</span> <span class=\"token builtin\">any</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>err<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> user<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> info<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> context<span class=\"token operator\">:</span> ExecutionContext<span class=\"token punctuation\">,</span> status<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> TUser <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">JsonWebTokenError</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'errror = '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// return { \"data : \": \"test\" } as any;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleRequest</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string-property property\">'data : '</span><span class=\"token operator\">:</span> <span class=\"token string\">'test'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string-property property\">'data : '</span><span class=\"token operator\">:</span> <span class=\"token string\">'aaaa'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleRequest</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">,</span> info<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존에는 위와 같이 작성했는데 만료하는 시점은 잡을 수 있었지만 컨트롤러에서 바로 에러 응답을 해버렸다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Post</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">UseGuards</span></span><span class=\"token punctuation\">(</span>AccessJwtAuthGuard<span class=\"token punctuation\">)</span>\n    <span class=\"token function\">testJwt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> ok<span class=\"token operator\">:</span> <span class=\"token string\">\"ok\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>정녕 <strong>passport-jwt</strong>에서는 약간의 커스텀 처리를 못하는 것인지…<br>\n이 부분은 시간이 나면 다시 찾아봐야겠다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#nestjs%EC%97%90%EC%84%9C-jwt-%EC%82%AC%EC%9A%A9%EC%8B%9C-error-%EC%BB%A4%EC%8A%A4%ED%85%80-%EC%B2%98%EB%A6%AC\">Nest.js에서 JWT 사용시 Error 커스텀 처리</a></li>\n<li><a href=\"#%EA%B6%81%EA%B8%88%EC%A0%90\">궁금점</a></li>\n</ul>\n</div>","frontmatter":{"date":"2023.02.13","title":"23년 2월 13일 TIL & 개발노트 (흑우집합소)","categories":"til","emoji":"📜"},"fields":{"slug":"/til/230119_til/"}},"prev":{"id":"d95f1d8c-2e58-5d51-8ebd-205cd21b4629","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAp0lEQVQY042RwQ6DIBBE/f+Pa40RY1UQpYCAVovYXpRtUhNP1brH3XmZyU4AO/Mcne6GwTrv9yQQ/NziShSURykuKMeV8Gdg/3UpWcOEBoBLnAMAk4bUcrseOc/L0pgHExplNCP3KCW67aXu5nn5H3uFeWPiW4kyekW5OglvsSuuBjsp07vpXQt9NvYqKpkME4xyGiYFYdLvfDzYq8G6l2p7O04HVX0AR+PRAKwnNFQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/be235cd725cdd896a1c605822b7f6ca8/7c297/img01.webp 180w,\n/static/be235cd725cdd896a1c605822b7f6ca8/33ecc/img01.webp 360w,\n/static/be235cd725cdd896a1c605822b7f6ca8/df77d/img01.webp 720w,\n/static/be235cd725cdd896a1c605822b7f6ca8/5c666/img01.webp 1080w,\n/static/be235cd725cdd896a1c605822b7f6ca8/95f20/img01.webp 1440w,\n/static/be235cd725cdd896a1c605822b7f6ca8/1d83c/img01.webp 1640w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/be235cd725cdd896a1c605822b7f6ca8/e9ea2/img01.png 180w,\n/static/be235cd725cdd896a1c605822b7f6ca8/53918/img01.png 360w,\n/static/be235cd725cdd896a1c605822b7f6ca8/242a6/img01.png 720w,\n/static/be235cd725cdd896a1c605822b7f6ca8/b4ad3/img01.png 1080w,\n/static/be235cd725cdd896a1c605822b7f6ca8/89066/img01.png 1440w,\n/static/be235cd725cdd896a1c605822b7f6ca8/22c1a/img01.png 1640w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/be235cd725cdd896a1c605822b7f6ca8/242a6/img01.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h1 id=\"개발-기간은-길었지만\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%B0%9C-%EA%B8%B0%EA%B0%84%EC%9D%80-%EA%B8%B8%EC%97%88%EC%A7%80%EB%A7%8C\" aria-label=\"개발 기간은 길었지만 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개발 기간은 길었지만…</h1>\n<p>드디어 오픈한 <a href=\"https://bcow.world\">흑우집합소</a></p>\n<p>전에 <strong>MyMeLink</strong> 서비스를 개발한 뒤에 구상한 서비스다.<br>\n사실 흑우집합소는 이전에 한번 <strong>Spring Boot</strong> + <strong>Thymeleaf</strong>로 만들었던 서비스인데 모바일 환경 미지원에 버그가 정말 많았다…</p>\n<p>버그라기 보다는 코드가 정말 똥 그 자체였다.<br>\n그래서 이걸 차라리 새로 만들자 라고 해서 만들게 되었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACRUlEQVQ4y42Ta2vbMBiF8///0D6NsY7RDpaubOstTWjS2vXdlm3d7eQZUuhoxhgTCL0y0jlH7zleaK3521RK0XUdQgjGcURKyTRNJ3Oe59+rcw5rLQv+MQJo0zTUdR0B/2csAkNA996hlaKqavq+RxsTwQKQsQ43zVFpkRdUZUXbtlGd9z4qDONwOLAIYNp47AS9diwvv1EVNd5MFGVJP4w4qbCiZ5CK5yQly0vaTiDCt2Fkmt4Aer/HjhmueMf47RMXHz7z8cc5y+131nfreLBYr0murmIt7Yzxh1i/9vcPhTN6rHDtV9qbS87en/Hl5pK7bMPu8YlwtLq9I7u4IMB0o0Uaz36/pyzLCHoCGJzRUmPtAaktq7sbXrY7uqIkfdrFZ7abDcVyGS8NyqHdESD0MTx5nvengM4ohq7GqhHR1AyiRbQNdZEzeU9Z1TynaexVINXGRTNe43Si0BiLjcaYeKETAqkUSmvarosJcC488YBSmiRJWN2vaNsunrfWRbdPFTqPMSayxr33sQ4BD7WWkq6ssIGkqimSFD1K+qZB1DXzW5etsRitkeMYVz0O8aI1BiVlXAPZMAyxV4Ew1EfFKkbn1GVrGYVADQNqEMiuYRQdcuiRvUArifMTou9JkpSiKMnyItZ5XmCdP81h2EyR2dG0A5tdGgMdvpt5jwlt0IamrMhfMp63Ox4f1mTpC1mSIvvhtIdB/mr1gFQWo3Ky23Pur+/J65r85zWqaaKbz9st3h1/z6aqjrGpauqijJl8BfwFgM00TDX3djkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/7c297/img09.webp 180w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/33ecc/img09.webp 360w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/df77d/img09.webp 720w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/5c666/img09.webp 1080w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/95f20/img09.webp 1440w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/f3efb/img09.webp 1536w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/e9ea2/img09.png 180w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/53918/img09.png 360w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/242a6/img09.png 720w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/b4ad3/img09.png 1080w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/89066/img09.png 1440w,\n/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/e8464/img09.png 1536w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/68ca9aeb85c49d9e3e04d944d3a1f4ca/242a6/img09.png\"\n            alt=\"img09\"\n            title=\"img09\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>위 화면이 옜날 흑우집합소 버전이다.<br>\nPC에서는 잘 보이지만 화면이 줄어들면 정말 사용 못할 정도다.</p>\n<p>마치 iOS로 말하면 Auto-Layout이 적용 안되어 있는 느낌?</p>\n<p>무튼…</p>\n<p>기술은 Spring을 쓰려다가 이제는 새로운 기술로 해보고 싶었다.<br>\n사실 취업 준비할 때는 <strong>Java + Spring</strong>이 거의 정석 빌드 테크였지만,</p>\n<p>당시 취업 목표보다는 기술 스택 바꾸고 새로운 걸 배워서 만들어보자 라는 마인드였고,<br>\n그래서 <strong>MyMeLink</strong>개발 때 사용한 <strong>Typescript</strong>를 사용하여 <strong>Nest.Js</strong> + <strong>Next.JS</strong> 로 만들게 되었다.</p>\n<p>인프라는 아마존에 <strong>Nginx</strong> + <strong>LetsEncrypt</strong> 그리고 <strong>MongoDB</strong>, <strong>CloudFlare</strong>의 <strong>R2</strong> 및 <strong>Worker</strong> 등을 사용했다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtklEQVQ4y1WT228bVRDG/Y/CY1WRqC88IOhL4YGWXKiCekGCPtBCS2hKm4hEFKVNk9RKcaMqF0Oc9BITamN7d23v2T27Zy9nfsi7Li0jfdLMnJlvjr4zpxKGIVEUU5qMMTILGCAFsneQvlPztl77lkY1ocJ/JtRWYekarFwf4ztYuwObSyUeLpS5N+eL38L2w7JXxjMqIqOgjObnhHPvCVMfCOdPjWCZmRSufCxc/USYnhA+P2X54rQwe0b49H3h9qWy19qSpyS0Y8KvLFMTlm/OWeY+FC6czpiezLl6Vvj6rDAzaYvcpY+Ea59ZpicsC5fz/xO+1QNWf8q5NQsLl+HWxZwfZoQfL4584eaXlu+nLTemLDdnLfNzcP3CSBJbCvaGME0gjgQTQZZBzw3w3BDJwPcjXEdhTFY2SfkIVoQgVCilsNYWt8tzweZCRQeC74HvpUSew95WnY3qHn+9HtD5W3PU6NH3NF4HDp/Byzq82IOn65rdmqE5jp/vgtuGSqwFHYAOItLuI1q/b3O/WuVxfQflJvTdBBPnNBs5G0sJ1WVDdTll94HH5u0T7s63eLysefJrzslRTkX1ofUK2sfQbkL7BLwWHB8Ydrcd1ldf4nRj0iQjUAEDb8hgoEH28Xfu87S2SRr0MMZg4pRK+1hYW7BsrQgb9zI2Fy3rizFrP+dsrVjW7mQ4rZHOCW4npPvax+2GOJ0B7Sd1ats1/tGGoG+IdDZ6FCG35fanmSl+iAr9whcyfDUkMRYdpKhQM1CKIAxwjeHw4Ij9kx2SLCZKDPGIMIktcZyQZ5bBUBVbNBwqgkAX2+84/WKyVpZXD1KeL6W8WE45+g0a94bs3x3S/MXQfFTWVBIjpGlWwFdBsR7GJESRKfww1MRRRhxC7wC6+9Ctg/On4B6C8wd09qDXgCiEfwGeObbRetxhWQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/95a6d9fb4aa806d88f57d5431699c84a/7c297/img02.webp 180w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/33ecc/img02.webp 360w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/df77d/img02.webp 720w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/5c666/img02.webp 1080w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/95f20/img02.webp 1440w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/42392/img02.webp 1835w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/95a6d9fb4aa806d88f57d5431699c84a/e9ea2/img02.png 180w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/53918/img02.png 360w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/242a6/img02.png 720w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/b4ad3/img02.png 1080w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/89066/img02.png 1440w,\n/static/95a6d9fb4aa806d88f57d5431699c84a/2e51b/img02.png 1835w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/95a6d9fb4aa806d88f57d5431699c84a/242a6/img02.png\"\n            alt=\"img02\"\n            title=\"img02\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>사실 **<a href=\"https://bcow.world\">흑우집합소</a>**는 완성된 서비스는 아니다.<br>\n원래 목표는 <strong>커뮤니티 플랫폼</strong>이었다.</p>\n<p>로또의 정보를 교류하고, 당첨 정보, 개인 당첨 이력 등을 공유하는 그런?</p>\n<p>그리고 거기에 내가 <strong>로또 전문가에게 받은(?)</strong> 로또 분석법을 녹여서,<br>\n무료로 로또 번호 조합 제공 및 사용자가 직접 커스텀 해서 만드는 그런 서비스가 목표였다.</p>\n<p>하지만 개발 말고 부동산 투자 및 주식 공부, 경제 분야, 미술 학습,<br>\n내가 좋아하는 와인 생활 등을 하면서 시간을 온전히 쏟지 못했다.<br>\n그리고 취미생활인 사진 촬영과 더불어 블로깅 등등…</p>\n<p>그러다가 빨리 완성을 해야 겠다 라는 생각이 들어서 2월달부터 진도를 좀 빼기 시작했다.<br>\n그리고 베타 버전이지만 완성을 했다.</p>\n<h2 id=\"완벽하진-않다\" style=\"position:relative;\"><a href=\"#%EC%99%84%EB%B2%BD%ED%95%98%EC%A7%84-%EC%95%8A%EB%8B%A4\" aria-label=\"완벽하진 않다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>완벽하진 않다.</h2>\n<p>사실 이번 프로젝트는 일주일 전에 오픈을 했었다.<br>\n사이트 홍보는 안하고, 도메인만 밖으로 오픈 시켰다.</p>\n<p>각국의 다양한 환영을 받으며(?) 서비스는 잘 돌아갔다.<br>\n아주 다양한 방법으로 해킹 시도를 하는데 전에 log4j 보안 취약점으로 오기도 하고, 아래 로그처럼 이상한 경로로 잘 타고 들어오려 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{\n    \"_id\": {\"$oid\": \"629439d94cedfd000131d0a6\"},\n    \"accessCountryCode\": \"US\",\n    \"accessUrl\": \"/s/lkx/_/;/META-INF/maven/com.atlassian.jira/jira-webapp-dist/pom.properties\",\n    \"createDate\": {\"$date\": \"2023-03-24T12:28:25.994Z\"},\n    \"httpMethod\": \"GET\",\n    \"msg\": \"{\\\"profile\\\":\\\"real-master\\\"}\"\n  },\n  {\n    \"_id\": {\"$oid\": \"629439da4cedfd000131d0a7\"},\n    \"accessCountryCode\": \"US\",\n    \"accessUrl\": \"/\",\n    \"createDate\": {\"$date\": \"2023-03-24T12:28:26.003Z\"},\n    \"httpMethod\": \"GET\",\n    \"msg\": \"{\\\"profile\\\":\\\"real-master\\\"}\"\n  },</code></pre></div>\n<p>참고로 접근 기록을 Mongo에 담으려다가 이제는 방식을 좀 바꿨다.<br>\n자세한 개발 내역은 <strong>TIL</strong>에서 다룰 예정이다.</p>\n<p>정말… 지금 노션에 쌓여있는 개발 기록을 블로깅화 해야 하는데 이것도 만만치 않을 듯 싶다…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 562px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 123.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsTAAALEwEAmpwYAAABe0lEQVQ4y62Vy66CMBCGeQJiCHJHEbkEvCGoxI0Ll+zg/d9lzD9JCYd4YhUWQ5vS+fLPTDtVDMOgKIroer3S/X6n0+nEc9jlcqE0TQl7LMuSMkUAd7sdHY9H2u/3lOc5G+ZhGJJpmvJAfDRNI1VV2RaLBem63ttyueSNgMqAFThAXV3XVFUVHQ4Hhti23W/6SiFUnM9natuWmqbh3GHtF1gfMgzFeD6ftNls+iJ8C/sD9H2fC4GwUZxfYD0QzgAif8gl1E4GrtdrBuLsYZwUMhxd1+Vq3263eRQGQcDKUGWMk4Ge5/HNADBJkq+u21vgarXqgQh9skIAESpyiHGyQhEyqoxxlmODAz1rUZA7KJzlpogczqYQQCgTRXkHlOqHw5CzLKOiKHgcOovmKgUcbh47vgN9gjIQPTCOY34/8L5st1u+ilCKOf5jXeZsKqIxOI7DbX9o4zWpkNHu0VTRrbuuo8fjwY/WOORhGj4+owivLEsOEcX5z0lG4Qv0F5VCdmoiGwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8bcc6e0c2aa61a2ea2a4bd597e927858/7c297/img08.webp 180w,\n/static/8bcc6e0c2aa61a2ea2a4bd597e927858/33ecc/img08.webp 360w,\n/static/8bcc6e0c2aa61a2ea2a4bd597e927858/d0171/img08.webp 562w\"\n              sizes=\"(max-width: 562px) 100vw, 562px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8bcc6e0c2aa61a2ea2a4bd597e927858/e9ea2/img08.png 180w,\n/static/8bcc6e0c2aa61a2ea2a4bd597e927858/53918/img08.png 360w,\n/static/8bcc6e0c2aa61a2ea2a4bd597e927858/a4f00/img08.png 562w\"\n            sizes=\"(max-width: 562px) 100vw, 562px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8bcc6e0c2aa61a2ea2a4bd597e927858/a4f00/img08.png\"\n            alt=\"img08\"\n            title=\"img08\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>저기에 말고도 더 있다는 게 함정…</p>\n<p>무튼 서비스에 게시판도 달고, 자칭 로또 전문가에게 받은 분석 기법을 사이트에 다 녹여내지 못했다.<br>\n그래도 다행인 건 추천 번호 서비스에는 어느정도 기법을 녹여내서 다행이라(?) 생각이 든다.</p>\n<p>모든 IT 서비스가 그렇겠지만…<br>\n<strong>처음부터 완벽할 수 없고, 완벽하게 출시할 수 없다.</strong></p>\n<p>물론 다 그런건 아니겠지만, 팀이 아닌 순수하게 개인 혼자서 만들어 낸 프로젝트는 미흡할 수 밖에 없다.<br>\n하지만 미흡해도 하나씩 붙여서 완성해 나가면 된다.</p>\n<p>내가 예전에 롤을 좋아했는데 거기 리븐이라는 케릭터가 이런 대사를 한다.<br>\n<strong>부러진 건 다시 붙이면 돼.</strong></p>\n<p>프로젝트를 출시했을 땐 어떻게 해서든 이어 붙여서 형태를 유지한 채 출시할 것이다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD3ElEQVQ4yx2Sa0+TBwCF3xkvU5K5LLsk2zISEzfdVJaNbcxlmkXdFDWzMnREhoYpFJViaUtbsG9rC7QyDTKxFciA0gstpS0UJowVJAOkFFvbtx3KF4myZNmveBb5cHK+PcmTcwSXuQynqYzh20rGu3SM3VUz2aPnvlPPeKea+y4Ds74m/vI2MuU0MtahYfCmnH7bBYbaFNyzq5jp05PwG/C0yBGS/RaeTth5NnmHlYkbrIxZWRm38nTMwpNhA8ujFjLha6SDV8mEDKQDV4m5tMz2qFn0ikghK8sjNv6baiHapUFIBZp4PGJmJWrmWdTIs6jISlRkeUTP47B2LSm/mqRHQcqnYt6pJBUwEPNcZbZXx0PfNRL+azwJi/zerkBYijTzT/wmq/FOpD9vkhhrYSXWyWrMRnpAyaJLgTRQw1JYy5PRJh4NGpl3a1n0icy7tCz2iyx4RVJeDUOtcoRsyMC/CQePo7342g102dRkJ/pYjdt54JSz6FYiBVRkwzoyYZHMcDPpsIUFr56YW0ciYGbOqWWu6xKB6+cR0r46nj9o5HnsFkuTNrJRG6uLdpanjCT6a4m7FCT7a8gGNWQG68gOiWQjFlIhE5mIlXS4mZluNVO//ozbXIaQ8jcgBbQsRRqQQg38HTGRCelIeF6oqljou0jSexlpoBrJX0M6oEEKG5CGLMR9RmadWkLNJQybi+hu+BEhGzaTDpqRhqxkR1pIBsxrCyb71Uh+BXO/lZP0yEm4LpDwXCQ1oCHuq2e6W8N01xXCthLsVXsJG2V0qGUI2eFGUoMijwImshEr0pCZ1GADmaCeh+4qZjrPMt9byVxPBQtuJQ9cOkZvVTHQ9BMO5QHMp7Zz+8JnhIwnuaspQoi5X1zAQDJgIhU0kQ4a14BJv465XgUJv46H/vo1UNRxhUlHNX3iKW5UFFDz7RuIsm20V35JUJThUMkQxlorid65zHSXipluFXFPPSOtFdxrkzN5V8HEnYtMd1Qz3laO1/A9v5z/gvP7X6fkk3VUH3gNy+mdOC59Tcgow14rQ7CW7qa1ooBO5UH6dIX4jCfprD1Mj/YI3XWF3JJ/hbEkj6pDuRR9vJnD2wWK89ZTsW8rmsJ3uF66m57aQ0QsxThUJxDqjr5L5b5XOVeQw5n8zZTk53Aybwsndm2i8IP1HNz2Et/kCux/T+DI++v4Yc8mzhW8gvK7t7Gc/hC7fC9e/VH+aCmlQyNDaCn7FN3xXC4feJPyvVs5k59D0Z6XOb5zA8d2bFxr2a5NnPhoI0W7N3D28y0oDr6FqXgH7ZUvYMcYbjzN/bZyuuuL+R9OmuE9tmaF9AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/300da3540b5ea932962ba5a7aaeacf87/7c297/img05.webp 180w,\n/static/300da3540b5ea932962ba5a7aaeacf87/33ecc/img05.webp 360w,\n/static/300da3540b5ea932962ba5a7aaeacf87/df77d/img05.webp 720w,\n/static/300da3540b5ea932962ba5a7aaeacf87/ef8da/img05.webp 837w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/300da3540b5ea932962ba5a7aaeacf87/e9ea2/img05.png 180w,\n/static/300da3540b5ea932962ba5a7aaeacf87/53918/img05.png 360w,\n/static/300da3540b5ea932962ba5a7aaeacf87/242a6/img05.png 720w,\n/static/300da3540b5ea932962ba5a7aaeacf87/25327/img05.png 837w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/300da3540b5ea932962ba5a7aaeacf87/242a6/img05.png\"\n            alt=\"img05\"\n            title=\"img05\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<br>\n<p>근데 점점 하나씩 완성해 나가면서 저 금간 부분을 잘 붙여서 완성시켜 나가면 된다.<br>\n(라고 난 생각한다 -_-;;;)</p>\n<h2 id=\"근데-로또-서비스는-생성-번호를-만들어주는건-간단할-거-같은데\" style=\"position:relative;\"><a href=\"#%EA%B7%BC%EB%8D%B0-%EB%A1%9C%EB%98%90-%EC%84%9C%EB%B9%84%EC%8A%A4%EB%8A%94-%EC%83%9D%EC%84%B1-%EB%B2%88%ED%98%B8%EB%A5%BC-%EB%A7%8C%EB%93%A4%EC%96%B4%EC%A3%BC%EB%8A%94%EA%B1%B4-%EA%B0%84%EB%8B%A8%ED%95%A0-%EA%B1%B0-%EA%B0%99%EC%9D%80%EB%8D%B0\" aria-label=\"근데 로또 서비스는 생성 번호를 만들어주는건 간단할 거 같은데 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>근데 로또 서비스는 생성 번호를 만들어주는건 간단할 거 같은데?</h2>\n<p>맞는 말이다.<br>\n그냥 1~45 랜덤으로 번호를 주는 방식으로 해주면 말이다.</p>\n<p>사실 작은 썰을 풀면 내가 아주 옛날에 작은 스타텁을 다닐 때 만난 인연이 있다.<br>\n자칭 로또 전문가인 이 기획자분은 로또 2등이 3번되고 3등도 몇번 되었다고 자랑했다.</p>\n<p>당첨 용지를 보니까 진짜 분석이 되나 싶기도 하고…(그렇게 미끼를 문건가…)</p>\n<p>그러다 이 양반이랑 술한잔 하면서 기법을 전수해줬고, (술자리에서 엑셀을 보고 사실 미친놈이라 생각했다…)<br>\n그 뒤부터 나도 간단하게 안드로이드 앱으로 개발하면서 로또를 취미로 아주 작은 금액으로 사기 시작했다.</p>\n<p>그 양반은 2013년부터 5년동안(아마 지금까지 매주 살듯…)<br>\n매주 빠짐없이 사는걸 보고 참 대단하다 싶었다.<br>\n안드로이드로 시작한게 아마 20년도쯔음 이었을거다.</p>\n<p>구매는 보통 5천 ~ 1만원 사이?<br>\n아주 아주 가끔 필 받으면 최대 2만원?</p>\n<p>그 이상은 돈이 아까웠다.<br>\n(로또 매주 5~10만원씩 살 돈으로 와인을 사먹는게…)</p>\n<p>그리고 그 양반 기법이 맞나 싶기도 하면서도 아닌가 싶기도 한게…</p>\n<p>4등이랑 5등은 자주 되었고,<br>\n3등 2번이 되긴 했다.<br>\n물론 자동이 아닌 수동으로 말이다.</p>\n<p>인증이 없으면 신뢰 0%이기에…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSElEQVQoz02SSW/TABCF/dc5IyFxgEptado0juPY8b7v8RY3aRIoKrQSKlUpYpWAI3D4UAwHnjTSvMM8fTMa4cHwKQ/VAY+VAXvqCcfGGCuxaM5yLi+WXF1uaJqEpklZtBldl//zCXWTMK9CmjYhy1xevVwjmJmLlljInkpU+hR1RNtlrJYF21XFelkRhUY/4PsaUWSQ5y5JYmHbMpouUsx9DGPM+bJC2K5bNtslTVdxe3PN1esLuq6gLMOe6vm2o65j8tzHMGWOB3uMxUMsS8IwxL52vW1JtHWMkBUBN7dv+PL1Ex8+vufu/pa2y6mauA+9eHFGUyfkmYfnztDUIbY9wXVkfE/BNMYo02PGp/vEoYmwWOS0XUFVJ1RN0uPvgqoyJEsdNpu2v1c5D/AcFVMXMXSxDza0EY49QZkM2N97hKlNENo2o2kzFm3Rk+zWCwMdx54S+hrdoujJPFtBGj1DPN1HEp8hjg6QxEN8V2GmDDk5ekIa2whVGbNcltR1gmOrGLqELA9wHYXAm1HNI0x9QhrZGLMxrjmhyBxCX8VzpqjygMBVet8tMoR5EVKWMXnmE0cWnqehz0Z4roLvqWzXDYsmxXM1FOUUUTxkKh0hjQ4wZyPmmcfzdc15E3N9sUKIY4cwMgljkyAyiGMT35FJA50qtXCsKbIyRJQHHBw9IfBnrM9K3t295cf3b/z69ZOdckelDEyEeZ0yr+L+316sWy43HS+XNasq4awICT0DSRwQ2iqX23N+//wb8L8+f7gn0Mes6pQ/cyB/y0Cw6nkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fdf1f5a86ad31d75a38e5134d966aeee/7c297/img06.webp 180w,\n/static/fdf1f5a86ad31d75a38e5134d966aeee/33ecc/img06.webp 360w,\n/static/fdf1f5a86ad31d75a38e5134d966aeee/df77d/img06.webp 720w,\n/static/fdf1f5a86ad31d75a38e5134d966aeee/d0742/img06.webp 900w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fdf1f5a86ad31d75a38e5134d966aeee/e9ea2/img06.png 180w,\n/static/fdf1f5a86ad31d75a38e5134d966aeee/53918/img06.png 360w,\n/static/fdf1f5a86ad31d75a38e5134d966aeee/242a6/img06.png 720w,\n/static/fdf1f5a86ad31d75a38e5134d966aeee/e7448/img06.png 900w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fdf1f5a86ad31d75a38e5134d966aeee/242a6/img06.png\"\n            alt=\"img06\"\n            title=\"img06\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>내 개인 블로그에도 올렸는데 그거 그대로 가져왔다.<br>\n용지도 그때 찍어둔게…</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 693px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 127.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2847dd02113e8640a51294230c245438/7c297/img03.webp 180w,\n/static/2847dd02113e8640a51294230c245438/33ecc/img03.webp 360w,\n/static/2847dd02113e8640a51294230c245438/a5a71/img03.webp 693w\"\n              sizes=\"(max-width: 693px) 100vw, 693px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2847dd02113e8640a51294230c245438/e9ea2/img03.png 180w,\n/static/2847dd02113e8640a51294230c245438/53918/img03.png 360w,\n/static/2847dd02113e8640a51294230c245438/ee2da/img03.png 693w\"\n            sizes=\"(max-width: 693px) 100vw, 693px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2847dd02113e8640a51294230c245438/ee2da/img03.png\"\n            alt=\"img03\"\n            title=\"img03\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></td>\n<td><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 644px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 133.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d4011b3fa3acde1e63f7d03d6ec1899d/7c297/img04.webp 180w,\n/static/d4011b3fa3acde1e63f7d03d6ec1899d/33ecc/img04.webp 360w,\n/static/d4011b3fa3acde1e63f7d03d6ec1899d/ce8f6/img04.webp 644w\"\n              sizes=\"(max-width: 644px) 100vw, 644px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d4011b3fa3acde1e63f7d03d6ec1899d/e9ea2/img04.png 180w,\n/static/d4011b3fa3acde1e63f7d03d6ec1899d/53918/img04.png 360w,\n/static/d4011b3fa3acde1e63f7d03d6ec1899d/e8cbb/img04.png 644w\"\n            sizes=\"(max-width: 644px) 100vw, 644px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d4011b3fa3acde1e63f7d03d6ec1899d/e8cbb/img04.png\"\n            alt=\"img04\"\n            title=\"img04\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></td>\n</tr>\n</tbody>\n</table>\n<p>사진은 개인정보 및 구매 정보가 노출될 부분이 있어서 지웠다.<br>\n하지만 원본은 내 당첨 사실 증명을 위해 iCloud 안에…</p>\n<p>참고로 3등 이상 당첨은 은행가서 받는데 용지를 안돌려준다.<br>\n이건 지점마다 틀린거 같긴 한데 난 두 지점 다른데 가봤는데 다 안줬다 -_-;;</p>\n<p>무튼…<br>\n그렇게 하다가 그 양반의 부탁으로 이걸 웹 서비스로 만들게 되었고,<br>\n초창기 버전이 나와서 오픈은 제대로 못하고 그 양반이랑 몇몇 사람들만 쓰는 폐쇄적 서비스로 오픈했다.</p>\n<p>이후 다시 이걸 제대로 만들어서 이번에 오픈을 했다.</p>\n<p>근데 내가 로또는 항상 그 전문가 양반하고 이야기 하지만…<br>\n로또는 운으로 하는 일종의 운빨게임이다.<br>\n분석이라는거 자체가 무의미하다고 보면 된다.</p>\n<p>하지만 그 양반 왈…<br>\n<strong>자신의 분석 기법으로 좀 추리면 불가능한 수를 제외할 때 당첨확률은 올라가지 않을까?</strong><br>\n(솔직히 될놈 될 아닐까?)</p>\n<p>뭐 로또는 그냥 개인 생각에 맡기지만…<br>\n그냥 <strong>운으로</strong> 하는게 좋다.</p>\n<p>오죽하면 나도 내 블로그에 추천 번호 쓰면서 아래와 같은 맨트를 달아둔다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 687px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABf0lEQVQoz32S63LqMAyEef8HK9NwhzRA6YU7pIlDYYABOtHXszYHfrRTz8iSbXm9WrkCcD6dyLOMwjl22y0uz30svykKnHNczmcww8oSrPTxzcr7uqKpBC4Cvnofm3EqSx+fvr58jobx96j4hOMRlnNYLiBdw3wKHymslzCfwX4P6QpbLbz3eTKXw3p1zy9yKv7VPMMeq1gjwuIuFj1gSYx1mlirjqVrrP8EvQ42GkDchrgLswk8D6BVC/7lOQCyKaBWhck7vI6gHkHcgfEbDBOYjGHwBIMEmrVwpv12A5IedFpQuFCynz83IentJVySDfvw/gpiJr/bhdIPe7hc4HAIJrmOB1DTboDSQiBiJ5bSR3E/hl477Ank/yjL3zviu+z/zTmwE4BKksgCUcliKLbysuwj6Kdyo2rQ7gegc9CsB5bqZBLDaAjdFkwnAagRedE9uB7X+WJ2XY9Cl28lbz/DJZW5Wl5LH4fELA1fSmD6IuqsmM+m91xprLx/DL8BB0r4Z5k54l0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9cf931dc6a14d9dc58804218dd50f338/7c297/img07.webp 180w,\n/static/9cf931dc6a14d9dc58804218dd50f338/33ecc/img07.webp 360w,\n/static/9cf931dc6a14d9dc58804218dd50f338/0ed20/img07.webp 687w\"\n              sizes=\"(max-width: 687px) 100vw, 687px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9cf931dc6a14d9dc58804218dd50f338/e9ea2/img07.png 180w,\n/static/9cf931dc6a14d9dc58804218dd50f338/53918/img07.png 360w,\n/static/9cf931dc6a14d9dc58804218dd50f338/9490d/img07.png 687w\"\n            sizes=\"(max-width: 687px) 100vw, 687px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9cf931dc6a14d9dc58804218dd50f338/9490d/img07.png\"\n            alt=\"img07\"\n            title=\"img07\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h2 id=\"근데-기술적인-부분은\" style=\"position:relative;\"><a href=\"#%EA%B7%BC%EB%8D%B0-%EA%B8%B0%EC%88%A0%EC%A0%81%EC%9D%B8-%EB%B6%80%EB%B6%84%EC%9D%80\" aria-label=\"근데 기술적인 부분은 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>근데 기술적인 부분은?</h2>\n<p>기술 블로그인데 너무 사설이 길었다.<br>\n뭐 여기서 자세하게 쓰기엔 양이 방대해서 TIL에 조금씩 녹여서 써보고…</p>\n<p>그리고 슬슬 개발자로 일해보기 위해 포트폴리오 용으로 쓸 겸 가볍게 정리해본다.</p>\n<h3 id=\"개발-언어\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%B0%9C-%EC%96%B8%EC%96%B4\" aria-label=\"개발 언어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개발 언어</h3>\n<p>당시 새로운 기술을 쓰기 전에 언어를 정해보려 했다.<br>\n또 자바 스프링을 쓰자니… 대기업 취업용도 아니고…</p>\n<p>이제는 새로운거…특히 당시 React가 엄청 활발해지고(물론 전에도 그랬지만 -_-;;)<br>\nJavascript 하나를 쓰면 백엔드(Node.Js)와 프론트엔드(React)를 쓸 수 있어서 Javscript를 선택했다.</p>\n<p>근데 당시 마지막 스타텁 다닌 회사에 지인이…(어찌보면 이쪽 기술을 쓸 수 있게 잘 알려준 고마운 인연이다.)<br>\n한번 써보라고 하고, 이것저것 많이 알려주고 셋팅도 도와줬다.</p>\n<p>원래 같이 미니 프로젝트도 Javascript 배울 겸 했는데 그건 중간에 내가 나왔다.</p>\n<p>무튼…Javascript 쓰다가 Typescript를 추천해줬고, 난 원래부터 Type이 강한 언어를 좋아해서,<br>\n<strong>Typescript를 주 언어로 쓰게 되었다.</strong></p>\n<p>여담인데 난 밥벌이 및 용돈벌이를 iOS로 대학생 때 시작했는데 당시 <strong>Objective-C</strong>로 개발을 했다.<br>\n이거 써본 사람은 알 것이다.<br>\n형 지정도 강하고, 메모리 관리까지…</p>\n<p>무튼 그 뒤로 Java만 쭉 썼고…<br>\n그래서 그런지 일부 개발자들이 Javascript의 편리함에서 딱딱한 Typescript를 받아들이기 어려웠다는데…</p>\n<p>난 정 반대였다.<br>\n프리한 Javascript가 좀 이질적이고 이상하고, 다른 의미로 어려웠다.</p>\n<h3 id=\"백엔드-back-end\" style=\"position:relative;\"><a href=\"#%EB%B0%B1%EC%97%94%EB%93%9C-back-end\" aria-label=\"백엔드 back end permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>백엔드 (Back-End)</h3>\n<p><strong>Nest.JS</strong>를 사용했다.<br>\n왜 사용했냐…</p>\n<p>이거 써보면 알겠지만 거의 Spring 판박이다.<br>\nAOP나 스프링의 각종 철학과 페러다임이 잘 녹아있다.</p>\n<p>심지어 스프링의 어노테이션 문법을 Nest 진영에서는 데코레이터라고 해서 쓴다.<br>\n둘이 완전 같은건 아닌데 유사하다.<br>\n물론 파이썬에도 데코레이터가 있지만…일단 논외로…</p>\n<p>난 Node.js는 예제만 돌려봤지 이거를 제대로 써본적은 없다.<br>\n그래서 배포할 때 PM2 이런것도 배워가며 썼다.</p>\n<p>무튼 Nest.Js는 크게 어려운 것 없이 잘 적응해서 <a href=\"https://bcow.world\">흑우집합소</a>의 뒷단을 맡는 프레임워크로 사용 중이다.</p>\n<h3 id=\"프론트엔드-front-end\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-front-end\" aria-label=\"프론트엔드 front end permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프론트엔드 (Front-End)</h3>\n<p><strong>Next.Js</strong>를 사용했다.</p>\n<p>웃긴건…\n난 리엑트(React)도 안써봤다.<br>\n그래서 노마드코더에서 하는 무료강의랑 유튜브 미쿸 인도 성님들꺼 강의 몇개 들은게 끝이다.</p>\n<p>그리고 그 뒤에 Next.Js라는게 있다 해서 써보니 React의 일부 설정을 자동으로 편하게 해줬다.<br>\n시간이 부족했던 나는 일단 **마법(?)**을 부리는 Next.Js를 선택했다.</p>\n<p>물론 개발이 어느정도 끝나면 조금씩 기본기를 올리면 된다는 마인드로…</p>\n<p>시범 빠따용으로 <a href=\"https://myme.link\">MyMe.Link</a>를 통해서 약간 감을 익혔다.\n이때 많이 고생했다.</p>\n<p>맨땅 헤딩하는게 오랜만에 겪으니 참 불쾌했지만 뭐 어쩔수 있나…</p>\n<p>무튼 Next.Js를 쓰니 정말 라우팅 설정부터 해서 특히 미들웨어 성향을 가지는 <strong>Api Route</strong>기능은 매우 유용했다.</p>\n<p>프론트엔드라는 영역은 처음 해보는데 나름 재미있었다.<br>\n프론트로 취업도 생각해봤지만…<br>\n경력직 인정이 안되서… OTL</p>\n<p>컴포넌트 나누기, 도메인 정하기, SSR 등 프론트 고민을 위해 원티드의 챌린지를 매월 듣는 중이다.</p>\n<p>그리고 <strong>TailwindCss</strong>를 사용한다.<br>\nCSS 프레임워크로 원래 관심이 있었고, 부트스트랩이나 아주 예전에 쓰던 <strong>Semantic-UI</strong>도 다시 써볼까 했지만…<br>\n그냥 TailwindCss 쓰길 잘한것 같다.</p>\n<h3 id=\"데이터베이스-mongodb\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-mongodb\" aria-label=\"데이터베이스 mongodb permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터베이스 (MongoDB)</h3>\n<p>MongoDB를 선택한 건 나쁜 선택은 아니었던 것 같다.<br>\nRDB를 쓰면 데이터가 딱 스키마에 들어가게끔 짜야 하는데, 로또 생성 규칙이나 분석법 등은 Json 형태로 저장해야 했다.</p>\n<p>로또 판매 데이터나 로또 회차 정보와 같은 복권사에서 제공하는 데이터는 모두 정형화 되어 있다.<br>\n하지만 엑셀 분석 데이터나 공식, 그리고 생성 규칙 등은 좀 유동적이고 비정형이 많다.</p>\n<p>그래서 MongoDB를 선택했다.</p>\n<p>일부 데이터는 RDB로 옮길까 했지만 일단 그건 서비스가 잘 되서 안정성을 높일 때 선택할 옵션인 것 같다.</p>\n<h3 id=\"인프라-infra\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%ED%94%84%EB%9D%BC-infra\" aria-label=\"인프라 infra permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인프라 (Infra)</h3>\n<p>기본은 AWS의 EC2 무료 플랜으로 시작했다.<br>\n잘 되면 그때는 머니파워로…</p>\n<p>도메인은 어딘가에서 구입했고, Route53으로 연결했다.<br>\nHTTPS를 위해서 LetsEncrypt를 사용했다.<br>\n그리고 Http => Htts 프록시 및 기타 서비스 관리를 위해 nginx를 사용했다.</p>\n<p>파일 업로드를 위해서는…<br>\n현재는 빈약하지만… 개인 정보에서 프로필 이미지 쪽을 위해서 CloudFlare의 R2를 사용했다.<br>\n아마존 S3를 쓸까 했지만 데이터 트랜스 피가 있고, 새로운 것을 한번 써보자는 마인드로 써봤다.</p>\n<p>이와 관련해서는 2개의 포스팅을 남겼다.<br>\n궁금하신 분은 <a href=\"https://elfinlas.github.io/cloud-flare/230127_use_r2/\">CloudFlare R2 사용해보기 Part 1 (With Nest.Js)</a><br>\n<a href=\"https://elfinlas.github.io/nest_js/230203_r2_nestjs/\">CloudFlare R2 사용해보기 Part 2 (With Nest.Js)</a></p>\n<p>포스팅을 참고하자.</p>\n<h2 id=\"너무-길었다-정리-요약\" style=\"position:relative;\"><a href=\"#%EB%84%88%EB%AC%B4-%EA%B8%B8%EC%97%88%EB%8B%A4-%EC%A0%95%EB%A6%AC-%EC%9A%94%EC%95%BD\" aria-label=\"너무 길었다 정리 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>너무 길었다. 정리 요약</h2>\n<p>이번 프로젝트를 하면서 어렵다기 보다는 뭔가 귀찮은게 많았다.<br>\n개발자의 삶을 다시 살면 재미있을 것 같아서 시작한 것인데 후회하진 않는다.</p>\n<p>이 <a href=\"https://bcow.world\">흑우집합소</a>는 혼자서 기획, 디자인, 개발(백,프론트,인프라)을 맡아서 한 프로젝트다.<br>\n물론 주요 핵심인 분석 자료는 그 양반이 준 거지만…<br>\n이제는 분석 자료를 나에게 다 양도한다 해서 뭐 나혼자 했다 해도 무방할듯 싶다. ㅎㅎ</p>\n<p>진짜 OpenAI를 잘 썼다.<br>\nOpenAI 덕분에 일부 반복적인 코드나 간단한 로직은 맡겨서 수월했다.</p>\n<p>하지만 Port &#x26; Adaptor 아키텍쳐 적용이나, 내가 가진 공식을 코드화 시키는건 불가능했기에,<br>\n이 부분은 내 영역이었다.</p>\n<p>사실 이제부터 시작인듯 싶다.<br>\n아직 미구현 기능도 많고, 약간 UI 버그 및 코드 리팩토링도 많이 남아있다.</p>\n<p>오늘은 Github에 각종 이슈 및 해야 할 일을 정리하고…<br>\n간만에 밀린 블로그 글이나 남겨봐야겠다.</p>\n<p>혹시 로또하시는 분은 <a href=\"https://bcow.world\">흑우집합소</a>도 이용해주시면 감사하겠다.<br>\n로또 관련된 흑우집합소 포스팅은 <a href=\"https://blog.naver.com/wisseraph\">개인 취미 블로그</a>에서 이어갈 예정이다.</p>\n<p>나는 1등은 안되었지만…<br>\n이 글을 읽고 어느 누군가가 흑우집합소에서 나온 번호로 1등이 되시길 기원하며…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQCAwUG/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAYUoNjqHPBf/xAAbEAACAQUAAAAAAAAAAAAAAAACAwEAERIkQv/aAAgBAQABBQJ2LRiBEAay3ATp1//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAEEAwEAAAAAAAAAAAAAAAEAAhARIjFRcv/aAAgBAQAGPwJoYrvRWNEdh3qP/8QAGhABAQEAAwEAAAAAAAAAAAAAAQARQWGRof/aAAgBAQABPyFAIm6t30sL02Mv1I7vGW//2gAMAwEAAgADAAAAEID/AP/EABcRAQADAAAAAAAAAAAAAAAAAAABITH/2gAIAQMBAT8QnVP/xAAXEQEBAQEAAAAAAAAAAAAAAAABABFB/9oACAECAQE/EEXtjf/EABwQAQEBAQEAAwEAAAAAAAAAAAERIQAxUXGBof/aAAgBAQABPxCSphMrGnuucZJosNGy36/vLzq+WvvNCQQRDfO1ghV9ibvMOKfvf//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/26d565eafed2d919e7d8967c58f4b3b2/7c297/img10.webp 180w,\n/static/26d565eafed2d919e7d8967c58f4b3b2/33ecc/img10.webp 360w,\n/static/26d565eafed2d919e7d8967c58f4b3b2/df77d/img10.webp 720w,\n/static/26d565eafed2d919e7d8967c58f4b3b2/16274/img10.webp 850w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/26d565eafed2d919e7d8967c58f4b3b2/98e5d/img10.jpg 180w,\n/static/26d565eafed2d919e7d8967c58f4b3b2/543cd/img10.jpg 360w,\n/static/26d565eafed2d919e7d8967c58f4b3b2/20801/img10.jpg 720w,\n/static/26d565eafed2d919e7d8967c58f4b3b2/8a34a/img10.jpg 850w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/26d565eafed2d919e7d8967c58f4b3b2/20801/img10.jpg\"\n            alt=\"img10\"\n            title=\"img10\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PS : 클로즈 베타 때 로그에 3등이 나왔었는데 지인이 그 번호를 안썼다고…</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%99%84%EB%B2%BD%ED%95%98%EC%A7%84-%EC%95%8A%EB%8B%A4\">완벽하진 않다.</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B7%BC%EB%8D%B0-%EB%A1%9C%EB%98%90-%EC%84%9C%EB%B9%84%EC%8A%A4%EB%8A%94-%EC%83%9D%EC%84%B1-%EB%B2%88%ED%98%B8%EB%A5%BC-%EB%A7%8C%EB%93%A4%EC%96%B4%EC%A3%BC%EB%8A%94%EA%B1%B4-%EA%B0%84%EB%8B%A8%ED%95%A0-%EA%B1%B0-%EA%B0%99%EC%9D%80%EB%8D%B0\">근데 로또 서비스는 생성 번호를 만들어주는건 간단할 거 같은데?</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B7%BC%EB%8D%B0-%EA%B8%B0%EC%88%A0%EC%A0%81%EC%9D%B8-%EB%B6%80%EB%B6%84%EC%9D%80\">근데 기술적인 부분은?</a></p>\n<ul>\n<li><a href=\"#%EA%B0%9C%EB%B0%9C-%EC%96%B8%EC%96%B4\">개발 언어</a></li>\n<li><a href=\"#%EB%B0%B1%EC%97%94%EB%93%9C-back-end\">백엔드 (Back-End)</a></li>\n<li><a href=\"#%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-front-end\">프론트엔드 (Front-End)</a></li>\n<li><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-mongodb\">데이터베이스 (MongoDB)</a></li>\n<li><a href=\"#%EC%9D%B8%ED%94%84%EB%9D%BC-infra\">인프라 (Infra)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%84%88%EB%AC%B4-%EA%B8%B8%EC%97%88%EB%8B%A4-%EC%A0%95%EB%A6%AC-%EC%9A%94%EC%95%BD\">너무 길었다. 정리 요약</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2023.03.29","title":"로또 커뮤니티 서비스 흑우집합소 오픈하다","categories":"my_project","emoji":"📜"},"fields":{"slug":"/my_project/230329_bcow_start/"}},"site":{"siteMetadata":{"siteUrl":"https://elfinlas.github.io","comments":{"utterances":{"repo":"elfinlas/blog_utterances"}},"projects":[{"title":"마와셀(웹) - 와인 가격 비교","description":"와인 가격 비교 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223393940649","github":"","web":"https://appmyc.info","googlePlay":"","appStore":""}},{"title":"마와셀(엡) - 와인과 셀러 관리, 시음노트","description":"보유한 와인의 관리, 시음노트 작성, 보유 와인 셀러의 관리 어플리케이션","techStack":["Dart","Flutter","hive","provider"],"thumbnailUrl":"myc_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223531933037","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.myc","appStore":"https://itunes.apple.com/kr/app/apple-store/6474965246"}},{"title":"흑우집합소(웹) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Typescript","React","Next.Js","Nest.Js"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223059966682","github":"","web":"https://bcow.world/","googlePlay":"","appStore":""}},{"title":"흑우집합소(앱) - 로또번호 추천 서비스","description":"로또번호 추천 서비스","techStack":["Dart","Flutter","drift","provider"],"thumbnailUrl":"bcow_icon.png","links":{"post":"https://blog.naver.com/wisseraph/223232966579","github":"","web":"","googlePlay":"https://play.google.com/store/apps/details?id=dev.mhlab.bcow_world","appStore":"https://itunes.apple.com/kr/app/apple-store/6470312130"}}]}}},"pageContext":{"slug":"/til/230214_til/","nextSlug":"/til/230119_til/","prevSlug":"/my_project/230329_bcow_start/"}},"staticQueryHashes":["1186322783","1321405810","3649515864"]}
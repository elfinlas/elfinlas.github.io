{"componentChunkName":"component---src-templates-blog-post-js","path":"/til/230114_wanted_preon_back02/","result":{"data":{"site":{"siteMetadata":{"title":"MHLab blog","author":"MHLab","siteUrl":"https://elfinlas.github.io","comment":{"disqusShortName":"","utterances":"elfinlas/blog_utterances"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"d20fa7a5-5254-5985-89e5-aa17fcbaf61d","excerpt":"오늘의 강의는.. 2일차 부터는 실제 Nest.Js에 대해서 알아보고, 포트 앤 어뎁터 아키텍쳐(Ports and Adapters Architecture…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 775px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b5f24e21be04a562b4404a504cee629c/49bb6/img01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADOklEQVQ4y12US2xTVxCGL6JI4SGKyqpCSEhUQgi1u3bXXTesWLQLFixAFLoBJAQrSFUqqCqRCtQGKU1ACMIr1ECihEAehNqxY7duTOw08Su243fi2I7feRDC1zk3Nk1Y/Jpzzp3555+Zc642+bbI+wgtF0hQJl5FsoqY4HZqjFPuXr4caMG3nOOY8zG7Oxs47ujgK0szWo2gZoOCyNsSL0txBitJHb3FKC9kb5b1X/MpJpaLfDv8lAPuh1ycsfAgOc6n/b9xIWNaIVxNGhEkqfBL3MnlmFOsi9MBK5dlf27STr3g9+lxQuL3cj5KFIlfKnLW08PdnAtNEdXIlDrXYobxpVlGFtN4l3KMvs7o6v5ZmNG/2UWhbW5a9/Uv5Qm8KRCuCvK9zv1PGKWEYyHNYa+R00ErJyaGaEm5GRCyo16TrrJBVNaH7fSVYvwUfcV3PpOeRLVIcSjiNQrVgVWyd+bDPCtE6JHeqSR30j7acyH+LCekj1OiOotR1up84k1ejwsu53XVWrDK7JEynwtBbzGmB1rnpnRSVZ4ajDpT5aqz2nBM5aROrDji0ncFTZEF9JLLTAipfzGLWRwNs0Hd+ZHY+xk/bdmArrhVVD0RtUOScEyUuiVGtWswF8GSj6KZ5UOeBeyFOMfGTRwM/013Jc6wlHYr5cUpQ1HDUcEesYpArVWp0WrvZiT+6oiRPdcvon092s8RWzf7njRTN2Tgg8E2Prd3801fGxtsBgyFMGnm3vVYDUChNtmAEE8JocHr4LNrF9A2d8jt/rWebe1NbBv8g/XXfkS7dJa6h43scnRhlJ6q1xKQptcGuOaqCWGSeZ6G/mV/489oH3XdYPMPJ9nx4g4fWttZ13SJLYJNxnuckauSEeeQ9CgipGGxNbxP2BN1c/RuC9rWZzfZe+V7PjY0st35nI3mR2zov80Xfa048jH8c2nc5RTu0jQesZ5KCq+crX6qCWnJQNLP1WELWl33DY6bOzlv7GBnRxOfiNJDtk5MMQ+eQhLnbAyXYCQdwZVdWY/lE+8Ia4/ilSRsdY+ibepq5pzPSkFkW9IhbNmw/mdJyH6yWuoKKqvW5TU/lIj4OYvTNJj6+Q+BDAs+d+F0VwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b5f24e21be04a562b4404a504cee629c/77434/img01.webp 300w,\n/static/b5f24e21be04a562b4404a504cee629c/411c4/img01.webp 600w,\n/static/b5f24e21be04a562b4404a504cee629c/1230c/img01.webp 775w\"\n              sizes=\"(max-width: 775px) 100vw, 775px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b5f24e21be04a562b4404a504cee629c/a8a0d/img01.png 300w,\n/static/b5f24e21be04a562b4404a504cee629c/dface/img01.png 600w,\n/static/b5f24e21be04a562b4404a504cee629c/49bb6/img01.png 775w\"\n            sizes=\"(max-width: 775px) 100vw, 775px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b5f24e21be04a562b4404a504cee629c/49bb6/img01.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h1 id=\"오늘의-강의는\" style=\"position:relative;\"><a href=\"#%EC%98%A4%EB%8A%98%EC%9D%98-%EA%B0%95%EC%9D%98%EB%8A%94\" aria-label=\"오늘의 강의는 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>오늘의 강의는..</h1>\n<p>2일차 부터는 실제 Nest.Js에 대해서 알아보고, <strong>포트 앤 어뎁터 아키텍쳐(Ports and Adapters Architecture)</strong>에 대해 설명을 하는 시간을 가졌다.<br>\n강의를 들으면서 내용을 정리한 부분이다.</p>\n<p>옆에서 강의 틀고 노션 및 수기로(개판 필기체를 해석 하는데 힘들었다…) 작성한 것을 다시 곱씹고 하면서 강의 내용을 정리했다.<br>\n이렇게 라이브를 직접 옮기면서 작성한 것을 정리한 것이라 약간 엉성할 수 있다.<br>\n이 부분은 감안하고 봐주시길 바란다.</p>\n<br>\n<h2 id=\"강사님의-이야기-시간\" style=\"position:relative;\"><a href=\"#%EA%B0%95%EC%82%AC%EB%8B%98%EC%9D%98-%EC%9D%B4%EC%95%BC%EA%B8%B0-%EC%8B%9C%EA%B0%84\" aria-label=\"강사님의 이야기 시간 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>강사님의 이야기 시간</h2>\n<p>강사님의 개발자 일대기 이야기를 해주셨다.<br>\n재직한 회사에서 다양한 경험을 쌓으셨고 매 순간 열심히 하신 것 같다.</p>\n<p>어떤이는 운도 중요하여, 열심히 해도 운이 안좋으면 취업, 이직이 어렵다 라고 이야기 하는 사람도 있다.<br>\n하지만 개인적으로 거꾸로 아닌가 싶다.</p>\n<p><strong>열심히 노력하고 준비를 하고 있어여 기회가 온 운을 잡을 수 있는게 아닌가?</strong> 라는게 나의 생각이다.</p>\n<p><font color=\"red\"> 불확실성은 곧 희망이다.</font></p>\n<p>강사님의 이 멘트가 개인적으로 많이 와닿았다.</p>\n<br>\n<h2 id=\"실무-함수형-프로그래밍-빌드업\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EB%AC%B4-%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EB%B9%8C%EB%93%9C%EC%97%85\" aria-label=\"실무 함수형 프로그래밍 빌드업 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실무 함수형 프로그래밍 빌드업</h2>\n<p>오늘의 강의 내용은 아래와 같았다.</p>\n<ol>\n<li>Nest.Js 주요 컨셉</li>\n<li>Ports and Adapters Architecture</li>\n<li>Live Coding1 : Nest.js 로 프로젝트 아키텍처 구성하기</li>\n<li>Live Coding2 : 사전과제 로직 함께 리팩토링 하기</li>\n</ol>\n<p>초반에 많은 질의가 있었다.<br>\n간단하게 정리하면…</p>\n<ul>\n<li>Express를 안쓰는 것은 아니다.</li>\n<li>Express를 좀 더 추상화 한 개념이 Nest.js</li>\n<li>Nest.Js는 Express 기반이고, Angular에서 많은 영감을 받아서 개발하였다.</li>\n<li><strong>Layerd Architecture</strong>는 기업에서 많이 채택하는 아키택쳐</li>\n<li>쉽게 프로젝트를 구성할 수 있는 아키텍쳐</li>\n<li>Ports and Adapters Architecture 는 여기서 한 단계 더 진화된 아키텍처</li>\n<li>훨씬 더 직관적인 비즈니스 로직을 작성할 수 있는 아키텍쳐</li>\n</ul>\n<br>\n<h3 id=\"nestjs-주요-컨셉\" style=\"position:relative;\"><a href=\"#nestjs-%EC%A3%BC%EC%9A%94-%EC%BB%A8%EC%85%89\" aria-label=\"nestjs 주요 컨셉 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nest.js 주요 컨셉</h3>\n<p>Nest.Js 개발자는 고양이를 좋아한다.(?)</p>\n<br>\n<h4 id=\"controllers\" style=\"position:relative;\"><a href=\"#controllers\" aria-label=\"controllers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Controllers</h4>\n<p>컨트롤러에 대한 정의</p>\n<ul>\n<li>컨트롤러는 어플리케이션을 향한 요청을 받는 첫 번째 스탭</li>\n<li>라우팅 역할</li>\n<li>외부세계로 부터 들어온 요청이 어느 곳으로 가야하는지 안내하는 역할</li>\n<li>클라이언트로부터 요청이 들어오는 부분</li>\n<li>컨트롤러는 NestAPI 뿐만이 아닌 GraphQL이나 이런 것도 컨트롤러할</li>\n<li>요청이 들어오는 것이 컨트롤러이며, 요청이 되는 주체를 의미한다.</li>\n<li>외부 세계로 부터 들어온 요청이 어느 곳으로 가는게 맞냐 라는 역할</li>\n<li>사용자의 요청을 수행할 수 있는 비즈니스 로직에 요청을 보내는 주체</li>\n<li>하지만 컨트롤러는 순수함수가 아님을 유의한다. (외부에서 오는 요청 때문에…)</li>\n</ul>\n<br>\n<p>Nest.Js의 컨트롤러 생김새는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Controller<span class=\"token punctuation\">,</span> Get<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@nestjs/common\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cats\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsController</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">async</span> <span class=\"token function\">findAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> \"This action returns all cats\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>Nest.Js 컨트롤러는 <strong>Typescrit</strong>의 데코레이터 문법을 사용해 추상화를 했다.</li>\n<li>Nest.Js의 데코레이터 형식은 자바의 스프링과 모습이 비슷하다.</li>\n</ul>\n<br>\n<h4 id=\"providers\" style=\"position:relative;\"><a href=\"#providers\" aria-label=\"providers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Providers</h4>\n<ul>\n<li>NestJs의 근본이며 중요한 컨셉</li>\n<li>Nest.Js의 대다수의 클래스들이 provider로 구성</li>\n<li>provider는 디펜던시로 주입될 수 있다.</li>\n<li>컨트롤러는 HTTP 요청을 핸들링하고 더 복잡한 일들(디비 처리, 요청에 대한 작업 등)을 provider에게 위임 해야한다.</li>\n<li>provider에게 중요한 비즈니스 로직을 가둔다.</li>\n<li>provider는 그저 javascript의 class일 뿐이다.</li>\n<li>프레임워크에 종속되지 않은 클래스이고, javascript에서 클래스는 결국 프로토타입 함수다.</li>\n<li>provider는 순수함수가 될 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> cats<span class=\"token operator\">:</span> Cat<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token function\">create</span><span class=\"token punctuation\">(</span>cat<span class=\"token operator\">:</span> Cat<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cats<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>cat<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'cats'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> catsService<span class=\"token operator\">:</span> CatsService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Post</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Body</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> createCatDto<span class=\"token operator\">:</span> CreateCatDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>catsService<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>createCatDto<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>위 코드에서 보면 컨트롤러는 서비스 객체에게 위임한다.</li>\n<li>위임을 표시하는 것이 컨트롤러의 생성자 주입(의존성 주입 형태 중 하나)이 그 표현이다.</li>\n<li>즉 데코레이터 모두 빼면 함수이고, 함수형 프로그래밍 페러다임으로 적용이 가능하다.</li>\n<li>참고 <a href=\"https://docs.nestjs.com/providers\">Provider 공식문서</a></li>\n</ul>\n<br>\n<h4 id=\"modules\" style=\"position:relative;\"><a href=\"#modules\" aria-label=\"modules permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Modules</h4>\n<ul>\n<li>일종의 패키지 역할을 하는 것</li>\n<li>같은 도메인에 속한 것들을 응집화 할 수 있도록 도와주는 역할</li>\n<li>앱의 사이즈가 커질수록, 경계를 설정해서 복잡도를 매니징할 수 있다.</li>\n<li>경계(도메인)를 설정해서 각 모듈 간의 의존도를 제어할 수 있게 해준다.</li>\n<li>MSA도 모듈화의 방법 중 하나</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>CatsController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>CatsService<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>위 코드에서 데코레이터를 선언하고 controllers 배열에 controller 역할을 하는 것을 전달하고, providers도 동일하다.</li>\n<li>provider에서 @Injectable() 데코레이터만 붙이기만 하면 안되고, 모듈의 provider 배열에 전달해야 nest.js에 위임한다.</li>\n</ul>\n<br>\n<h4 id=\"dependency-injection\" style=\"position:relative;\"><a href=\"#dependency-injection\" aria-label=\"dependency injection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency Injection</h4>\n<ul>\n<li>Inversion of control (IoC)</li>\n<li>Nest.js 런타임 시스템에 dependency 인스턴스화를 위임한다.</li>\n<li>실제 객체를 인스턴스화 시키는 작업을 프레임워크에 위임하는 것</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsService</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cats\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CatsController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> catsService<span class=\"token operator\">:</span> CatsService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>CatsController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>provide <span class=\"token operator\">:</span> CatsService<span class=\"token punctuation\">,</span> useClass <span class=\"token operator\">:</span> CatsService<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>위와같은 코드가 있을 때 Nest.js에서 처음에 부트스트랩을 할 때 인스턴스를 계산해서 필요한 클래스를 생성하고, 런타임 시점에 해당 컨트롤러나 프로바이더에 주입한다.</li>\n<li><strong>개발자가 의존성에 대해 직접 인스턴스 생성 및 관리를 할 필요가 없다.</strong></li>\n<li>위 코드를 기준으로 흐름을 보면 다음과 같다.</li>\n</ul>\n<br>\n<ol>\n<li>CatsController를 인스턴스화 할 때, dependency(의존성)를 확인한다.</li>\n<li>\n<p>CatsService 토큰은 CatsService 클래스를 리턴한다.</p>\n<ul>\n<li>여기서 나온 토큰의 의미는 식별자를 의미한다.</li>\n<li>하단의 @Module을 보면 providers 배열 안에 <strong>provide</strong>가 토큰(식별자 또는 구분자)를 가리킨다.</li>\n<li>저 토큰은 클래스도 되지만 일반 문자열(string)도 가능하다</li>\n<li><strong>useClass</strong>에는 직접 구현한 클래스를 넣는다.</li>\n<li>이 코드 어디서도 new 등으로 인스턴스 할당하는 로직을 볼 수 없다.</li>\n<li>providers에는 저렇게 토큰 명시를 해서 구현하기도 하고, 그냥 CatsService만 명시해서 쓰기도 한다.</li>\n</ul>\n</li>\n<li>\n<p>Singleton 스코프(default)로 CatsService를 인스턴스화 시킨다.</p>\n<ul>\n<li>그래서 Nest.js에서 부트스트랩 시 providers를 보고 식별자와 구현 클래스를 확인 후 CatsService 인스턴스를 싱글톤(기본값)으로 인스턴스화 한다.</li>\n</ul>\n</li>\n<li>\n<p>메모리 내에 캐시를 하고 재사용이 가능하게끔 만든다.</p>\n<ul>\n<li>Nest.js에는 컨테이너를 운영하는데 그 안에 CatsService 객체가 생성되어 있다.</li>\n<li>그래서 요청 시 미리 메모리에 올려 있는 것을 가져와서 쓴다.</li>\n</ul>\n</li>\n<li>이 모든 과정은 Bottom up으로 dependency가 정확한 순서로 관리된다.</li>\n</ol>\n<br>\n<p>이것이 <strong>Nest.js의 핵심 내용</strong>이다.</p>\n<p>스프링과 같다라고 하는 의견이 많았다.<br>\n나 또한 같은 것을 느꼈고, 어떤 이는 라이트 스프링이라고 이야기 했는데 정말 그런것 같다.</p>\n<p>과거 스프링을 4년 정도 개발했던 나로써 Nest.js 및 Typescript 언어에 대한 거부감이 없었고, 학습도 쉬웠다.<br>\n오히려 난 Javascript가 좀 난해했다. (타입이 없었고 너무 자유분방한 것 같아서 그랬었던 것 같다.)</p>\n<br>\n<h3 id=\"architectures\" style=\"position:relative;\"><a href=\"#architectures\" aria-label=\"architectures permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Architectures</h3>\n<p>먼저 Layered Architecture에 대해 설명 및 한계에 대한 설명을 했다.</p>\n<h4 id=\"layered-architecture의-한계\" style=\"position:relative;\"><a href=\"#layered-architecture%EC%9D%98-%ED%95%9C%EA%B3%84\" aria-label=\"layered architecture의 한계 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Layered Architecture의 한계</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 922px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeklEQVQoz32R+WsTQRTH81+rWFFBQSgoVKGo6A9KsYKgll7Sw9TaNNE0h0m22c1mNzt7JZvsbjJ7TXYuN5WaeH75zGN48H3zvkyOc07pDM4ZS4cM9ekCDA3YdAb9pT+gicVIkBuNekKrIgiyKudBs2C1e7bY7UtKhi0phtCFRp0HRRaWeXRJeMaDU5bouaELxE5d1XqadqI2a73mqFWSG8VOoyi1zxS1MRzrbQ5LRnsXnG9rwpYh7jjqgSVt0ljPvX25urb68P3a65311fLBviFOlOagUwVSBSjf+t264wOBh6XAOp6Y+YmRh+ZRdofG/uzl0cAajyzoO64t+qCuVovNjxsuULxet13ZsqRaYAkcVnhQ42F9DiyzxMrxSzFGOEdibfto/bY7DmHgV6u3TPPUtsNp6hLq0Rl+VskMl9Loh5llB1Mrik9dV9O71ZEjDqxz265BaCC0x/nTFD+P4idR9DirCD2Lk0cpKczNhGoQfnH9WJlqLSi0AsHOovQncfKB82UIl2V5SVFuaNpN274LtKso3V80eykRtW6h8vWVP1H8QC3XXpigjIMGoYeUfeI84ziDzTgktDPPTGjC+VBq7p5sPOB9hzmD4+K1vvqZAydFIKU6JvoUaykGhOiYaph6i5nBBOY9r2+YEnBahtM2jY4f2GG6wfgyoSucr3jevbZ43TDvqOqVZLqwNmVRinshlEub96Oe1jnbe/NuCeoAWzJhAqHnGSkWEtRE01aM6oTa87Uvfms2Ra4VkJ1YXSDJZZ5FmTD+Dy2a2YWdhlGCMMIEY0x/9v9K7rdhmXvs+4ZhmKYZxzH/r3J/thBCYRgGQZCm6f/N3wEvwW6Jv3kvMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/04767991753789e9650f890b7fd22b4a/77434/img02.webp 300w,\n/static/04767991753789e9650f890b7fd22b4a/411c4/img02.webp 600w,\n/static/04767991753789e9650f890b7fd22b4a/426c3/img02.webp 922w\"\n              sizes=\"(max-width: 922px) 100vw, 922px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/04767991753789e9650f890b7fd22b4a/a8a0d/img02.png 300w,\n/static/04767991753789e9650f890b7fd22b4a/dface/img02.png 600w,\n/static/04767991753789e9650f890b7fd22b4a/b59ab/img02.png 922w\"\n            sizes=\"(max-width: 922px) 100vw, 922px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/04767991753789e9650f890b7fd22b4a/b59ab/img02.png\"\n            alt=\"img02\"\n            title=\"img02\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<a href=\"https://medium.com/java-vault/layered-architecture-b2f4ebe8d587\">이미지 출처 - java-vault</a></p>\n<p>레이어드 아키텍쳐를 사용하다 보면 배치에 대해 고민이 생기게 된다.</p>\n<p>예를 들어 고객이 생성되었을 때, 메일을 보내는 기능을 추가해주고 싶은데 이 경우 메일 서비스를 만들어주면 되긴 한다.<br>\n근데 메일 서비스를 만들 때, 메일 송신을 담당하는 인프라 코드(구글, 네이버 등 메일을 보내게 해주는 인프라)는 어느 곳에 둘 것인지에 대해 고민이 있었다.</p>\n<p>즉 메일 전신을 만들어주는 기능이 있고, 해당 메일을 보내는 기능도 있으며, 메일 보냈을 때 기록을 남기는 기능도 있을 것이다.<br>\n이렇게 일일히 구분해서 하다보면 혼란이 온다.</p>\n<p>답이 명쾌하지 않기 때문에 혼란이 가중화 된다.<br>\n그래서 레이어드 아키텍쳐는 다양한 비즈니스 로직을 충족시키기에는 한계가 있는 구조다.</p>\n<br>\n<h4 id=\"layered-architecture의-진화-port-and-adapter-architecture\" style=\"position:relative;\"><a href=\"#layered-architecture%EC%9D%98-%EC%A7%84%ED%99%94-port-and-adapter-architecture\" aria-label=\"layered architecture의 진화 port and adapter architecture permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Layered Architecture의 진화 (Port and Adapter Architecture)</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 708px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADh0lEQVQ4yz2T2XNadRzF+Vd80DHa8a1vvvim4//gjK2xHceto02bWLskrVMqYRLDFpYCYQ9kIayBlB0uXC4QICFAa0vTdNqMU5XRkLXf4+9C7MN3zp27fO6593uOxJ6ZhenBDMwxZV9nA5NQe+/RUs2K7KadDngdHfI69LWox35Bi05QhocrUrTZdEIyPPLfQ8F6HU8Cv0IS3HIi0HAgsOUYKJtgw0E+dj6zYaODon4AZHowAOOIgUU9LhnwKqnAYwYSj8VzEhEQaroQ2nLhfzhT8jHN1C20z2v7oP1Th0eCHnucho0aVDHi2aocFdc4XldM4j2QiCBPxQBt+i68dQuDzzOHdvK33UhvLdJRaY5ER68rRuoxyG5aj3i+gnBawHbiPp6vytBNK0BFNXOuhSTMAIb0JK7avsBU5Gf4NiwIND3kzmuQTV6m3dgY7XF6tLxSMo+fRyeiwHoxgzKfwV95E6ikxQvOhiYfxS7T/j9cbbmhWZNiYvkbWIuzCApKFF1nqRsbwl7uA/DWT2lRfgkx/RX0ckq84kxIpFLgUlHsMIflqBORfAPt7BIk2uRdzETHYcjI4BRUGPltBD7LJ9Rwvo2s6QzxlvcpPvsWwqoLFFKOYFF2EY8TZsQLNeS5LLo5bX9JvcJgYRJZcBSjli9x3fUVjOzTz18dxpziI3oefA+BmSESrGdo0zMEj+wzqrhuYycix79sKUeCob+gkxKLEj8A7rORrNSt8NYsMCTlsPNKDF87h4tff8wePEu95Lvo+N+Bf/pDKjnGobtxDk3PTTQKUcSEFh5xy3iaMGAtwyNRaqKcj7Mts8gYU1O45f4O8ugY7JwKty3XyFuYxnr2W1qfv0DeqUsQHDep7JrAdlCKViGMJF9FO+VCKWSG3ptBMFtDq/gAEtXaHfxo/BxX7g/DlldCtfYLpL4faL5qRabppZcxNaWNozBPDNNhQYMTXo2TogbHLCJgUTks6vAH70KX00G8LrHyM5iO3IC7aEC0vYBbzu9FOHlYULmGjYVZR5sLd1itpNTJzaNdivUBB3k1titR/N4o4++Cmb1EK7ZpEJt+dFiQfRs2TAZ+YjNG3k37m+qJP7yXU1C1xGGh8AxCfBkvwlJEUjzcuSfYFvw4Zs77QP+GA/66A76a/VRtWGGVe9Pl08qJTrv8HP4UXPiHZzVjwa9WK4jXd/BSWGJATR/4H0tKaYUE+6oxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8fdf0f051ea9c4a19ee730080506d4cc/77434/img03.webp 300w,\n/static/8fdf0f051ea9c4a19ee730080506d4cc/411c4/img03.webp 600w,\n/static/8fdf0f051ea9c4a19ee730080506d4cc/cc093/img03.webp 708w\"\n              sizes=\"(max-width: 708px) 100vw, 708px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8fdf0f051ea9c4a19ee730080506d4cc/a8a0d/img03.png 300w,\n/static/8fdf0f051ea9c4a19ee730080506d4cc/dface/img03.png 600w,\n/static/8fdf0f051ea9c4a19ee730080506d4cc/d65de/img03.png 708w\"\n            sizes=\"(max-width: 708px) 100vw, 708px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8fdf0f051ea9c4a19ee730080506d4cc/d65de/img03.png\"\n            alt=\"img03\"\n            title=\"img03\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<a href=\"https://www.getoutsidedoor.com/2018/09/03/ports-adapters-architecture/\">이미지 출처 - getoutsidedoor</a></p>\n<p>외부에서 접근은 Rest Api가 될 수 있고, 개발자들끼리 CLI로도 올 수 있고 다양한 접근이 가능하다.\n그리고 내부에서 처리는 각 요구사항에 맞는 부분들의 도착지가 있다.</p>\n<p>이렇게 될 경우 모든 로직은 <strong>Business Logic</strong>이라는 부분으로 외부 내부의 시선이 모이게 된다.<br>\n위 그림에서처럼 왼쪽은 요청이 들어오는 영역이고, 오른쪽은 인프라에 영향을 끼치는 영역이다.</p>\n<p>오른쪽은 개발자가 크게 신경을 쓸 부분은 아니다.<br>\n어찌보면 각 인프라나 디비의 경우 구현체가 있고 거기까지 흐름을 가져다 주는게 개발자의 역할일 뿐이다.(강사님은 농담 뉘앙스로 내 알바 아님이라 표현하심 ㅋ)</p>\n<p>포인트는 <strong>우리가 작성하는 비즈니스 로직은 내부에 가두고, 들어오는 요청을 받는 부분의 문을 열어준다.(포트를 열어준다.)</strong></p>\n<p>위 그림에서 왼쪽 영역의 경우…<br>\n외부에서 요청한 것은 포트로 받고, 내가 작성한 비즈니스 로직을 사용하려면 포트로만 접근하여 사용할 수 있게끔 해주는 것.</p>\n<p>오른쪽 영역의 경우…<br>\n약속된 포트를 통해서만 구현체에게 명령을 준다라는 것.</p>\n<p><strong>이것이 포트 앤 어뎁터 아키텍쳐(Port and Adapter Architecture)이다.</strong></p>\n<p>이것을 다시 정리하면…</p>\n<ul>\n<li>인터페이스를 통해서 해당 포트로 접근이 가능하게끔 한다는 것이 포인트.</li>\n<li>내가 미리 약속한 인터페이스를 통해서만 포트에 접근이 가능하고, 포트를 통해서만 비즈니스 로직에 접근이 가능하다.</li>\n<li>그리고 비즈니스 로직에서 처리한 결과가 포트를 통해 외부세계(인프라나 디비 영역)에 영향을 준다.</li>\n<li>레이어드 아키텍쳐에서 특정 로직을 담당하는 코드를 어디에 위치해야 할 지를 고민하던 것들을 해결하기 위해 나왔다.</li>\n<li>무조건 포트를 통해서만 서로 통신을 한다.</li>\n</ul>\n<p>개념적인 이야기는 이게 끝이다.</p>\n<p>내부 세계(우리가 작성하는, 또는 작성해야 할 영역)는 각종 버그와 위험(잘못짠 코드..)이 도사리고 있다.<br>\n이런 위기를 구원해주는 패러다임이 있다.<br>\n패러다임은 프로그래밍 룰이 필요하고, 마인드셋(어떠한 사고로 프로그래밍을 할 것)이 필요하며, 우리가 작성한 어플리케이션 코드를 바라보는 철학이 필요하다.</p>\n<p>저번 시간에는 함수형 프로그래밍 룰을 통해 사이드 이팩트를 줄이고, 고차함수를 통해 함수를 합성하는 것을 배웠다.<br>\n이번에는 인터페이스라는 룰을 배울 것이다.</p>\n<br>\n<h4 id=\"interface\" style=\"position:relative;\"><a href=\"#interface\" aria-label=\"interface permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Interface</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACKklEQVQ4y4VTiWoiQRSc//8Eo3isRAVJJPFcVIyIiBvBqAQCKqt4rDre91n7qmHc8QjbMPOgp6devapq7XA44N5zPB7R6/VQLBZRKBRQrVax3+/VvvGdlXvmfzTcWafTSVUeWC6XmEwm0HUd2+32/M2o10szgxgP13qzwXK1wma9xlpAF4sF5vP5BVi73Ua5XFbsjH2NLzIxL/4cfH6Gz+1G4OkJPyMRPHo88Pl8aDab53PpdBoOhwOz2ewfILtOp1OshM1wOFQfcrkcfjw84NXvR1TACBgOh2G32xGLxZRulGI8His5zBNqZiN2cnAiWkVCITx6vfgtbBbSvddqYSmsf72/IxAIoF6vKz03Isu1njemcAy3jJp9e4M+GGA6GmEkgGNhr8tDQI5ugJnlutGwVqupsbzCjoJTmz8SnW63C73fV2NmMhlYrVYlyz0zLwA7nQ5cLhc8YkD16wsjYTckQ5GBbKl3NpuFxWJBqVS6AVQMDbpricdut0M+n4fT6UQ8GlWAdJyV7LrdjjInkUios9f6KUC6y878gXUsTF5fXuAUppVKRQWagLw1wWBQmjmUBDzLPTp+EWy6RXbmTsWPD9hsNjW+X6KTSqWUDNQuHo+fzzFmn5+fqjGdJ7h278pxnGQyiZDEh7mjDKwRySMZm2UayER9MYyZVHf52iUzU8MsykHHzbn77102g5kPk1FLckjNGP7r5t+6fC9TrMxjo9G4uRXfMfwLR4mxQzcSsqsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3138e92f529c553b096e92ce9ed78800/77434/img04.webp 300w,\n/static/3138e92f529c553b096e92ce9ed78800/411c4/img04.webp 600w,\n/static/3138e92f529c553b096e92ce9ed78800/cbd37/img04.webp 1200w,\n/static/3138e92f529c553b096e92ce9ed78800/8a635/img04.webp 1428w\"\n              sizes=\"(max-width: 1200px) 100vw, 1200px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3138e92f529c553b096e92ce9ed78800/a8a0d/img04.png 300w,\n/static/3138e92f529c553b096e92ce9ed78800/dface/img04.png 600w,\n/static/3138e92f529c553b096e92ce9ed78800/64756/img04.png 1200w,\n/static/3138e92f529c553b096e92ce9ed78800/a20ca/img04.png 1428w\"\n            sizes=\"(max-width: 1200px) 100vw, 1200px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3138e92f529c553b096e92ce9ed78800/64756/img04.png\"\n            alt=\"img04\"\n            title=\"img04\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<a href=\"https://engineering-skcc.github.io/microservice%20inner%20achitecture/inner-architecture-2/\">이미지 출처 - SK(주) C&#x26;C’s TECH BLOG</a></p>\n<p>컨트롤러에서 들어오는 영역을 인바운드 어뎁터라 하고, 컨트롤러가 내부 비즈니스 로직을 처리하기 위한 문(포트)를 인바운드 포트라 한다.<br>\n내가 작성한 서비스 로직에서 처리 결과나 외부 세계로 작업 결과물을 내보내는 문(포트)를 아웃바운드 포트라 하고, 그 문과 연결되어 처리되는 부분을 아웃바운드 어뎁터라 한다.</p>\n<br>\n<h4 id=\"ports-and-adapters-architecture\" style=\"position:relative;\"><a href=\"#ports-and-adapters-architecture\" aria-label=\"ports and adapters architecture permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ports and Adapters Architecture</h4>\n<p>내용을 정리하면 아래와 같다.</p>\n<ul>\n<li>inbound-adapter : controller, GraphQL, REST, gRPC, CLI 등</li>\n<li>inbound-port : 서비스 로직으로 향하는 interface</li>\n<li>service : inbound-port 구현체</li>\n<li>outbound-port : 외부 세계로 향하는 interface</li>\n<li>outboud-adapter : outbound-port 구현체 (DB, Search Engine, Notification, Mail 등)</li>\n</ul>\n<br>\n<h3 id=\"수업-중간-질문\" style=\"position:relative;\"><a href=\"#%EC%88%98%EC%97%85-%EC%A4%91%EA%B0%84-%EC%A7%88%EB%AC%B8\" aria-label=\"수업 중간 질문 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>수업 중간 질문</h3>\n<p>실제 라이브 코딩 전 잠깐 질의 응답 시간이 있었는데 이를 간략하게 정리했다.<br>\nQ 는 수강생이 질문한 것이고, A는 강사님이 답변하신 부분이다.</p>\n<p>Q : 기존 레이어드 아키텍쳐에 비해 좋은 게 뭐가 있는가?<br>\nA : 지금 당장은 생각이 나지 않는다.</p>\n<p>Q : In-Out port 사이에 있는 service가 거대해 지는 문제점이 있지 않나?<br>\nA : 그렇게 하지 않기 위해 개발자가 노력해야 한다.<br>\n그래서 서비스를 최대한 최소 단위로 나누고, 그 안을 함수형 프로그래밍 페러다임을 적용하면 좋다(라고 개인적인 의견이라 말씀하심)</p>\n<p>Q :Service 부분을 MSA로 구성하고 port 부분만 gateway로 구상할 수 있는가?<br>\nA : 맞다. 포트 부분만 열어놨기 때문에 그 부분만 때서 처리하기 용이하다.<br>\n게이트웨이는 MSA 포워딩 해주는 서비스라는 것이라고 질문자가 응답함</p>\n<p>Q : 초기 어플리케이션 개발에 핵사고날(포트 앤 어뎁터) 아키텍쳐를 적용하는 경우가 있는가?<br>\nA : 있다.</p>\n<p>Q : Nest.js + fsts를 사용한 참조하기 괜찮은 레포지토리가 있는가?<br>\nA : 내가 만들지 않아서 없다.</p>\n<p>Q : 여러 DB를 분산한 경우 데이터를 모을 때 어떤 방법을 사용하였는가?<br>\nA : 다양한 방식으로 해결할 수 있다.<br>\n중앙 코어(데이터팀)에서 각 디비를 찔러서(호출) 한번에 모든 데이터를 수집해서 빅데이터 등으로 모은 뒤 필요한 데이터를 가공하여 api로 제공함<br>\n다양한 방법을 사용하기도 한다.<br>\n정답은 없고 각자 방법이 다 다르다.</p>\n<br>\n<p>번외로 강사님이 재직했던 곳에서는 MSA 구성이 각 서버가 각자의 디비를 가지고 있는 형태였고,<br>\n데이터가 분산되어 있기에, 서로 소통하며 데이터를 주고받을 수 있는 이벤트 드리븐(도메인 드리븐) 아키텍처가 적용되어 있었다고 하심.<br>\n하지만 설계에 정답은 없다.</p>\n<p>긴 설명 이후 잠시 휴식 후 이제는 라이브 코딩으로…</p>\n<br>\n<h3 id=\"live-coding1--nestjs-로-프로젝트-아키텍처-구성하기\" style=\"position:relative;\"><a href=\"#live-coding1--nestjs-%EB%A1%9C-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"live coding1  nestjs 로 프로젝트 아키텍처 구성하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Live Coding1 : Nest.js 로 프로젝트 아키텍처 구성하기</h3>\n<p><a href=\"https://docs.nestjs.com\">Nest.Js 공식문서</a>를 참고하며 진행하였다.<br>\n먼저 <a href=\"https://docs.nestjs.com/#alternatives\">공식 레포</a>를 참고해서 프로젝트 셋업을 진행하였다.</p>\n<p>npm install 하여 설치하며 기다리는 중 깜짝질문이 나왔다.</p>\n<blockquote>\n<p><strong>package.json.lock</strong>은 왜 있는 것인가?</p>\n</blockquote>\n<p>나도 이 부분을 몰랐다 -0-;;<br>\n대충 찾아보니 조금 더 명확한 버전을 제공하기 위해서다.<br>\n쉽게 고정된 버전을 동일하게 쓰기 위함이다.</p>\n<p>Nest.js에 대해 깊게 파지는 않고, 아키텍쳐에 대해서 알아볼 예정이다.<br>\n이번 라이브코딩 코드는 <a href=\"https://github.com/Jun4928/wanted-pre-onboarding-challenge-BE-task-JAN.2023/tree/main/lecture-2\">lecture-2</a>를 참고하면 된다.</p>\n<p>오늘의 목표는 Member의 리스트를 조회하는 API 작성이다.<br>\n이번 라이브 코딩에서 디비를 직접 다루진 않고 메모리 샘플 데이터로 진행한다.</p>\n<br>\n<h4 id=\"메모리-디비\" style=\"position:relative;\"><a href=\"#%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%94%94%EB%B9%84\" aria-label=\"메모리 디비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>메모리 디비</h4>\n<p>아래 코드가 메모리 디비로 쓸 샘플코드다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">Member</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> bigint\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> MemoryDatabase <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> members <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      id<span class=\"token operator\">:</span> <span class=\"token number\">1n</span><span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token string\">'J'</span><span class=\"token punctuation\">,</span>\n      email<span class=\"token operator\">:</span> <span class=\"token string\">'j@gmail.com'</span><span class=\"token punctuation\">,</span>\n      phone<span class=\"token operator\">:</span> <span class=\"token string\">'010-3333-4444'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> Member<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">findMembers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">Promise</span><span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>members<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>여기서 <strong>bigint</strong>가 등장하는데 javascript에서는 큰 수를 다룰 때 쓰는 것이라고 한다.(나도 처음봤다.)<br>\n근데 개념은 이해하는게 Java에서도 유저 값 고유 id는 uuid나 정수형 쓸 때 Long을 쓰긴 해서 javascript에는 number만 쓰는줄 알았었다.</p>\n<p>근데 이거를 실제로 쓰려면 미들웨어를 붙여서 컨버팅하고 해야 해서 이번 실습에서는 number 타입을 쓰는 것으로 했다.</p>\n<p><strong>findMembers</strong> 클로저 함수는 Promise를 반환하는데 <strong>member</strong>배열을 반환한다.</p>\n<br>\n<h4 id=\"controller\" style=\"position:relative;\"><a href=\"#controller\" aria-label=\"controller permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Controller</h4>\n<p>다음은 컨트롤러 영역이다.<br>\n강사님 회사의 코드 전략 중 하나는 파일에 하나의 클래스에 하나의 함수만 가지는게 원칙이 있는데 이를 적용했다.</p>\n<p>그래서 이번에 처럼 조회하는 함수를 만들면 다음과 같은 코드가 만들어진다.<br>\n파일명은 <strong>get-members.controller.ts</strong>를 사용하였다.</p>\n<p>나는 그냥 <strong>get.members.controller.ts</strong> 이런 유형인데 하이픈도 같이 쓰기도 하나보다…</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Controller<span class=\"token punctuation\">,</span> Get<span class=\"token punctuation\">,</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">,</span>\n  FindMembersInboundPort<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../inbound-port/find-members.inbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> MemoryDatabase <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'src/lib/memory-database'</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetMembersController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersInboundPort<span class=\"token operator\">:</span> FindMembersInboundPort\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/members'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 하고 서버를 실행시키고 접근해본다.</p>\n<blockquote>\n<p><a href=\"http://localhost:3000/members\">http://localhost:3000/members</a></p>\n</blockquote>\n<p>근데 404가 뜬다.</p>\n<p>이유는 간단하다.<br>\n위에서도 언급했다시피 어노테이션(데코레이터)만 붙인다고 되는게 아니다.</p>\n<p>Module에도 등록을 해줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//member.module.ts</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>GetMembersController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>근데 이렇게 등록을 해도 여전히 404가 뜬다.<br>\n이것도 위에서 본바와 같이 <strong>app.module.ts</strong>에서 등록을 해줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//app.module.ts</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  imports<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>MemberModule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>AppController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>AppService<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AppModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 의존관계를 추적해보면 <strong>main.ts</strong>부터 시작해본다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> NestFactory<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>AppModule<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">await</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>저기서 AppMododule로 가져와서 App을 생성하는데,<br>\n저 AppModule을 타면 <strong>imports</strong>에 <strong>MemberModule</strong>을 가져오고,<br>\n거기서 controllers를 보니 <strong>GetMembersController</strong> 컨트롤러를 선언한 것을 확인할 수 있다.</p>\n<p>이제는 위의 코드를 Port And Adapter Architecture로 바꿔보겠다.</p>\n<br>\n<h4 id=\"아키텍쳐-적용해보기-inbound-port-interface\" style=\"position:relative;\"><a href=\"#%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0-inbound-port-interface\" aria-label=\"아키텍쳐 적용해보기 inbound port interface permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아키텍쳐 적용해보기 (Inbound-Port interface)</h4>\n<p>이제는 메모리 디비의 값을 가져오는 것을 해보려 한다.<br>\n위 이론에서 언급한 <a href=\"https://elfinlas.github.io/til/230114_wanted_preon_back02/#ports-and-adapters-architecture\">내용</a>처럼 inbound-port를 만들기 위해 인터페이스를 하나 만든다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 인터페이스는 하나의 역할만 하는 것을 목표로 하는게 이 아키텍쳐의 목표다.<br>\n위 인터페이스의 이름처럼 멤버를 찾는 역할을 하는 목표만 가진다.</p>\n<p>이제 이 인터페이스를 채워보겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.inbound-port.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Member <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/memory-database'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortInputDto</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>Member<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'FIND_MEMBERS_INBOUND_PORT'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span> <span class=\"token comment\">//이 부분은 아래 서비스쪽에서 다룹니다.</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>코드를 설명 전 이 코드에 함정이 있다.<br>\n다른 분들도 못맞췄고, 나도 못맞췄다.</p>\n<p>정답은 아래 코드다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>Member<span class=\"token operator\">></span></code></pre></div>\n<p>여기서 Member는 inbound쪽 영역이 아닌 디비 영역에…즉 인프라 코드에 있는 것이다.<br>\n이렇게 되면 의존성이 깨져버린다.</p>\n<p>그래서 서비스 로직을 작성할 때 요점은 <strong>처음부터 디비나 각종 의존성을 제거하고 작성하는 것</strong>이다.</p>\n<p>그럼 이 로직을 어떻게 바꾸냐 하면…</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.inbound-port.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortInputDto</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'FIND_MEMBERS_INBOUND_PORT'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 타이핑으로 직접 처리를 하면 된다.<br>\n이게 단점이 될 수 있다.</p>\n<p>물론 중복된 코드가 많아질 수 있지만 이것을 감수해야 하는 게 이 아키텍쳐다.<br>\n이렇게 되면 엔티티와 별개로 DTO가 필요해진다.</p>\n<p>이 룰은 강한 룰이지만, 이렇게 하는 것이 필수는 아니며 교육 차원 및 이런 습관을 들이는 것이 중요하다.<br>\n나도 이 부분은 공감했고, 내 프로젝트에 이 룰을 적용하여 리팩토링을 진행해 봐야겠다고 생각이 들었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//DB Entity</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">Member</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> bigint\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//inbound port dto</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersInboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></code></pre></div>\n<p>이와 같이 코드가 분리될 경우 의존성은 없어지고, 완전한 분리가 되어 서로의 간섭이 없어지며 유지보수가 용이해진다.<br>\n이 부분은 트레이드 오프가 있는데 얻을 수 있는 것은 의존성 제거다.</p>\n<p>이렇게 함으로써 저 inboud-port 인터페이스는 의존성이 없게 되었다.</p>\n<p>다른 분이 좋은 의견을 주셨는데 이런 타입들을 외부에서 별도 모듈을 통해서 관리하고,<br>\n이 모듈을 임포트해서 저 port에서 가져와서 쓰는 것도 된다고 하셨다.</p>\n<p>근데 이렇게 될 경우 해당 모듈에 대한 의존성이 생기는 것이므로,<br>\n해당 모듈도 관리 포인트가 되고 의존성을 신경써 줘야 한다.(결국 또 등가교환이 이뤄진다.)</p>\n<p>개인적으론 그냥 강사님이 보여주신 의존성 제로 방식이 더 좋은 것 같다.<br>\n이제는 서비스 로직으로 들어간다.</p>\n<br>\n<h4 id=\"아키텍쳐-적용해보기-service\" style=\"position:relative;\"><a href=\"#%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0-service\" aria-label=\"아키텍쳐 적용해보기 service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아키텍쳐 적용해보기 (Service)</h4>\n<p>서비스는 아까 작성한 inbound-port를 구현해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.service.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FindMembersService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>아직 완성되지는 않았지만 대략 이런 형태로 구현이 될 것이다.<br>\n근데 이 코드에서도 함정이 있는데 바로 타입스크립트의 함정이다.</p>\n<p>(물론 이 코드는 완성된 결과물이 아니지만…)<br>\n이 코드에서 MemoryDatabase.findMembers() 함수가 리턴하는 값은 디비의 <strong>Member</strong>타입이고, 여기엔 id가 있다.<br>\n하지만 지금 반환을 보면 OutputDto고 여기엔 <strong>id</strong>값이 없다.</p>\n<p>이 부분은 <strong>Typescript</strong>의 <strong>덕 타이핑(Duck Typing)</strong>덕분에 에러가 안나고 넘어간다.<br>\n덕 타이핑은 간단하게 설명하면 일종의 동적 타이핑 종류이고, 구조적으로 타입이 맞기만 하면 에러 없이 허용을 한다.<br>\n이거는 나중에 따로 포스팅을 하면서 공부해봐야겠다.</p>\n<br>\n<p>이제 프로젝트를 구동하기 위해 위 서비스를 주입해야 하는데<br>\n서비스 자체를 주입하는건가? 포트를 주입하는 건가를 햇갈릴 수 있다.</p>\n<p>물론 정답은 포트다.<br>\n포트를 통해서만 호출하기 때문이다.</p>\n<p>의존성 주입을 해야 하는데 Nest.js에서는 생성자 주입을 많이 사용한다.<br>\n컨트롤러에 서비스 로직을 주입할 때는 아래 코드와 같이 작성된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetMembersController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersInboundPort<span class=\"token operator\">:</span> FindMembersInboundPort\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/members'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 생성자를 보면 <strong>@Inject()</strong>라는 데코레이터가 사용되었는데 이게 의존성 주입 역할을 해준다.<br>\n저 데코레이터에 전달된 값이 아까 이론에서 <a href=\"https://elfinlas.github.io/til/230114_wanted_preon_back02/#dependency-injection\">언급</a>했던 토큰이다.</p>\n<p>이제 위의 <a href=\"https://elfinlas.github.io/til/230114_wanted_preon_back02/#%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EC%A0%81%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0-service\">서비스</a> 설명 중 포트 인터페이스 코드가 어디에 어떤 역할인이 알 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'FIND_MEMBERS_INBOUND_PORT'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span></code></pre></div>\n<p>그럼 여기서 의문이 들 것이다.<br>\n아까 <strong>Module</strong>설명을 할 때 Provider에서 토큰과 클래스가 있었는데 어떻게 적용해야 하는가?</p>\n<p>아래 코드를 보면서 설명한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//Member Module</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./inbound-port/find-members.inbound-port'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FindMembersService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./service/find-members.service'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n      provide<span class=\"token operator\">:</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">,</span>\n      useClass<span class=\"token operator\">:</span> FindMembersService<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>여기서 중요한 것은 useClass에는 Port interface가 아닌 해당 Port를 구현한 구현체가 작성된 점이다.<br>\nNest.js에게 이런 토큰 <strong>(FIND<em>MEMBERS</em>INBOUND_PORT)</strong>을 찾으면 해당 구현체는 FindMembersService 라고 말해주는 것이다.</p>\n<p>그리고 의존성 주입을 할 때는 아래와 같이 토큰만 주입을 받는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersInboundPort<span class=\"token operator\">:</span> FindMembersInboundPort<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 되면 Nest.js는 토큰을 본 다음에 실제 구현체인 FindMembersService를 가져와서 주입해준다.<br>\n토큰을 쓰게 되면 <strong>추상화 된 개체들(인터페이스 구현체 및 기타 구현체)을 쓸 때 식별자로 사용</strong>이 가능해진다.</p>\n<p>근데…스프링은 이걸 아주 옛날에 이런 개념을 적용했는데…<br>\n역시 <strong>Spring</strong>은 정말 잘 만들어진 프레임워크인것 같다는 생각이 다시금 들었다.<br>\n특히 위 방식도 <strong>@Qualifier()</strong>에서 이미 사용한 방식이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">//Java sample</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyData</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"userData\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">UserData</span> userData<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Java spring에서는 이런식으로 가끔 사용했었다.</p>\n<p>다시 원점으로 돌아와서…<br>\nNest.js에게 이 토큰으로 식별하여 찾을 경우 useClass가 가리키는 객체를 인스턴스화 해서 사용해 달라는 것이다.</p>\n<br>\n<p>다시 돌아와서…<br>\n실제 컨트롤러의 호출단은 다음과 같이 바꿀 수 있게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// import { MemoryDatabase } from 'src/lib/memory-database'</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/members'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>findMembersInboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//return MemoryDatabase.findMembers()</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 되면 컨트롤러에서 메모리 디비에 대한 의존성도 사라진다.<br>\n여기까지 코드와 내용을 보면 각 영역마다의 의존도가 없다는 것을 알 수 있다.</p>\n<p>컨트롤러 코드를 다시 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//get-members.controller.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Controller<span class=\"token punctuation\">,</span> Get<span class=\"token punctuation\">,</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">,</span>\n  FindMembersInboundPort<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../inbound-port/find-members.inbound-port'</span>\n\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Controller</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GetMembersController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersInboundPort<span class=\"token operator\">:</span> FindMembersInboundPort\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Get</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'/members'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>findMembersInboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 서비스 로직은 찾아볼 수 없다.<br>\n다 각자 분리가 되어 있음을 알 수 있다.</p>\n<p>그런데 어떤 분이 의견을 주셨는데 이 구조를 사용하면 파일 갯수가 엄청 늘어나지 않는가? 였다.<br>\n강사님이 좋은 말씀을 주셨다.</p>\n<blockquote>\n<p>맞는 말이다.<br>\n그런데 코드 하나에 엄청난 라인을 자랑하는 방식을 사용할 것인지…아니면 짧은 라인의 코드를 가진 복수의 파일 방식을 사용할 것인지?</p>\n</blockquote>\n<p>난 당연 후자였다.<br>\n무튼 실행을 하면 데이터가 잘 나오는데 덕타이핑 덕분에 id도 그대로 노출이 된다.</p>\n<p>이제는 서비스 로직을 보고 개선해나갈 차례다.<br>\n아래가 서비스 로직이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.service.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FindMembersService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기도 보면 MemoryDatabase.findMembers()로 직접 호출을 하는데 이 의존도를 끊어보겠다.<br>\n이제는 outboud-port와 adapter를 만들어준다.</p>\n<p>outbound-port도 동일하게 작성을 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.outbound.port.ts</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersOutboundPortInputDto</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">FindMembersOutboundPortOutputDto</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  phone<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'FIND_MEMBERS_OUTBOUND_PORT'</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">FindMembersOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersOutboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersOutboundPortOutputDto<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그리고 아까 컨트롤러에 주입했던 것처럼 서비스에도 outbound-port를 주입해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.service.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  FindMembersInboundPort<span class=\"token punctuation\">,</span>\n  FindMembersInboundPortInputDto<span class=\"token punctuation\">,</span>\n  FindMembersInboundPortOutputDto<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../inbound-port/find-members.inbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Inject <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span><span class=\"token punctuation\">,</span>\n  FindMembersOutboundPort<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../outbound-port/find-members.outbound-port'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FindMembersService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersInboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Inject</span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> findMembersOutboundPort<span class=\"token operator\">:</span> FindMembersOutboundPort\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersInboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersInboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>findMembersOutboundPort<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>이렇게 되면 메모리 쪽의 의존도를 끊을 수 있게 되었다.<br>\n하지만 아직 <strong>FindMembersOutboundPort</strong>의 구현체가 없기 때문에 이를 만들어준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//find-members.repository.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  FindMembersOutboundPort<span class=\"token punctuation\">,</span>\n  FindMembersOutboundPortInputDto<span class=\"token punctuation\">,</span>\n  FindMembersOutboundPortOutputDto<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../outbound-port/find-members.outbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> MemoryDatabase <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/memory-database'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FindMembersRepository</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersOutboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersOutboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>당연한 이야기겠지만 해당 구현체에서는 메모리 의존을 해도 된다.<br>\n근데 outbound-port에서 dto에는 id가 없기에 타입에 맞춰서 반환 값을 바꿔준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersOutboundPortInputDto<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersOutboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">const</span> members <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> MemoryDatabase<span class=\"token punctuation\">.</span><span class=\"token function\">findMembers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> members<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> member<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n        email<span class=\"token operator\">:</span> member<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span>\n        phone<span class=\"token operator\">:</span> member<span class=\"token punctuation\">.</span>phone<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그리고 module에 선언을 해줘야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//member-module.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Module <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@nestjs/common'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> GetMembersController <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./controller/get-members.controller'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./inbound-port/find-members.inbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FindMembersService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./service/find-members.service'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./outbound-port/find-members.outbound-port'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FindMembersRepository <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./outbound-adapter/find-members.repository'</span>\n\n<span class=\"token comment\">// 오늘 할 것: member 의 리스트를 조회하는 API 작성</span>\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Module</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  controllers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>GetMembersController<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  providers<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// inbound-port</span>\n    <span class=\"token punctuation\">{</span>\n      provide<span class=\"token operator\">:</span> <span class=\"token constant\">FIND_MEMBERS_INBOUND_PORT</span><span class=\"token punctuation\">,</span>\n      useClass<span class=\"token operator\">:</span> FindMembersService<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token comment\">// outbound-port</span>\n    <span class=\"token punctuation\">{</span>\n      provide<span class=\"token operator\">:</span> <span class=\"token constant\">FIND_MEMBERS_OUTBOUND_PORT</span><span class=\"token punctuation\">,</span>\n      useClass<span class=\"token operator\">:</span> FindMembersRepository<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemberModule</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기까지 하면 Port and adapter 아키텍쳐를 적용한 모습이다.</p>\n<p>서비스 로직이나 디비를 가져오는 리파지토리 로직에 대해 테스트 코드 작성도 쉽고, 코드 자체도 간결에서 읽기 편하다.<br>\n여기까지 하고 나니 내가 짠 코드는 벌레같은 코드였구나 라는 생각이 들 정도였다.</p>\n<br>\n<h4 id=\"테스트-코드-작성\" style=\"position:relative;\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\" aria-label=\"테스트 코드 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>테스트 코드 작성</h4>\n<p>이 부분은 강의를 듣다가 단순 코드를 작성하는 부분이 많아서 <a href=\"https://github.com/Jun4928/wanted-pre-onboarding-challenge-BE-task-JAN.2023/blob/main/lecture-2/src/member/service/find-members.service.spec.ts\">Github 코드</a> 및 아래 테스트 코드로 대체한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FindMembersService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./find-members.service'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  FindMembersOutboundPort<span class=\"token punctuation\">,</span>\n  FindMembersOutboundPortInputDto<span class=\"token punctuation\">,</span>\n  FindMembersOutboundPortOutputDto<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../outbound-port/find-members.outbound-port'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MockFindMembersOutboundPort</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">FindMembersOutboundPort</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> result<span class=\"token operator\">:</span> FindMembersOutboundPortOutputDto\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>result<span class=\"token operator\">:</span> FindMembersOutboundPortOutputDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> result\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>\n    params<span class=\"token operator\">:</span> FindMembersOutboundPortInputDto\n  <span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>FindMembersOutboundPortOutputDto<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>result\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'FindMembersService Spec'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'멤버 리스트를 반환한다.'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> member <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span>\n        email<span class=\"token operator\">:</span> <span class=\"token string\">'A@gmail.com'</span><span class=\"token punctuation\">,</span>\n        phone<span class=\"token operator\">:</span> <span class=\"token string\">'0103123123'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">const</span> findMemberService <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FindMembersService</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">new</span> <span class=\"token class-name\">MockFindMembersOutboundPort</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> findMemberService<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toStrictEqual</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span>\n        email<span class=\"token operator\">:</span> <span class=\"token string\">'A@gmail.com'</span><span class=\"token punctuation\">,</span>\n        phone<span class=\"token operator\">:</span> <span class=\"token string\">'0103123123'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>아까 서비스 로직을 보면 <strong>@inject</strong>를 제외한 어느 곳에서도 Nest.js의 기능을 사용하지 않고, 순수 Typescript로 구성되어 있음을 알 수 있다.<br>\n이는 테스트 코드를 작성할 때 Nest.js에 대한 의존이 낮다는 것을 의미한다.</p>\n<p>그리고 보통 단위 테스트 등을 할 때 디비에 대한 의존도가 있을 수 있는데, 이렇게 할 경우 독립적으로 테스트가 가능하다.</p>\n<br>\n<h4 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h4>\n<p>마지막 항목인 <strong>4. Live Coding2 : 사전과제 로직 함께 리팩토링 하기</strong>는 시간이 없어서 다음 강의에 다루기로 하였다.</p>\n<p>그리고 수강생들의 질의가 이것저것 많았는데 그 중 하나가 아래였다.</p>\n<p>Q : 포트 아키텍쳐 단점</p>\n<ol>\n<li>타이핑이 많아진다.</li>\n<li>모듈간의 의존성 관리가 아렵다(모든 아키텍쳐의 공통점)</li>\n</ol>\n<p>사실 타이핑이 많은게 나은 것 같다.</p>\n<p>그리고 강사님의 정리 내용을 요약하자면…</p>\n<ul>\n<li>어떤 아키텍쳐가 정답이 없다.</li>\n<li>선택한 아키텍쳐에 대한 이해도와 필요성, 숙련도에 따라 적용하면 된다.</li>\n<li>핵사곤 아키텍쳐라고 하기도 하는데 이건 더 어렵기에 포트 앤 어뎁터로 준비했다.</li>\n</ul>\n<p>강의는 3시간 밖에 안되었는데 내가 쓴 엉망 필기체 및 요약본…그리고 노션에 정리한 코드 및 url 등을 다 따서 복습을 해보니…<br>\n이거 또한 일인듯 했다…</p>\n<p>안그래도 흑우집합소 개발에 매진해야 했지만, 아무래도 너무 시간을 지체했었고,<br>\n한번 적용해봐야지 라는 생각에 시작했는데 아무래도 다음 강의 자료는 금방 할 수 없을 듯 하다.</p>\n<p>참고로 아직 함수형 프로그래밍은 나오지 않았고, 함수형을 위한 빌드업 과정이었다.<br>\n강의를 정리하면서 들으니 내용을 흘려 들은게 많아서 자세히 이해할 수 없었지만,<br>\n정리하면서 보니 이제는 그 흐름이나 맥락이 이해되었다.</p>\n<p>사실 이번 백엔드 강의는 나에게 너무 유익했던 시간이고, 소중한 내용을 배울 수 있어서 좋았다.<br>\n지금 <strong>이펙티브 타입스크립트</strong>책 내용 정리 포스팅도 준비중이긴 한데 일단 이 강의 내용 정리부터 하고 또 해봐야겠다.</p>\n<p>다음 강의 정리는 준비되는 대로 포스팅 하도록 하겠다.</p>","frontmatter":{"title":"원티드 프리온보딩 백엔드 2일차 TIL (실무 함수형 프로그래밍 빌드업)","date":"February 07, 2023"}}},"pageContext":{"slug":"/til/230114_wanted_preon_back02/","previous":{"fields":{"slug":"/utils/230203_web_carbon/"},"frontmatter":{"title":"(Web) 코드를 예쁜 이미지로 변환해주는 Carbon now"}},"next":{"fields":{"slug":"/book/230208_effective_typescript/"},"frontmatter":{"title":"(Book) 이펙티브 타입스크립트 동작 원리의 이해와 구체적인 조언 62가지 (Effective Typescript)"}}}},"staticQueryHashes":["3128451518","903436796"]}
{"componentChunkName":"component---src-templates-blog-post-js","path":"/til/230403_til/","result":{"data":{"site":{"siteMetadata":{"title":"MHLab blog","author":"MHLab","siteUrl":"https://elfinlas.github.io","comment":{"disqusShortName":"","utterances":"elfinlas/blog_utterances"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"c31ab6ff-20bd-5b57-9bef-cb4a04b5b77d","excerpt":"흑우집합소에 애드센스를 준비하던 도중… 혹시 Next.Js에서 애드센스를 다는 것이 궁금하면 Next.Js에 구글 애드센스(Adsense) 등록하기포스팅을 참고하자. 뭐 아직 이르긴 하지만 구글 광고를 달려고 Adsense를 신청했었다. 근데 신청 후 몇일 뒤 아래와 같은 메일이 왔다.  뭐가 문젠지 봤더니 승인 상태 옆에 저렇게 찾을 수 없음이 뜬다.  문제는 쉽게 찾을 수 있었다. 먼저 ads.txt에 접근이 되어야 하는데 이상하게 접근이 되지 않았다. 일전에 Nginx에서 특정 IP…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 895px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/39caabbd44b8d6bf6560fecef746ecb3/b002d/thumbnail_til.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABMklEQVQoz42SW2/CMAyFk7a50Li3lFJGuw2plSbxBP//x50lhjFAo+zhyI3lfj5xLIQQuJW3hKFaY3AeH7TGO7X4KNb4LDvsqw2rLxpsihqFdXj8XzwmIkBl6q9CVioTUGpQpZbhVpllYHRm9W9R13WYpgm7YUDj/V3tJq9QG7cMjNdTaXY9O+cwjiODiYhzUshzs1WJZkXLwDirNEnuclJK1mNtawg+L5eBcS5xTj8grTW7LIoCeZ4juWnmtUPryn84vADjFed5xuFwwOl4Cjpyg6tDTQFYvXAYgEadXzm6SbMwTylYqb5//SY47KheBva2xNy88S6KRKIOQ9+VLbZh93pq+Pt89tjXPXJtl4FXcHjBr24EmRVyqeASzSKOiqOR2evFlpdIymJqtk8X/Jm+AaC961594rpnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/39caabbd44b8d6bf6560fecef746ecb3/77434/thumbnail_til.webp 300w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/411c4/thumbnail_til.webp 600w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/dd3ab/thumbnail_til.webp 895w\"\n              sizes=\"(max-width: 895px) 100vw, 895px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/39caabbd44b8d6bf6560fecef746ecb3/a8a0d/thumbnail_til.png 300w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/dface/thumbnail_til.png 600w,\n/static/39caabbd44b8d6bf6560fecef746ecb3/b002d/thumbnail_til.png 895w\"\n            sizes=\"(max-width: 895px) 100vw, 895px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/39caabbd44b8d6bf6560fecef746ecb3/b002d/thumbnail_til.png\"\n            alt=\"thumbnail\"\n            title=\"thumbnail\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h1 id=\"흑우집합소에-애드센스를-준비하던-도중\" style=\"position:relative;\"><a href=\"#%ED%9D%91%EC%9A%B0%EC%A7%91%ED%95%A9%EC%86%8C%EC%97%90-%EC%95%A0%EB%93%9C%EC%84%BC%EC%8A%A4%EB%A5%BC-%EC%A4%80%EB%B9%84%ED%95%98%EB%8D%98-%EB%8F%84%EC%A4%91\" aria-label=\"흑우집합소에 애드센스를 준비하던 도중 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>흑우집합소에 애드센스를 준비하던 도중…</h1>\n<p>혹시 Next.Js에서 애드센스를 다는 것이 궁금하면 <a href=\"https://elfinlas.github.io/next-js/230404_nextjs_in_adsense/\">Next.Js에 구글 애드센스(Adsense) 등록하기</a>포스팅을 참고하자.</p>\n<p>뭐 아직 이르긴 하지만 구글 광고를 달려고 <strong>Adsense</strong>를 신청했었다.<br>\n근데 신청 후 몇일 뒤 아래와 같은 메일이 왔다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 771px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2bd71ecdb5ca03106b439fda5f24d760/f0a60/img01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACCklEQVQoz21QS48MURSuH8A/IEi8kklkmB/AgjQTNixlLIgFYTExM5rMJFgRRhuJLSuJjGErwcYPsCQSjyF6um7dvlV1q6qrq6urbn3uo6qVHif11Xl/95xjXXjm4/C9LqYfMTQeMpxoMRx7YHC89Kdbxj614mpf1VW5xjLDUVk7dYei9TaCdeg2xdbLHey/SbBrgWDvDYJ90p5YdLTeMUdkzsHuJsHULaprtsvYnqap3XbNxhbZb51t4+pzDkuxzr4I0HwV4brCWqRthYWXIeZWA435Uld2Hc21EFck2euPfViQIgYhyO/vcNo/4Gysg0hNOz8RsA56voPQIwhcG1z5nCKSsWHs63hYxoFMUcESBRD3E7iuj45N4NAubOJozVwPWS4kilIbO1cQRRk3OeWLojATRlEEW5LZtg3f80B5CuZF8DwXrvRVzOchbNaD73MwxsA516CUyjoPQggzofqlaYo4jjVxlmUodMr8scmWnpxEfqX+C01YGXXpD3K4UQXzQNKPsfr0CULujUjHpahWHn+ll2T41R3iy8YQNDDHVtM/nr+I9vo37Vcr1vtGK9df0M1JDhrmZcw0Li0tYvLgBM6cPgnSaf9DWpf/ErIww/vPAziStBsJJGmOldlzaEzuxMyRAyBfP40Ix1e3xo6g75XnohYy9od3b3Dp/AyW799Fng03namSPxBjVDXtr9LjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2bd71ecdb5ca03106b439fda5f24d760/77434/img01.webp 300w,\n/static/2bd71ecdb5ca03106b439fda5f24d760/411c4/img01.webp 600w,\n/static/2bd71ecdb5ca03106b439fda5f24d760/88613/img01.webp 771w\"\n              sizes=\"(max-width: 771px) 100vw, 771px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2bd71ecdb5ca03106b439fda5f24d760/a8a0d/img01.png 300w,\n/static/2bd71ecdb5ca03106b439fda5f24d760/dface/img01.png 600w,\n/static/2bd71ecdb5ca03106b439fda5f24d760/f0a60/img01.png 771w\"\n            sizes=\"(max-width: 771px) 100vw, 771px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2bd71ecdb5ca03106b439fda5f24d760/f0a60/img01.png\"\n            alt=\"img01\"\n            title=\"img01\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>뭐가 문젠지 봤더니 승인 상태 옆에 저렇게 찾을 수 없음이 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 579px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1dda1503c7e2cd7f16c3b09bd33f92e5/ff2d6/img02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuUlEQVQY03WO3Q6DIAyFef9nXJYtcREmAgoC/uAZ1BvHXJNz0Z7TfmWoat/3H13VvxxLKeGs+kDp68yRqwBZZc5q8rquEEKgbTmUUogxXn7ovQfnHFJKNM0L1lqCs21LOLQRYVkWModxhHMO8zyTt6XvXMggpU3OWRgzZEAgjxXSWdPk0cke2hj6LoSAOuPzbLIGurujFzeMuiVw8VhZOKsMZa+gM536yj8UMbkBqntCvR8YNCd42f0AcG3U/8kuGr0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1dda1503c7e2cd7f16c3b09bd33f92e5/77434/img02.webp 300w,\n/static/1dda1503c7e2cd7f16c3b09bd33f92e5/96ba3/img02.webp 579w\"\n              sizes=\"(max-width: 579px) 100vw, 579px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1dda1503c7e2cd7f16c3b09bd33f92e5/a8a0d/img02.png 300w,\n/static/1dda1503c7e2cd7f16c3b09bd33f92e5/ff2d6/img02.png 579w\"\n            sizes=\"(max-width: 579px) 100vw, 579px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1dda1503c7e2cd7f16c3b09bd33f92e5/ff2d6/img02.png\"\n            alt=\"img02\"\n            title=\"img02\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"문제는-쉽게-찾을-수-있었다\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C%EB%8A%94-%EC%89%BD%EA%B2%8C-%EC%B0%BE%EC%9D%84-%EC%88%98-%EC%9E%88%EC%97%88%EB%8B%A4\" aria-label=\"문제는 쉽게 찾을 수 있었다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제는 쉽게 찾을 수 있었다.</h2>\n<p>먼저 ads.txt에 접근이 되어야 하는데 이상하게 접근이 되지 않았다.</p>\n<p>일전에 <a href=\"https://elfinlas.github.io/nginx/230401_defense_attacker/\">Nginx에서 특정 IP 접근 금지 시키기</a> 포스팅을 하면서 뭔가 본거 같기도…<br>\n그래서 포스팅을 확인해본 결과…</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">~*(idx_config|DS_Store|nginx|wp-json|ads|humans|exec|level|monitoring|configprops|balancer|actuator) 1;</code></pre></div>\n<p><strong>Url Keyword</strong>방식을 적은 부분에서 <strong>ads</strong>단어가 있었다…</p>\n<p>이래서 <strong>ads.txt</strong> 파일에 접근이 불가능했던 것이다.<br>\n그래서 접근 확인을 한 후 재검토를 신청했다.</p>\n<h2 id=\"응-거절이야\" style=\"position:relative;\"><a href=\"#%EC%9D%91-%EA%B1%B0%EC%A0%88%EC%9D%B4%EC%95%BC\" aria-label=\"응 거절이야 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>응 거절이야~</h2>\n<p>또 저 해맑은 아저씨 메일이 왔다 -_-;;<br>\n그래서 몇개 생각을 하다가 Nginx에서 막은게 문제겠지 싶었다.</p>\n<p>그러다가 하나 생각이 난게 IP 접근에서 뭔가 있었던 것 같았다.<br>\n그래서 불법 침입 시도를 확인할 겸 접근 로그를 보다가…</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">66.249.66.65 - - [03/Apr/2023:00:22:03 +0900] \"GET /robots.txt HTTP/1.1\" 301 178 \"-\" \"Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\"\n66.249.66.89 - - [03/Apr/2023:00:24:00 +0900] \"GET /robots.txt HTTP/1.1\" 301 178 \"-\" \"Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\"</code></pre></div>\n<p>그렇다…<br>\n내가 구글 봇 클라이언트를 막은 것 같았다…</p>\n<p>근데 구글 봇 클라이언트가 저거 하나만 돌지 아니면 여려 개 돌지 확인할 수 있는 방법이 없었다.<br>\n그럼 궁금하니 <strong>ChatGPT</strong>에게 기대를 걸고 물어봤다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 754px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5842486a061f8ea2a4c91efc594534e0/a0d62/img03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACaklEQVQ4y5VUiY7qMAzs/3/gWxZKD+hB7xtoC/h53HhbpF2tNtLIiZ04jj2O1fc9pWlGeV4IirKUdRRdaBxHwni9Xr9Ch/V8PunxeNDz8STMFfM801+GOrbqpqW8qKhhWVU1o6GC15BlWQuqepkXZUWl2SP2yujY1vdXGoYbWSE/7XN/JMc90dHxaX9w6N/uIFL1rndmudgOtkuHoyd7gQ/eC/swXAXWJclYadPu05bDHyxt3uj6Z9kYhDGdzhF5fkBheOF5KI48tkNns3P4GMeJbrc7WXleUhDEFF9SStJcDuEJ9/soG77D1nY38nq9CayJPc/TTNM0GcxyGyq8yhVwBmzX270WaFNyYtu2E9RcABSobVvRd11PDc+hA34bFg5mWS5IklQ4CGCt/CyKUmTGgA5R/cRPCxwE57bP0+dDjxRACniOnIGnP0aIRGrJFX0/GLnM1/UgiUcaAKwbThNs0EuV4zgVevinQOiAuW2k6y0cBDUgwUHo1O6fQtqzDqzoukECEGKDUzCqA/ALnNQD0B9d3/BvseEMJC6r61ZSJRFGcSIdAMKqMyEtR7xEdOaOcdYoWSLCHXcRJNr2jYcBE1kd6lMcb4kOZEcXAGkKFmSEFGVZQQgkZXnbEFsixEeAA9iUcdeg2VMz1yLp7Yre6DsuCj4XzNWp9LLteFIUTTR61zHJR54EvJbnMpCWxESeF+W7QzQ/fhVt9OVnOX39JlIQ41idIcfyZPQ+FxVOvxwiT/iC9Js6B5FECYk1ol0YoNEvc7mELwMLoiiR7hGH+CRxG4qDG9Ex6wdgumfzAbzbuKOMTovyH4sr6ioj0pUsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5842486a061f8ea2a4c91efc594534e0/77434/img03.webp 300w,\n/static/5842486a061f8ea2a4c91efc594534e0/411c4/img03.webp 600w,\n/static/5842486a061f8ea2a4c91efc594534e0/c7309/img03.webp 754w\"\n              sizes=\"(max-width: 754px) 100vw, 754px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5842486a061f8ea2a4c91efc594534e0/a8a0d/img03.png 300w,\n/static/5842486a061f8ea2a4c91efc594534e0/dface/img03.png 600w,\n/static/5842486a061f8ea2a4c91efc594534e0/a0d62/img03.png 754w\"\n            sizes=\"(max-width: 754px) 100vw, 754px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5842486a061f8ea2a4c91efc594534e0/a0d62/img03.png\"\n            alt=\"img03\"\n            title=\"img03\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>한글과 영어로 물어봤지만…<br>\n자기도 모른다 한다.. -_-;;</p>\n<p>그래서 직접 내가 찾아봤다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 972px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b9208c94e6578c63a2edab4e3bd94d64/84a58/img04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXElEQVQ4y51Ua08TQRSd///RaDCiGIOvECMIRfEXIBh5lD7oWgot3dJt973bB30d59x2SkNaY5zkZO7Mzpx77mNHHR8d4e3mJn4cHiJJEkwmwGg00hhiLPNI9tM0RafTQZqkGsnU1ntmn2fu7++hDr7uYT+zg8zuZ+zvbeP7wZ7YuztbyHz5JDbxLbONrQ+v8ebVM7zfXMfHd9reeI6Nl2tTvHiK9bUnUKenP3F+foKTX8fI585QubJglQr4bV0KSpcFFPIXuCqXtJ1HsXCBy6JGIafPZ+co5LPIZc+g/MDXcmNwZij/OyRV4zGUVbLgeR5aLQd2vY66RqPRgG3bAmNznn6zZebe3V0DrXYLjuOg7bYxGAygrq+v0W63ZdO26zNMyeraFpBAE93Wb2VtSHnH1USOFsMIWUDFTd/3tcLWzOudwF5QsqjUOBTF2uY9z3Nl7va6ULzM0nOu1qqi4rZWk3CazeYcdEzQ5lljU53jNBEEAYbDoS6K5zOlcENHiNlL/X5fenCiM/03jHURjG2GCsNQ58HVZMsrTK/0nsw6YPHyQ4UfnKhisTjPB4lZqVWKlhE9XivLskTBtHVaiOP4n5QscyaEbBn+iww9WWjsXq8nyTdF4PdVpLwXhTG6cQplCKiQ7WMGC1StVqV1KpWKVHVVmFEU6vsB0iCCMl5IyNCXEd7c3Eg6His0a6bJ90N0gviBkAUh2AocDIN/UU33ZLlclrBX5S2kQlcr9BcUmjfPDPYiHVA5w42iaMWjMJm/k30NZTyZhl58NLvdrhSHoM0ztEdLmt6Q/wFjeFEiUYvkeAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b9208c94e6578c63a2edab4e3bd94d64/77434/img04.webp 300w,\n/static/b9208c94e6578c63a2edab4e3bd94d64/411c4/img04.webp 600w,\n/static/b9208c94e6578c63a2edab4e3bd94d64/3300c/img04.webp 972w\"\n              sizes=\"(max-width: 972px) 100vw, 972px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b9208c94e6578c63a2edab4e3bd94d64/a8a0d/img04.png 300w,\n/static/b9208c94e6578c63a2edab4e3bd94d64/dface/img04.png 600w,\n/static/b9208c94e6578c63a2edab4e3bd94d64/84a58/img04.png 972w\"\n            sizes=\"(max-width: 972px) 100vw, 972px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b9208c94e6578c63a2edab4e3bd94d64/84a58/img04.png\"\n            alt=\"img04\"\n            title=\"img04\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>근데 다 나오진 않고 일부만 주고 정보를 파는 사이트였다.</p>\n<p><a href=\"https://searchengineland.com/google-publishes-the-list-of-googlebot-ip-addresses-375935\"></a></p>\n<p>그래서 21년도 자료긴 한데 <a href=\"https://searchengineland.com/google-publishes-the-list-of-googlebot-ip-addresses-375935\">구글봇 주소 정보글(영문)</a>에서 약간의 정보를 찾을 수 있었다.<br>\n저 본문 중 구글 봇의 범위 주소 (IpV4(서브넷으로 나뉨), IpV6)를 <a href=\"https://developers.google.com/search/apis/ipranges/googlebot.json\">공개한 구글봇 주소 공식 api</a>를 확인해봤다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 498px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/267c080f6e6669d2c83b7021429971b0/c365b/img05.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAABc0lEQVQ4y62U2W7EIAxF5///MA95yFv2fd+ojqU7Qm2STqVG8hjM+HIAw2vbNneepzuOw2xdV0cMvyyLted5NiOGqU8eH17tFz95nrsgCFwYhi6KItd1nZumyWVZ5pqmMV8Uhavr2vppmlrfF9RnguM42p+qqnon9n1vNIzRbtvWJsKgI86kPwjVYGl8JEKBKEsmkZhvwzCYIXwpiJG477sJlWVptCSQyAT0GcNEjb8lBB9BBPgzniUT92MY5MTxt4LQIAgd+4gniT3T3hLDiGnpt4IQXBFqH0VHW4SM3woySB1SQpQJniRIoKIPJQYh+8rEj4QIigYxTl40ohOhCv1fCFVaj4QQsIf+folQZH8i9E8ZmqdT1s15POXvdair59ehjMmJ394Uf8ncBN0K/+rpYRCZhH89FMR09bRkTSJjEuIfFbYOBe8fil82ehM/KhuesTiOrXRIho5DSpLExvTMYVDeCjIIoQw6veL0r9pXD+wXEYDIRe/C07AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/267c080f6e6669d2c83b7021429971b0/77434/img05.webp 300w,\n/static/267c080f6e6669d2c83b7021429971b0/b042d/img05.webp 498w\"\n              sizes=\"(max-width: 498px) 100vw, 498px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/267c080f6e6669d2c83b7021429971b0/a8a0d/img05.png 300w,\n/static/267c080f6e6669d2c83b7021429971b0/c365b/img05.png 498w\"\n            sizes=\"(max-width: 498px) 100vw, 498px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/267c080f6e6669d2c83b7021429971b0/c365b/img05.png\"\n            alt=\"img05\"\n            title=\"img05\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>일단 최신 자료이고, 하단에 ipv4 정보도 있었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 462px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4841cd42400ec3d9bb8e31bc69cdbacc/a9e02/img06.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWklEQVQ4y5WUCY6AIBAE/f9Hve/7ZLdI2kyMq67JBASnKZrBwP0+x3G4aZrcsiwuiiIXx7FL09R1XeeGYfD9oih8ZFnmqqpyyiPsE2iC5G3bTpG+7/0C67q6cRz9ggrGXwVJ4kNooIAGYcbp13Xtmqbxc7SfCdu29UK8W0KFyJV3fYKrhxAQeZ77ZETKsvSE8pE5Fr8TPQUh2/f9JLQe8s6CiKsvoT8F53n2IToRIiBCgj6UltCK3hIidCUUHeMQvnr4REjdcbIQ0meO/iMhCXeEbO3qIRVgKW8FSbaEqkOE6ctHWsZetywPISXB1qE81I3hOyt4SygPuSnWwyuh7vPrlkUImQ4Duru7zMKW7pFQfxpChPKUE9ZN4dtPhNYvEVoytdbHR8IwDD0lwfYJ+YqPtHj4mVB+kUANElpMpfVvQv21RZgkyVmf8vf1lElkVf2ynjy81qIV/AHkJRoI9g+VbQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4841cd42400ec3d9bb8e31bc69cdbacc/77434/img06.webp 300w,\n/static/4841cd42400ec3d9bb8e31bc69cdbacc/0b6e4/img06.webp 462w\"\n              sizes=\"(max-width: 462px) 100vw, 462px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4841cd42400ec3d9bb8e31bc69cdbacc/a8a0d/img06.png 300w,\n/static/4841cd42400ec3d9bb8e31bc69cdbacc/a9e02/img06.png 462w\"\n            sizes=\"(max-width: 462px) 100vw, 462px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4841cd42400ec3d9bb8e31bc69cdbacc/a9e02/img06.png\"\n            alt=\"img06\"\n            title=\"img06\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>그래서 저기 나온 주소를 토대로 내가 막은게 있나 봤다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">geo $bad_ip_range {\n\t# A\n    34.0.0.0/8 1; #22-07-01 => Google Bot 있을 수 있음\n\t103.0.0.0/8 1; #VN-21-11-29\n  \t185.0.0.0/8 1; #DE-21-12-27\n\t159.0.0.0/8 1; #22-04-17\n\t20.0.0.0/8 1; #22-04-30\n\t15.0.0.0/8 1; #22-06-10\n\t51.0.0.0/8 1; #22-06-27\n\t35.0.0.0/8 1; #22-07-01\n\n    # B\n    66.249.0.0/16 1; #US_21-11-15 => Google Bot 있을 수 있음\n  \t5.161.0.0/16 1; #22-01-02\n  \t45.83.0.0/16 1; #log4j\n}</code></pre></div>\n<p>그렇다…<br>\n범위 계열에서 A클래스 주소 중 34 주소를 다 막아버린 것이다… -_-;;;</p>\n<p>그리고 B클래스에서도 막은 곳이 있었다.<br>\n얼른 이 부분은 주석 처리 후 Nginx를 리스타트 했다.</p>\n<p>C 클래스에는 다행히 없었다.<br>\n그리고 각 Ip 밴 시킨 부분도 몇 개 검토해서 다시 풀었다.</p>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>이제 한번 기다려보면 될 것 같다.<br>\n근데 구글 문서에서 몇 가지 찾은 정보가 있는데, 유저 에이전트를 확인하라고 한다.</p>\n<p><a href=\"https://developers.google.com/search/docs/crawling-indexing/overview-google-crawlers?hl=ko\">Google 크롤러(사용자 에이전트) 개요</a> 페이지를 참고하자.<br>\n그리고 <a href=\"https://developers.google.com/search/docs/advanced/crawling/verifying-googlebot?hl=ko#use-automatic-solutions\">Googlebot과 다른 Google 크롤러 확인</a> 이라는 문서도 있다.</p>\n<p>여기에 의하면 <strong>host</strong> 명령어를 통해서 해당 에이전트를 확인하라고 하는데 아래와 같이 확인이 가능했다.\n먼저 역방향 DNS를 조회해본다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 628px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/af4dde69d25370a589d3bcf6ed8f425b/5e4bf/img07.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAATUlEQVQI12OosTL532Zl+L/Fyuh/o7n+/zZb0/8dQH6Vg/V/Vzf//y5A7O4Z+N/Z1Q9MW9u6/beycf1vae0KpkF8OwdPIO3+38jE7j8A3yckn9GatAIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/af4dde69d25370a589d3bcf6ed8f425b/77434/img07.webp 300w,\n/static/af4dde69d25370a589d3bcf6ed8f425b/411c4/img07.webp 600w,\n/static/af4dde69d25370a589d3bcf6ed8f425b/189c6/img07.webp 628w\"\n              sizes=\"(max-width: 628px) 100vw, 628px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/af4dde69d25370a589d3bcf6ed8f425b/a8a0d/img07.png 300w,\n/static/af4dde69d25370a589d3bcf6ed8f425b/dface/img07.png 600w,\n/static/af4dde69d25370a589d3bcf6ed8f425b/5e4bf/img07.png 628w\"\n            sizes=\"(max-width: 628px) 100vw, 628px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/af4dde69d25370a589d3bcf6ed8f425b/5e4bf/img07.png\"\n            alt=\"img07\"\n            title=\"img07\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>그럼 domain name에 google-proxy-…값이 뜨는데 이 값을 이용해 순방향 DNS를 조회해본다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 542px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/79cfa149a4df418abb89030d87401672/47f85/img08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiElEQVQI1z2NWQ6CQABDuYHLIdArmBglCMIs7DNEETQmXhD1fs+BDz+aNk3z6o2bFaO/5LNd//V2+voL+t2eUBqOgUBlFqEawigjTgoOgUTIxuWS6FwgtUFpi/dQOX2quMaCu8wYhJ79VdZ07UBl+hlWNzd03nLpnhg7cHLg6WDqkrTCuG0QKn7oQkyM29VAhwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/79cfa149a4df418abb89030d87401672/77434/img08.webp 300w,\n/static/79cfa149a4df418abb89030d87401672/535ba/img08.webp 542w\"\n              sizes=\"(max-width: 542px) 100vw, 542px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/79cfa149a4df418abb89030d87401672/a8a0d/img08.png 300w,\n/static/79cfa149a4df418abb89030d87401672/47f85/img08.png 542w\"\n            sizes=\"(max-width: 542px) 100vw, 542px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/79cfa149a4df418abb89030d87401672/47f85/img08.png\"\n            alt=\"img08\"\n            title=\"img08\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>그럼 처음 접근한 주소의 IP와 순방향 조회 IP를 비교해서 같으면 된다.</p>\n<p>근데 <a href=\"https://developers.google.com/search/apis/ipranges/googlebot.json\">공개한 구글봇 주소 공식 api</a>문서를 통해서 자동으로 차단 처리를 할 수 있을 듯 한데…<br>\n이건 좀 나중에 해봐야겠다.</p>","frontmatter":{"title":"23년 4월 3일 TIL & 개발노트 (Google Bot)","date":"April 04, 2023"}}},"pageContext":{"slug":"/til/230403_til/","previous":{"fields":{"slug":"/next-js/230404_nextjs_in_adsense/"},"frontmatter":{"title":"Next.Js에 구글 애드센스(Adsense) 등록하기"}},"next":{"fields":{"slug":"/gatsby/230404_google_analytics/"},"frontmatter":{"title":"Gasty에서 구글 애널리틱스 GA4 처리 문제"}}}},"staticQueryHashes":["3128451518","903436796"]}